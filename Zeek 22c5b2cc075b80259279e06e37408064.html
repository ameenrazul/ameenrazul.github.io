<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>Zeek</title><style>
/* cspell:disable-file */
/* webkit printing magic: print all background colors */
html {
	-webkit-print-color-adjust: exact;
}
* {
	box-sizing: border-box;
	-webkit-print-color-adjust: exact;
}

html,
body {
	margin: 0;
	padding: 0;
}
@media only screen {
	body {
		margin: 2em auto;
		max-width: 900px;
		color: rgb(55, 53, 47);
	}
}

body {
	line-height: 1.5;
	white-space: pre-wrap;
}

a,
a.visited {
	color: inherit;
	text-decoration: underline;
}

.pdf-relative-link-path {
	font-size: 80%;
	color: #444;
}

h1,
h2,
h3 {
	letter-spacing: -0.01em;
	line-height: 1.2;
	font-weight: 600;
	margin-bottom: 0;
}

.page-title {
	font-size: 2.5rem;
	font-weight: 700;
	margin-top: 0;
	margin-bottom: 0.75em;
}

h1 {
	font-size: 1.875rem;
	margin-top: 1.875rem;
}

h2 {
	font-size: 1.5rem;
	margin-top: 1.5rem;
}

h3 {
	font-size: 1.25rem;
	margin-top: 1.25rem;
}

.source {
	border: 1px solid #ddd;
	border-radius: 3px;
	padding: 1.5em;
	word-break: break-all;
}

.callout {
	border-radius: 3px;
	padding: 1rem;
}

figure {
	margin: 1.25em 0;
	page-break-inside: avoid;
}

figcaption {
	opacity: 0.5;
	font-size: 85%;
	margin-top: 0.5em;
}

mark {
	background-color: transparent;
}

.indented {
	padding-left: 1.5em;
}

hr {
	background: transparent;
	display: block;
	width: 100%;
	height: 1px;
	visibility: visible;
	border: none;
	border-bottom: 1px solid rgba(55, 53, 47, 0.09);
}

img {
	max-width: 100%;
}

@media only print {
	img {
		max-height: 100vh;
		object-fit: contain;
	}
}

@page {
	margin: 1in;
}

.collection-content {
	font-size: 0.875rem;
}

.column-list {
	display: flex;
	justify-content: space-between;
}

.column {
	padding: 0 1em;
}

.column:first-child {
	padding-left: 0;
}

.column:last-child {
	padding-right: 0;
}

.table_of_contents-item {
	display: block;
	font-size: 0.875rem;
	line-height: 1.3;
	padding: 0.125rem;
}

.table_of_contents-indent-1 {
	margin-left: 1.5rem;
}

.table_of_contents-indent-2 {
	margin-left: 3rem;
}

.table_of_contents-indent-3 {
	margin-left: 4.5rem;
}

.table_of_contents-link {
	text-decoration: none;
	opacity: 0.7;
	border-bottom: 1px solid rgba(55, 53, 47, 0.18);
}

table,
th,
td {
	border: 1px solid rgba(55, 53, 47, 0.09);
	border-collapse: collapse;
}

table {
	border-left: none;
	border-right: none;
}

th,
td {
	font-weight: normal;
	padding: 0.25em 0.5em;
	line-height: 1.5;
	min-height: 1.5em;
	text-align: left;
}

th {
	color: rgba(55, 53, 47, 0.6);
}

ol,
ul {
	margin: 0;
	margin-block-start: 0.6em;
	margin-block-end: 0.6em;
}

li > ol:first-child,
li > ul:first-child {
	margin-block-start: 0.6em;
}

ul > li {
	list-style: disc;
}

ul.to-do-list {
	padding-inline-start: 0;
}

ul.to-do-list > li {
	list-style: none;
}

.to-do-children-checked {
	text-decoration: line-through;
	opacity: 0.375;
}

ul.toggle > li {
	list-style: none;
}

ul {
	padding-inline-start: 1.7em;
}

ul > li {
	padding-left: 0.1em;
}

ol {
	padding-inline-start: 1.6em;
}

ol > li {
	padding-left: 0.2em;
}

.mono ol {
	padding-inline-start: 2em;
}

.mono ol > li {
	text-indent: -0.4em;
}

.toggle {
	padding-inline-start: 0em;
	list-style-type: none;
}

/* Indent toggle children */
.toggle > li > details {
	padding-left: 1.7em;
}

.toggle > li > details > summary {
	margin-left: -1.1em;
}

.selected-value {
	display: inline-block;
	padding: 0 0.5em;
	background: rgba(206, 205, 202, 0.5);
	border-radius: 3px;
	margin-right: 0.5em;
	margin-top: 0.3em;
	margin-bottom: 0.3em;
	white-space: nowrap;
}

.collection-title {
	display: inline-block;
	margin-right: 1em;
}

.page-description {
	margin-bottom: 2em;
}

.simple-table {
	margin-top: 1em;
	font-size: 0.875rem;
	empty-cells: show;
}
.simple-table td {
	height: 29px;
	min-width: 120px;
}

.simple-table th {
	height: 29px;
	min-width: 120px;
}

.simple-table-header-color {
	background: rgb(247, 246, 243);
	color: black;
}
.simple-table-header {
	font-weight: 500;
}

time {
	opacity: 0.5;
}

.icon {
	display: inline-block;
	max-width: 1.2em;
	max-height: 1.2em;
	text-decoration: none;
	vertical-align: text-bottom;
	margin-right: 0.5em;
}

img.icon {
	border-radius: 3px;
}

.user-icon {
	width: 1.5em;
	height: 1.5em;
	border-radius: 100%;
	margin-right: 0.5rem;
}

.user-icon-inner {
	font-size: 0.8em;
}

.text-icon {
	border: 1px solid #000;
	text-align: center;
}

.page-cover-image {
	display: block;
	object-fit: cover;
	width: 100%;
	max-height: 30vh;
}

.page-header-icon {
	font-size: 3rem;
	margin-bottom: 1rem;
}

.page-header-icon-with-cover {
	margin-top: -0.72em;
	margin-left: 0.07em;
}

.page-header-icon img {
	border-radius: 3px;
}

.link-to-page {
	margin: 1em 0;
	padding: 0;
	border: none;
	font-weight: 500;
}

p > .user {
	opacity: 0.5;
}

td > .user,
td > time {
	white-space: nowrap;
}

input[type="checkbox"] {
	transform: scale(1.5);
	margin-right: 0.6em;
	vertical-align: middle;
}

p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.image {
	border: none;
	margin: 1.5em 0;
	padding: 0;
	border-radius: 0;
	text-align: center;
}

.code,
code {
	background: rgba(135, 131, 120, 0.15);
	border-radius: 3px;
	padding: 0.2em 0.4em;
	border-radius: 3px;
	font-size: 85%;
	tab-size: 2;
}

code {
	color: #eb5757;
}

.code {
	padding: 1.5em 1em;
}

.code-wrap {
	white-space: pre-wrap;
	word-break: break-all;
}

.code > code {
	background: none;
	padding: 0;
	font-size: 100%;
	color: inherit;
}

blockquote {
	font-size: 1.25em;
	margin: 1em 0;
	padding-left: 1em;
	border-left: 3px solid rgb(55, 53, 47);
}

.bookmark {
	text-decoration: none;
	max-height: 8em;
	padding: 0;
	display: flex;
	width: 100%;
	align-items: stretch;
}

.bookmark-title {
	font-size: 0.85em;
	overflow: hidden;
	text-overflow: ellipsis;
	height: 1.75em;
	white-space: nowrap;
}

.bookmark-text {
	display: flex;
	flex-direction: column;
}

.bookmark-info {
	flex: 4 1 180px;
	padding: 12px 14px 14px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
}

.bookmark-image {
	width: 33%;
	flex: 1 1 180px;
	display: block;
	position: relative;
	object-fit: cover;
	border-radius: 1px;
}

.bookmark-description {
	color: rgba(55, 53, 47, 0.6);
	font-size: 0.75em;
	overflow: hidden;
	max-height: 4.5em;
	word-break: break-word;
}

.bookmark-href {
	font-size: 0.75em;
	margin-top: 0.25em;
}

.sans { font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
.code { font-family: "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; }
.serif { font-family: Lyon-Text, Georgia, ui-serif, serif; }
.mono { font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; }
.pdf .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK JP'; }
.pdf:lang(zh-CN) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC'; }
.pdf:lang(zh-TW) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK TC'; }
.pdf:lang(ko-KR) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK KR'; }
.pdf .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK JP'; }
.pdf:lang(zh-CN) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK SC'; }
.pdf:lang(zh-TW) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK TC'; }
.pdf:lang(ko-KR) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK KR'; }
.pdf .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.highlight-default {
	color: rgba(50, 48, 44, 1);
}
.highlight-gray {
	color: rgba(115, 114, 110, 1);
	fill: rgba(115, 114, 110, 1);
}
.highlight-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.highlight-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.highlight-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.highlight-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.highlight-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.highlight-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.highlight-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.highlight-red {
	color: rgba(205, 60, 58, 1);
	fill: rgba(205, 60, 58, 1);
}
.highlight-default_background {
	color: rgba(50, 48, 44, 1);
}
.highlight-gray_background {
	background: rgba(248, 248, 247, 1);
}
.highlight-brown_background {
	background: rgba(244, 238, 238, 1);
}
.highlight-orange_background {
	background: rgba(251, 236, 221, 1);
}
.highlight-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.highlight-teal_background {
	background: rgba(237, 243, 236, 1);
}
.highlight-blue_background {
	background: rgba(231, 243, 248, 1);
}
.highlight-purple_background {
	background: rgba(248, 243, 252, 1);
}
.highlight-pink_background {
	background: rgba(252, 241, 246, 1);
}
.highlight-red_background {
	background: rgba(253, 235, 236, 1);
}
.block-color-default {
	color: inherit;
	fill: inherit;
}
.block-color-gray {
	color: rgba(115, 114, 110, 1);
	fill: rgba(115, 114, 110, 1);
}
.block-color-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.block-color-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.block-color-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.block-color-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.block-color-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.block-color-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.block-color-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.block-color-red {
	color: rgba(205, 60, 58, 1);
	fill: rgba(205, 60, 58, 1);
}
.block-color-default_background {
	color: inherit;
	fill: inherit;
}
.block-color-gray_background {
	background: rgba(248, 248, 247, 1);
}
.block-color-brown_background {
	background: rgba(244, 238, 238, 1);
}
.block-color-orange_background {
	background: rgba(251, 236, 221, 1);
}
.block-color-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.block-color-teal_background {
	background: rgba(237, 243, 236, 1);
}
.block-color-blue_background {
	background: rgba(231, 243, 248, 1);
}
.block-color-purple_background {
	background: rgba(248, 243, 252, 1);
}
.block-color-pink_background {
	background: rgba(252, 241, 246, 1);
}
.block-color-red_background {
	background: rgba(253, 235, 236, 1);
}
.select-value-color-default { background-color: rgba(84, 72, 49, 0.08); }
.select-value-color-gray { background-color: rgba(84, 72, 49, 0.15); }
.select-value-color-brown { background-color: rgba(210, 162, 141, 0.35); }
.select-value-color-orange { background-color: rgba(224, 124, 57, 0.27); }
.select-value-color-yellow { background-color: rgba(236, 191, 66, 0.39); }
.select-value-color-green { background-color: rgba(123, 183, 129, 0.27); }
.select-value-color-blue { background-color: rgba(93, 165, 206, 0.27); }
.select-value-color-purple { background-color: rgba(168, 129, 197, 0.27); }
.select-value-color-pink { background-color: rgba(225, 136, 179, 0.27); }
.select-value-color-red { background-color: rgba(244, 171, 159, 0.4); }

.checkbox {
	display: inline-flex;
	vertical-align: text-bottom;
	width: 16;
	height: 16;
	background-size: 16px;
	margin-left: 2px;
	margin-right: 5px;
}

.checkbox-on {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
}

.checkbox-off {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
}
	
</style></head><body><article id="22c5b2cc-075b-8025-9279-e06e37408064" class="page sans"><header><img class="page-cover-image" src="https://www.notion.so/images/page-cover/gradients_3.png" style="object-position:center 60%"/><div class="page-header-icon page-header-icon-with-cover"><img class="icon" src="https://tryhackme-images.s3.amazonaws.com/room-icons/85ba4a3cd4cafc3f43d83fbacf12ca14.png"/></div><h1 class="page-title">Zeek</h1><p class="page-description"></p></header><div class="page-body"><p id="22c5b2cc-075b-80e9-a291-c2ee23a4b79f" class="">&quot;Zeek (formerly Bro) is the world&#x27;s leading platform for network security monitoring. Flexible, open-source, and powered by defenders.&quot; &quot;Zeek is a passive, open-source network traffic analyser. Many operators use Zeek as a network security monitor (NSM) to support suspicious or malicious activity investigations. Zeek also supports a wide range of traffic analysis tasks beyond the security domain, including performance measurement and troubleshooting.”</p><hr id="22c5b2cc-075b-80cf-a16d-ca85519aeeb4"/><p id="22c5b2cc-075b-8039-af15-ddc5079ec8d5" class=""><a href="https://corelight.com/cs/c/?cta_guid=7a87a17f-9f45-4540-bdc8-3128214f4f6c&amp;signature=AAH58kFrvURy5ph4RTVruLuCY8WWSxitdQ&amp;portal_id=8645105&amp;pageId=93210638154&amp;placement_guid=c22a5503-4b59-42f6-a9fc-2230f8142f4e&amp;click=a3f2a57e-08fc-4714-b7b3-6a017bd94a60&amp;redirect_url=APefjpHrlztWSw89ZRQR0qnRqpRe1NZ7zD1X3V4YyWA95Y1upum8Hgbo9dDHIw8IIQA1qXHGGNisoSWgHbuafDI2RXnBcBHlI5MTYRSA6bmefGto8g-zJsvI9DAh9Y9_sgXH6eDy-UE3SgUR6wASv0EdslOKHqWKOI9C8HUP_sAncN5tPpJ-CIGKg_Tzno_Hs9G39E_mb4U9&amp;hsutk=&amp;canon=https%3A%2F%2Fcorelight.com%2Fproducts%2Fzeek-data%2F&amp;ts=1752132200947">https://corelight.com/cs/c/?cta_guid=7a87a17f-9f45-4540-bdc8-3128214f4f6c&amp;signature=AAH58kFrvURy5ph4RTVruLuCY8WWSxitdQ&amp;portal_id=8645105&amp;pageId=93210638154&amp;placement_guid=c22a5503-4b59-42f6-a9fc-2230f8142f4e&amp;click=a3f2a57e-08fc-4714-b7b3-6a017bd94a60&amp;redirect_url=APefjpHrlztWSw89ZRQR0qnRqpRe1NZ7zD1X3V4YyWA95Y1upum8Hgbo9dDHIw8IIQA1qXHGGNisoSWgHbuafDI2RXnBcBHlI5MTYRSA6bmefGto8g-zJsvI9DAh9Y9_sgXH6eDy-UE3SgUR6wASv0EdslOKHqWKOI9C8HUP_sAncN5tPpJ-CIGKg_Tzno_Hs9G39E_mb4U9&amp;hsutk=&amp;canon=https%3A%2F%2Fcorelight.com%2Fproducts%2Fzeek-data%2F&amp;ts=1752132200947</a> - Zeek Cheat Sheet</p><h2 id="22c5b2cc-075b-807d-8074-de20b30318d1" class="">🛠️ <strong>Zeek (formerly Bro)</strong></h2><h3 id="22c5b2cc-075b-8054-92ab-c1d5156d8faf" class="">🎯 <strong>What is Zeek?</strong></h3><ul id="22c5b2cc-075b-806c-a34a-c8a726163dd3" class="bulleted-list"><li style="list-style-type:disc">A <strong>passive network traffic analysis tool</strong>.</li></ul><ul id="22c5b2cc-075b-80a0-a6f6-fde6991fbf6e" class="bulleted-list"><li style="list-style-type:disc">Both <strong>open-source</strong> and <strong>commercial</strong> (Corelight).</li></ul><ul id="22c5b2cc-075b-80a4-b1b0-ca4610fd6d3e" class="bulleted-list"><li style="list-style-type:disc">Generates <strong>rich logs</strong> (50+ types in 7 categories) for deep investigation.</li></ul><ul id="22c5b2cc-075b-8082-b34a-f6a551d03988" class="bulleted-list"><li style="list-style-type:disc">Useful for:<ul id="22c5b2cc-075b-8052-a16b-e95279ddcacb" class="bulleted-list"><li style="list-style-type:circle">NSM</li></ul><ul id="22c5b2cc-075b-8053-9ca2-dae33c860d95" class="bulleted-list"><li style="list-style-type:circle">Forensics</li></ul><ul id="22c5b2cc-075b-8049-a34d-f629810e8231" class="bulleted-list"><li style="list-style-type:circle">Threat hunting</li></ul></li></ul><h3 id="22c5b2cc-075b-8076-b006-f4cb661374bf" class="">🔍 <strong>Zeek vs Snort Comparison</strong></h3><table id="22c5b2cc-075b-80a1-880f-cd8b7e1c7eb5" class="simple-table"><thead class="simple-table-header"><tr id="22c5b2cc-075b-8049-b594-c3659c142005"><th id="qJ=L" class="simple-table-header-color simple-table-header">Feature</th><th id="GEFa" class="simple-table-header-color simple-table-header"><strong>Zeek</strong></th><th id="VHeg" class="simple-table-header-color simple-table-header"><strong>Snort</strong></th></tr></thead><tbody><tr id="22c5b2cc-075b-8063-b8c0-c8aa98193746"><td id="qJ=L" class="">Type</td><td id="GEFa" class="">NSM + IDS framework</td><td id="VHeg" class="">IDS/IPS system</td></tr><tr id="22c5b2cc-075b-806b-b050-fb58bd3ed510"><td id="qJ=L" class="">Detection Mechanism</td><td id="GEFa" class="">Event-based (semantic and session-level analysis)</td><td id="VHeg" class="">Signature-based (packet-level pattern matching)</td></tr><tr id="22c5b2cc-075b-80d0-bb72-de98037dc1c4"><td id="qJ=L" class="">Strengths</td><td id="GEFa" class="">Detects complex threats, scriptable, in-depth logs</td><td id="VHeg" class="">Easy to write rules, strong signature community</td></tr><tr id="22c5b2cc-075b-8088-879d-fe3c37ca0d8f"><td id="qJ=L" class="">Weaknesses</td><td id="GEFa" class="">Requires more manual/automated analysis</td><td id="VHeg" class="">May miss advanced threats</td></tr><tr id="22c5b2cc-075b-800d-b87c-f042b6a57f0e"><td id="qJ=L" class="">Use Case</td><td id="GEFa" class="">Threat hunting, traffic investigation</td><td id="VHeg" class="">Blocking known attacks</td></tr></tbody></table><hr id="22c5b2cc-075b-80c9-a9d9-d016e0144ce9"/><h2 id="22c5b2cc-075b-80d3-bfc3-f1d3366c8419" class="">🧱 <strong>Zeek Architecture</strong></h2><ol type="1" id="22c5b2cc-075b-80cf-8c60-d9ec0546a7eb" class="numbered-list" start="1"><li><strong>Event Engine</strong><ul id="22c5b2cc-075b-804a-80af-ee8e1b7d6b11" class="bulleted-list"><li style="list-style-type:disc">Packet-level processing: parses IPs, protocols, sessions.</li></ul><ul id="22c5b2cc-075b-8005-9ff0-c7d62c9ae89e" class="bulleted-list"><li style="list-style-type:disc">Outputs: basic events (e.g., connection started, file seen).</li></ul></li></ol><ol type="1" id="22c5b2cc-075b-8093-bdac-c0d9ef396511" class="numbered-list" start="2"><li><strong>Policy Script Interpreter</strong><ul id="22c5b2cc-075b-80b2-8a7c-db03d9a0840c" class="bulleted-list"><li style="list-style-type:disc">Correlates events using Zeek’s scripting language.</li></ul><ul id="22c5b2cc-075b-8032-ae46-d37a8ac95cd8" class="bulleted-list"><li style="list-style-type:disc">Controls what logs are created and what to alert on.</li></ul></li></ol><hr id="22c5b2cc-075b-808b-86e6-e2b8a15c60c2"/><h2 id="22c5b2cc-075b-8090-a67b-ff762580fa16" class="">🔧 <strong>Zeek Frameworks</strong></h2><p id="22c5b2cc-075b-800f-b3cd-ca5576547456" class="">Zeek supports modular <strong>frameworks</strong> to extend functionality:</p><ul id="22c5b2cc-075b-8002-912c-f99c908dd407" class="bulleted-list"><li style="list-style-type:disc"><strong>Logging</strong>: Core logging operations.</li></ul><ul id="22c5b2cc-075b-80d2-8bd6-cfa043060224" class="bulleted-list"><li style="list-style-type:disc"><strong>Notice</strong>: Security alerts.</li></ul><ul id="22c5b2cc-075b-808e-be16-fcc08ea7566e" class="bulleted-list"><li style="list-style-type:disc"><strong>Intel</strong>: Threat intelligence matching.</li></ul><ul id="22c5b2cc-075b-80e6-bdd4-f772068c7aef" class="bulleted-list"><li style="list-style-type:disc"><strong>Signature</strong>: Pattern-based detection.</li></ul><ul id="22c5b2cc-075b-809f-9aee-c8b8c423409b" class="bulleted-list"><li style="list-style-type:disc"><strong>GeoLocation</strong>, <strong>NetControl</strong>, <strong>TLS Decryption</strong>, etc.</li></ul><p id="22c5b2cc-075b-803a-b41d-f9f3047d1779" class="">Each framework supports specific use cases like alerts, input handling, file analysis, or packet control.</p><hr id="22c5b2cc-075b-8016-a4ff-d62f57c8bbfe"/><h2 id="22c5b2cc-075b-8019-a5f0-c82bc9869915" class="">📁 <strong>Zeek Logs &amp; Output</strong></h2><ul id="22c5b2cc-075b-8048-b40e-efcecd65cf07" class="bulleted-list"><li style="list-style-type:disc">When Zeek processes a <code>.pcap</code>, it <strong>creates log files</strong> automatically in the current working directory.</li></ul><ul id="22c5b2cc-075b-8020-8ef2-d92592a02ba8" class="bulleted-list"><li style="list-style-type:disc">If run as a <strong>service</strong>, logs are stored at:<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="22c5b2cc-075b-807d-9481-fda7bb69ac0f" class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">/opt/zeek/logs/
</code></pre></li></ul><h3 id="22c5b2cc-075b-8057-8f50-c63c7f59f515" class="">Common Zeek Logs (Examples):</h3><ul id="22c5b2cc-075b-8017-8ea4-c2b4bdced8e9" class="bulleted-list"><li style="list-style-type:disc"><code>conn.log</code> – Connection metadata</li></ul><ul id="22c5b2cc-075b-80ba-b1a9-c888600a3937" class="bulleted-list"><li style="list-style-type:disc"><code>http.log</code> – HTTP traffic</li></ul><ul id="22c5b2cc-075b-8092-9d57-d5df5bf75741" class="bulleted-list"><li style="list-style-type:disc"><code>dns.log</code> – DNS queries and responses</li></ul><ul id="22c5b2cc-075b-8072-bff8-febd1ef5b099" class="bulleted-list"><li style="list-style-type:disc"><code>ssl.log</code> – TLS handshake info</li></ul><ul id="22c5b2cc-075b-80fb-a140-f2a6f39a724d" class="bulleted-list"><li style="list-style-type:disc"><code>notice.log</code> – Alerts triggered by policies</li></ul><hr id="22c5b2cc-075b-8099-a20d-fd0825145c9e"/><h2 id="22c5b2cc-075b-805d-b388-c02c9f3a59c2" class="">▶️ <strong>Using Zeek</strong></h2><h3 id="22c5b2cc-075b-80a3-b491-f108dc010b5a" class="">✅ Check Version:</h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="22c5b2cc-075b-80f8-a828-cde72572fe7a" class="code code-wrap"><code class="language-Shell" style="white-space:pre-wrap;word-break:break-all">zeek -v
</code></pre><h3 id="22c5b2cc-075b-8040-8670-e71aa7ba9c7f" class="">✅ Run on a PCAP file:</h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="22c5b2cc-075b-80fd-ad0f-e69d22c258cf" class="code code-wrap"><code class="language-Shell" style="white-space:pre-wrap;word-break:break-all">zeek -r capture.pcap
</code></pre><ul id="22c5b2cc-075b-807f-b3f1-d68ef7020998" class="bulleted-list"><li style="list-style-type:disc">This analyzes the file and writes logs in the current folder.</li></ul><h3 id="22c5b2cc-075b-8003-b1ea-fb62f51e29ec" class="">✅ Run as a Service (via ZeekControl):</h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="22c5b2cc-075b-8059-ae2e-f93160fc528f" class="code code-wrap"><code class="language-Shell" style="white-space:pre-wrap;word-break:break-all">sudo su
cd /opt/zeek
./bin/zeekctl deploy</code></pre><hr id="22c5b2cc-075b-8056-bfa4-fb161e6c879a"/><p id="22c5b2cc-075b-80c5-97ab-c7ef8a51e8ea" class="">
</p><p id="22c5b2cc-075b-8085-9a92-e783755ee4fa" class="">Working with Zeek</p><p id="22c5b2cc-075b-8032-8772-ead116a056d7" class="">What is the installed Zeek instance version number?</p><p id="22c5b2cc-075b-804e-815b-ec4c434052b5" class="">zeek -v</p><figure id="22c5b2cc-075b-809c-9a57-c29372807705" class="image"><a href="assets/image%20131.png"><img style="width:710px" src="assets/image%20131.png"/></a></figure><p id="22c5b2cc-075b-80d5-9273-f803f0fb7275" class="">What is the version of the ZeekControl module?</p><figure id="22c5b2cc-075b-80c1-89a5-df2bfe513efc" class="image"><a href="assets/image%20132.png"><img style="width:709.9833374023438px" src="assets/image%20132.png"/></a></figure><p id="22c5b2cc-075b-802c-a272-ea11c9881afb" class="">Investigate the <strong>&quot;sample.pcap&quot;</strong> file. What is the number of generated alert files?<br/>8</p><figure id="22c5b2cc-075b-80a0-afed-ed8569c5a907" class="image"><a href="assets/image%20133.png"><img style="width:710px" src="assets/image%20133.png"/></a></figure><p id="22c5b2cc-075b-80e0-8967-fb5f7e0a84ca" class="">
</p><p id="22c5b2cc-075b-8034-b1a8-ee486d6fe876" class=""><strong>Zeek Logs</strong></p><p id="22c5b2cc-075b-8075-bcde-ce035df10df0" class="">Zeek generates log files according to the traffic data. You will have logs  for every connection in the wire, including the application level protocols and fields. Zeek is capable of identifying 50+ logs and categorising them into seven categories. Zeek logs are well structured and tab-separated ASCII files, so reading and processing them is easy but requires effort. You should be familiar with networking and protocols to correlate the logs in an investigation, know where to focus, and find a specific piece of evidence.</p><p id="22c5b2cc-075b-804b-bf95-e8771441b405" class="">Each log output consists of multiple fields, and each field holds a different part of the traffic data. Correlation is done through a unique value called &quot;UID&quot;. The &quot;UID&quot; represents the unique identifier assigned to each session.</p><p id="22c5b2cc-075b-8012-a7b7-ed1104229515" class=""><strong>Zeek logs in a nutshell;</strong></p><table id="22c5b2cc-075b-803d-ae76-fd52d7d30542" class="simple-table"><tbody><tr id="22c5b2cc-075b-8040-a53e-d0ede1d7ab04"><td id="olBY" class="">Category</td><td id=":`Zk" class="">Description</td><td id="M{@G" class="" style="width:359px"><strong>Log Files</strong></td></tr><tr id="22c5b2cc-075b-8072-a37f-dbed79a99a5b"><td id="olBY" class="">Network</td><td id=":`Zk" class="">Network protocol logs.</td><td id="M{@G" class="" style="width:359px"><em>conn.log, dce_rpc.log, dhcp.log, dnp3.log, dns.log, ftp.log, http.log, irc.log, kerberos.log, modbus.log, modbus_register_change.log, mysql.log, ntlm.log, ntp.log, radius.log, rdp.log, rfb.log, sip.log, smb_cmd.log, smb_files.log, smb_mapping.log, smtp.log, snmp.log, socks.log, ssh.log, ssl.log, syslog.log, tunnel.log.</em></td></tr><tr id="22c5b2cc-075b-8053-91a8-d188397dcdc7"><td id="olBY" class="">Files</td><td id=":`Zk" class="">File analysis result logs.</td><td id="M{@G" class="" style="width:359px"><em>files.log, ocsp.log, pe.log, x509.log.</em></td></tr><tr id="22c5b2cc-075b-80ab-a6f8-d23842d26655"><td id="olBY" class="">NetControl</td><td id=":`Zk" class="">Network control and flow logs.</td><td id="M{@G" class="" style="width:359px"><em>netcontrol.log, netcontrol_drop.log, netcontrol_shunt.log, netcontrol_catch_release.log, openflow.log.</em></td></tr><tr id="22c5b2cc-075b-8056-b6b1-d2cecb18f493"><td id="olBY" class="">Detection</td><td id=":`Zk" class="">Detection and possible indicator logs.</td><td id="M{@G" class="" style="width:359px"><em>intel.log, notice.log, notice_alarm.log, signatures.log, traceroute.log.</em></td></tr><tr id="22c5b2cc-075b-809e-9219-e0f562ffabc1"><td id="olBY" class="">Network Observations</td><td id=":`Zk" class="">Network flow logs.</td><td id="M{@G" class="" style="width:359px"><em>known_certs.log, known_hosts.log, known_modbus.log, known_services.log, software.log.</em></td></tr><tr id="22c5b2cc-075b-8012-94cc-c6848015bca9"><td id="olBY" class="">Miscellaneous</td><td id=":`Zk" class="">Additional logs cover external alerts, inputs and failures.</td><td id="M{@G" class="" style="width:359px"><em>barnyard2.log, dpd.log, unified2.log, unknown_protocols.log, weird.log, weird_stats.log.</em></td></tr><tr id="22c5b2cc-075b-808b-b183-d079983c74a0"><td id="olBY" class="">Zeek Diagnostic</td><td id=":`Zk" class="">Zeek diagnostic logs cover system messages, actions and some statistics.</td><td id="M{@G" class="" style="width:359px"><em>broker.log,<br/> capture_loss.log, cluster.log, config.log, loaded_scripts.log, <br/>packet_filter.log, print.log, prof.log, reporter.log, stats.log, <br/>stderr.log, stdout.log.</em></td></tr></tbody></table><h1 id="22c5b2cc-075b-80ad-8efc-c8181f5af0b9" class="">QUESTIONS</h1><p id="22c5b2cc-075b-808c-b2e6-e93fd49d6089" class="">Investigate the <strong>sample.pcap</strong> file. Investigate the <strong>dhcp.log</strong> file. What is the available hostname?</p><p id="22c5b2cc-075b-8070-bc02-c0ecee25eba6" class="">in the dhcp.log file, we can see 2 dhcp lease assignments, one succesfull and the other one failed.</p><p id="22c5b2cc-075b-80e0-841d-f55734074941" class="">Theey are happening in the host mcroknoppix</p><figure id="22c5b2cc-075b-8028-b515-fc30e9dbde30" class="image"><a href="assets/image%20134.png"><img style="width:2255px" src="assets/image%20134.png"/></a></figure><p id="22c5b2cc-075b-80ec-90d5-f0810c31980c" class="">Investigate the <strong>dns.log</strong> file. What is the number of unique DNS queries?</p><p id="22c5b2cc-075b-80db-85cd-f385a9d98272" class="">there seems to be many dns queries, but 2 unique ones, for A and AAAA records</p><figure id="22c5b2cc-075b-80b2-b45a-d9f68c809be3" class="image"><a href="assets/image%20135.png"><img style="width:2249px" src="assets/image%20135.png"/></a></figure><p id="22c5b2cc-075b-80c1-b977-d21a755b335c" class="">Investigate the <strong>conn.log</strong> file. What is the longest connection duration?</p><p id="22c5b2cc-075b-808f-af05-c3053b7cc6f7" class=""><code>cat conn.log | zeek-cut duration | sort -nr</code></p><figure id="22c5b2cc-075b-801d-8a82-c2285da83cca" class="image"><a href="assets/image%20136.png"><img style="width:710px" src="assets/image%20136.png"/></a></figure><figure id="22c5b2cc-075b-80e5-8645-dbec1e277d2e" class="image"><a href="assets/image%20137.png"><img style="width:2227px" src="assets/image%20137.png"/></a></figure><p id="22c5b2cc-075b-8019-ae3b-d3444c98446d" class="">
</p><h1 id="22c5b2cc-075b-802d-b369-ceeac9d4b878" class="">CLI Kung-Fu Recall: Processing Zeek Logs</h1><figure id="22c5b2cc-075b-801f-9eb9-cbfc7981b45c" class="image"><a href="assets/364aa0f61373366b6739d93112688b56.png"><img style="width:710px" src="assets/364aa0f61373366b6739d93112688b56.png"/></a></figure><table id="22c5b2cc-075b-80aa-8fd6-c58a22d85dd3" class="simple-table"><tbody><tr id="22c5b2cc-075b-802d-9228-faf9a8f8b189"><td id="OORT" class="">Category</td><td id="xH?I" class="">Command Purpose and Usage</td><td id="wzG[" class="">Category</td><td id="ww=S" class="">Command Purpose and Usage</td></tr><tr id="22c5b2cc-075b-80ce-a48d-d2ebc6599f28"><td id="OORT" class="">Basics</td><td id="xH?I" class="">View the command history:<code>ubuntu@ubuntu$ history</code><br/>Execute the 10th command in history:<br/><code>ubuntu@ubuntu$ !10</code><br/>Execute the previous command:<code>ubuntu@ubuntu$ !!</code></td><td id="wzG[" class=""><strong>Read File</strong></td><td id="ww=S" class=""><br/>Read sample.txt file:<br/><code>ubuntu@ubuntu$ cat sample.txt</code><br/><br/>Read the first 10 lines of the file:<br/><code>ubuntu@ubuntu$ head sample.txt</code><br/><br/>Read the last 10 lines of the file:<br/><code>ubuntu@ubuntu$ tail sample.txt</code></td></tr><tr id="22c5b2cc-075b-80fa-af1c-da1e1c9bd495"><td id="OORT" class="">Find&amp;Filter</td><td id="xH?I" class=""><br/>Cut the 1st field:<br/><code>ubuntu@ubuntu$ cat test.txt | cut -f 1</code><br/><br/>Cut the 1st column:<br/><code>ubuntu@ubuntu$ cat test.txt | cut -c1</code><br/><br/>Filter specific keywords:<br/><code>ubuntu@ubuntu$ cat test.txt | grep &#x27;keywords&#x27;</code><br/><br/>Sort outputs alphabetically:<br/><code>ubuntu@ubuntu$ cat test.txt | sort</code><br/>Sort outputs numerically:<br/><code>ubuntu@ubuntu$ cat test.txt | sort -n</code><br/>Eliminate duplicate lines:<br/><code>ubuntu@ubuntu$ cat test.txt | uniq</code><br/><br/>Count line numbers:<br/><code>ubuntu@ubuntu$ cat test.txt | wc -l</code><br/><br/>Show line numbers<br/><code>ubuntu@ubuntu$ cat test.txt | nl</code></td><td id="wzG[" class="">Advanced</td><td id="ww=S" class=""><br/>Print line 11:<code>ubuntu@ubuntu$ cat test.txt | sed -n &#x27;11p&#x27;</code><br/>Print lines between 10-15:<code>ubuntu@ubuntu$ cat test.txt | sed -n &#x27;10,15p&#x27;</code><br/>Print lines below 11:<br/><code>ubuntu@ubuntu$ cat test.txt | awk &#x27;NR &lt; 11 {print $0}&#x27;</code><br/><br/>Print line 11:<br/><code>ubuntu@ubuntu$ cat test.txt | awk &#x27;NR == 11 {print $0}&#x27;</code></td></tr></tbody></table><table id="22c5b2cc-075b-8056-afdd-f5e60a71f77d" class="simple-table"><tbody><tr id="22c5b2cc-075b-8050-8107-c526ec79f21e"><td id="?Ar~" class="" style="width:120px"><strong>Special</strong></td><td id="fnt{" class="" style="width:571px">Filter specific fields of Zeek logs:<code>ubuntu@ubuntu$ cat signatures.log | zeek-cut uid src_addr dst_addr</code></td></tr></tbody></table><table id="22c5b2cc-075b-80f8-8532-dcb55e3c3d0f" class="simple-table"><tbody><tr id="22c5b2cc-075b-8064-af41-de2387f2461b"><td id="aX;i" class=""><strong>Use Case</strong></td><td id="jbcv" class="" style="width:455px"><strong>Description</strong></td></tr><tr id="22c5b2cc-075b-8033-9413-c713ec1e18b8"><td id="aX;i" class=""><code>sort | uniq</code></td><td id="jbcv" class="" style="width:455px">Remove duplicate values.</td></tr><tr id="22c5b2cc-075b-80da-98c4-cb70a8e76750"><td id="aX;i" class=""><code>sort | uniq -c</code></td><td id="jbcv" class="" style="width:455px">Remove duplicates and count the number of occurrences for each value.</td></tr><tr id="22c5b2cc-075b-8080-b34e-cbf613ee16c1"><td id="aX;i" class=""><code>sort -nr</code></td><td id="jbcv" class="" style="width:455px">Sort values numerically and recursively.</td></tr><tr id="22c5b2cc-075b-807b-b564-d0cac273eb0d"><td id="aX;i" class=""><code>rev</code></td><td id="jbcv" class="" style="width:455px">Reverse string characters.</td></tr><tr id="22c5b2cc-075b-8078-aa22-d06260ed978b"><td id="aX;i" class=""><code>cut -f 1</code></td><td id="jbcv" class="" style="width:455px">Cut field 1.</td></tr><tr id="22c5b2cc-075b-8096-a1fb-e568d48dfc0b"><td id="aX;i" class=""><code>cut -d &#x27;.&#x27; -f 1-2</code></td><td id="jbcv" class="" style="width:455px">Split the string on every dot and print keep the first two fields.</td></tr><tr id="22c5b2cc-075b-80dd-9a0d-e6c1904111ab"><td id="aX;i" class=""><code>grep -v &#x27;test&#x27;</code></td><td id="jbcv" class="" style="width:455px">Display lines that  don&#x27;t match the &quot;test&quot; string.</td></tr><tr id="22c5b2cc-075b-80e0-822a-d77f933bd4e8"><td id="aX;i" class=""><code>grep -v -e &#x27;test1&#x27; -e &#x27;test2&#x27;</code></td><td id="jbcv" class="" style="width:455px">Display lines that don&#x27;t match one or both &quot;test1&quot; and &quot;test2&quot; strings.</td></tr><tr id="22c5b2cc-075b-8073-9253-d79f38284a93"><td id="aX;i" class=""><code>file</code></td><td id="jbcv" class="" style="width:455px">View file information.</td></tr><tr id="22c5b2cc-075b-800c-8ca1-ee44e4fee81b"><td id="aX;i" class=""><code>grep -rin Testvalue1 * | column -t | less -S</code></td><td id="jbcv" class="" style="width:455px">Search the &quot;Testvalue1&quot; string everywhere, organise column spaces and view the output with less.</td></tr></tbody></table><p id="22c5b2cc-075b-807e-b7d1-fd109f5533fa" class="">
</p><h1 id="22c5b2cc-075b-8026-99e4-de84d375538b" class="">ZEEK SIGNATURES</h1><p id="22c5b2cc-075b-809d-81d0-e9e469ea5d24" class="">Zeek signatures are composed of three logical paths; signature id, conditions and action. The signature breakdown is shown in the table below;</p><table id="22c5b2cc-075b-803a-b03d-f04752125b34" class="simple-table"><tbody><tr id="22c5b2cc-075b-80ba-a1aa-f5b4852f56b7"><td id=":Qw@" class=""><strong>Signature id</strong></td><td id="rm}|" class="" style="width:586px"><strong>Unique</strong> signature name.</td></tr><tr id="22c5b2cc-075b-80a8-aff0-d73d3b8ddf1c"><td id=":Qw@" class=""><strong>Conditions</strong></td><td id="rm}|" class="" style="width:586px"><strong>Header: </strong>Filtering the packet headers for specific source and destination addresses, protocol and port numbers.<strong>Content: Filtering the packet payload for specific value/pattern.</strong></td></tr><tr id="22c5b2cc-075b-805b-bd27-f1653990ba48"><td id=":Qw@" class=""><strong>Action</strong></td><td id="rm}|" class="" style="width:586px"><strong>Default action: </strong>Create the &quot;signatures.log&quot; file in case of a signature match.<br/><strong>Additional action: </strong>Trigger a Zeek script.</td></tr></tbody></table><p id="22c5b2cc-075b-8094-8995-d2d057534986" class="">
</p><table id="22c5b2cc-075b-80b4-a26f-f96a102546b1" class="simple-table"><tbody><tr id="22c5b2cc-075b-803b-a1c1-e515e8b95cc4"><td id="T{mg" class="">Condition Field</td><td id=":WzO" class="" style="width:592px">Available Filters</td></tr><tr id="22c5b2cc-075b-8094-8e8c-fe912075858c"><td id="T{mg" class="">Header</td><td id=":WzO" class="" style="width:592px">src-ip: Source IP.dst-ip: Destination IP.src-port: Source port.dst-port: Destination port.ip-proto: Target protocol. Supported protocols; TCP, UDP, ICMP, ICMP6, IP, IP6</td></tr><tr id="22c5b2cc-075b-808e-bf4b-c8ea96788890"><td id="T{mg" class="">Content</td><td id=":WzO" class="" style="width:592px"><strong>payload:</strong> Packet payload.<strong>http-request: </strong>Decoded HTTP requests.<strong>http-request-header:</strong> Client-side HTTP headers.<strong>http-request-body:</strong> Client-side HTTP request bodys.<strong>http-reply-header:</strong> Server-side HTTP headers.<strong>http-reply-body:</strong> Server-side HTTP request bodys.<strong>ftp:</strong> Command line input of FTP sessions.</td></tr><tr id="22c5b2cc-075b-80d8-b221-f25650456731"><td id="T{mg" class=""><strong>Context</strong></td><td id=":WzO" class="" style="width:592px"><strong>same-ip:</strong> Filtering the source and destination addresses for duplication.</td></tr><tr id="22c5b2cc-075b-809d-b1ec-f3f53e1173d1"><td id="T{mg" class="">Action</td><td id=":WzO" class="" style="width:592px"><strong>event: </strong>Signature match message.</td></tr><tr id="22c5b2cc-075b-80e6-bb55-ff5d81fb7d25"><td id="T{mg" class=""><strong>ComparisonOperators</strong></td><td id=":WzO" class="" style="width:592px"><strong>==</strong>, <strong>!=</strong>, <strong>&lt;</strong>, <strong>&lt;=</strong>, <strong>&gt;</strong>, <strong>&gt;=</strong></td></tr><tr id="22c5b2cc-075b-8005-9a75-c0ae4ce5f8e2"><td id="T{mg" class=""><strong>NOTE!</strong></td><td id=":WzO" class="" style="width:592px">Filters accept string, numeric and regex values.</td></tr></tbody></table><figure id="22c5b2cc-075b-807c-a1ad-c5ad9abdd430" class="image"><a href="assets/image%20138.png"><img style="width:709.933349609375px" src="assets/image%20138.png"/></a></figure><p id="22c5b2cc-075b-8005-bfc2-edbcc86b9660" class="">Zeek signatures use the &quot;.sig&quot; extension.</p><hr id="22c5b2cc-075b-8005-92bb-ea4e21b89a5d"/><ul id="22c5b2cc-075b-80a9-bf50-e65f3355f616" class="bulleted-list"><li style="list-style-type:disc">C: Ignore checksum errors.</li></ul><ul id="22c5b2cc-075b-80d5-9f1b-f2726cecb77b" class="bulleted-list"><li style="list-style-type:disc">-r: Read pcap file.</li></ul><ul id="22c5b2cc-075b-8042-85f9-c18c90eff771" class="bulleted-list"><li style="list-style-type:disc">s: Use signature file.</li></ul><hr id="22c5b2cc-075b-8045-a640-d9cb89b4ba00"/><figure id="22c5b2cc-075b-8048-87ba-d92458ff56d1" class="image"><a href="assets/image%20139.png"><img style="width:710px" src="assets/image%20139.png"/></a></figure><figure id="22c5b2cc-075b-80c2-87d6-fe565318770f" class="image"><a href="assets/image%20140.png"><img style="width:710px" src="assets/image%20140.png"/></a></figure><p id="22c5b2cc-075b-80ce-80ea-c954c33e3062" class="">here, zeek was run with the signature created above against the http.pcap</p><p id="22c5b2cc-075b-8027-80e0-e9a180f4c2c4" class="">then it trew the alert password fund</p><h2 id="22c5b2cc-075b-80c2-a274-eaa663d5fe58" class="">Questions</h2><ol type="1" id="22c5b2cc-075b-8044-9c61-e96dd5d88de2" class="numbered-list" start="1"><li>Investigate the <strong>http.pcap</strong> file. Create the  HTTP signature shown in the task and investigate the pcap. What is the source IP of the first event?</li></ol><figure id="22c5b2cc-075b-804e-9805-dbf9f1cb2569" class="image"><a href="assets/image%20141.png"><img style="width:710px" src="assets/image%20141.png"/></a></figure><figure id="22c5b2cc-075b-8094-a3cd-e20b1da26864" class="image"><a href="assets/image%20142.png"><img style="width:710px" src="assets/image%20142.png"/></a></figure><ol type="1" id="22c5b2cc-075b-806e-98fc-deab4ec47dba" class="numbered-list" start="2"><li>What is the source port of the second event?</li></ol><figure id="22c5b2cc-075b-801e-a42b-ed00346af503" class="image"><a href="assets/image%20143.png"><img style="width:709.9666748046875px" src="assets/image%20143.png"/></a></figure><ol type="1" id="22c5b2cc-075b-8078-865c-c77f84ef0cd7" class="numbered-list" start="3"><li>Investigate the <strong>conn.log. </strong>What is the total number of the sent and received packets from source port 38706?</li></ol><p id="22c5b2cc-075b-8099-bf2e-d4ad7ef5d0fa" class=""><code>cat conn.log | zeek-cut id.orig_h id.orig_p orig_pkts resp_pkts</code></p><figure id="22c5b2cc-075b-80a4-bfdd-f91cdad4549e" class="image"><a href="assets/image%20144.png"><img style="width:710px" src="assets/image%20144.png"/></a></figure><p id="22c5b2cc-075b-807c-9ed8-e337dd55c7bc" class="">Create the global rule shown in the task and investigate the <strong>ftp.pcap </strong>file.</p><p id="22c5b2cc-075b-80d7-bf7b-ef38732d5413" class="">Investigate the<strong> notice.log. </strong>What is the number of unique events?</p><figure id="22c5b2cc-075b-80fc-ac74-ccd97c3b4de9" class="image"><a href="assets/image%20145.png"><img style="width:392px" src="assets/image%20145.png"/></a></figure><figure id="22c5b2cc-075b-805f-8b60-f7b27fcf49a8" class="image"><a href="assets/image%20146.png"><img style="width:709.9833374023438px" src="assets/image%20146.png"/></a></figure><p id="22c5b2cc-075b-80e3-8782-cafb1beb2cb2" class="">once i have the notice.log, I need to find a way to count the unique values in them, for that i can use the following commands, whihc will cut the uid from the logs, then sort them and remove duplicated using uniq and do a count with wc -l</p><p id="22c5b2cc-075b-8057-879b-f48cae064f49" class=""><code>cat notice.log | zeek-cut uid | sort | uniq | wc -l</code></p><p id="22c5b2cc-075b-8065-ba8f-f89684fab39a" class="">
</p><ol type="1" id="22c5b2cc-075b-802a-a73f-ca5a9402cb6f" class="numbered-list" start="4"><li>What is the number of <strong>ftp-brute </strong>signature matches?</li></ol><p id="22c5b2cc-075b-8047-92b2-ce4dd3013188" class="">In order to get this information, I had to first read a few lines, then find out the signature id, then use that sig_id as a filter to sort and uiq -c<br/>so i use zeek-cut for sig id then use sort and uniq -c to get the unique count for both</p><figure id="22c5b2cc-075b-8000-8966-c4e74caf46f5" class="image"><a href="assets/image%20147.png"><img style="width:2252px" src="assets/image%20147.png"/></a></figure><p id="22c5b2cc-075b-80ba-a658-cc35f395fb33" class="">
</p><h1 id="22c5b2cc-075b-8002-8908-e3704be800b7" class="">Zeek Scripts | Fundamentals</h1><ul id="22c5b2cc-075b-8000-9525-f894168ee46f" class="bulleted-list"><li style="list-style-type:disc"><strong>Event-driven scripting language</strong> (not just config).</li></ul><ul id="22c5b2cc-075b-80ff-b38b-fec51992de84" class="bulleted-list"><li style="list-style-type:disc">Similar in power and structure to <strong>Python</strong> or <strong>JavaScript</strong>, with C-like syntax.</li></ul><ul id="22c5b2cc-075b-80f6-82cf-f2597801a6ef" class="bulleted-list"><li style="list-style-type:disc">Used to <strong>inspect, log, or respond</strong> to network events.</li></ul><h3 id="22c5b2cc-075b-8017-86a4-f1aa69403574" class="">✅ Use Cases:</h3><ul id="22c5b2cc-075b-80fa-ba3f-ca49e2899e8f" class="bulleted-list"><li style="list-style-type:disc">Raise alerts based on specific traffic patterns.</li></ul><ul id="22c5b2cc-075b-801a-be78-f0d6a9f38dd0" class="bulleted-list"><li style="list-style-type:disc">Log custom events.</li></ul><ul id="22c5b2cc-075b-80ef-855e-c5c16c6395a2" class="bulleted-list"><li style="list-style-type:disc">Block or tag suspicious traffic (when integrated).</li></ul><ul id="22c5b2cc-075b-80fc-8761-f0aa8a3e2cf3" class="bulleted-list"><li style="list-style-type:disc">Perform threat intelligence correlation.</li></ul><table id="22c5b2cc-075b-808b-b7f6-e82d95ada6bf" class="simple-table"><tbody><tr id="22c5b2cc-075b-8075-8ab0-e1fd8d57793b"><td id="CJbt" class="" style="width:297.1000061035156px">Zeek has base scripts installed by default, and these are not intended to be modified.</td><td id="NCaF" class="" style="width:411px">These scripts are located in &quot;/opt/zeek/share/zeek/base&quot;.</td></tr><tr id="22c5b2cc-075b-808a-88e1-c9c743a2b906"><td id="CJbt" class="" style="width:297.1000061035156px">User-generated or modified scripts should be located in a specific path.</td><td id="NCaF" class="" style="width:411px">These scripts are located in<strong>&quot;/opt/zeek/share/zeek/site&quot;.</strong></td></tr><tr id="22c5b2cc-075b-80e6-9ce1-efe1532d6159"><td id="CJbt" class="" style="width:297.1000061035156px">Policy scripts are located in a specific path.</td><td id="NCaF" class="" style="width:411px">These scripts are located in <strong>&quot;/opt/zeek/share/zeek/policy&quot;</strong>.</td></tr><tr id="22c5b2cc-075b-8019-934f-d38d526f4c17"><td id="CJbt" class="" style="width:297.1000061035156px">Like Snort, to automatically load/use a script in live sniffing mode, you must identify the script in the Zeek configuration file. You can also use a script for a single run, just like the signatures.</td><td id="NCaF" class="" style="width:411px">The configuration file is located in &quot;/opt/zeek/share/zeek/site/local.zeek&quot;.</td></tr><tr id="22c5b2cc-075b-801c-91dd-d09db7c89596"><td id="CJbt" class="" style="width:297.1000061035156px"></td><td id="NCaF" class="" style="width:411px"></td></tr></tbody></table><p id="22c5b2cc-075b-80bd-9204-c05bc2425f8c" class="">Customized script locations</p><hr id="22c5b2cc-075b-80ff-917f-f676c90c1bed"/><p id="22c5b2cc-075b-80be-8019-c40a1ad5477d" class="">/opt/zeek/share/zeek/base/bif</p><p id="22c5b2cc-075b-8081-b5ed-ca7dc0f87aef" class="">/opt/zeek/share/zeek/base/bif/plugins</p><p id="22c5b2cc-075b-80bb-80b7-da1f8b96f3f5" class="">/opt/zeek/share/zeek/base/protocols</p><hr id="22c5b2cc-075b-803d-99e1-f95a3c42d72f"/><h2 id="22c5b2cc-075b-80ff-b064-f84841791873" class="">QUESTIONS</h2><ol type="1" id="22c5b2cc-075b-80f1-8342-c54aa7fb2e6a" class="numbered-list" start="1"><li>Investigate the <strong>smallFlows.pcap</strong> file. Investigate the <strong>dhcp.log</strong> file. What is the domain value of the <strong>&quot;vinlap01&quot;</strong> host?</li></ol><figure id="22c5b2cc-075b-807d-b263-dce4d0aefac1" class="image"><a href="assets/image%20148.png"><img style="width:710px" src="assets/image%20148.png"/></a></figure><ol type="1" id="22c5b2cc-075b-8018-a388-c6803df2831b" class="numbered-list" start="2"><li>Investigate the <strong>big</strong>Flows.pcap file. Investigate the <strong>dhcp.log</strong> file. What is the number of identified unique hostnames?</li></ol><p id="22c5b2cc-075b-803a-802c-e3fa8119e5cf" class="">i read the file and used the header host_name to zeek-cut, then used sort uniq and wc -l to figure out the total </p><figure id="22c5b2cc-075b-80bb-a1e8-e1fad46fc1c5" class="image"><a href="assets/image%20149.png"><img style="width:709.9833374023438px" src="assets/image%20149.png"/></a></figure><ol type="1" id="22c5b2cc-075b-8079-ba71-f15f9028eeb7" class="numbered-list" start="3"><li>Investigate the dhcp.log file. What is the identified domain value?</li></ol><figure id="22c5b2cc-075b-8038-9813-dc9655e8dbc9" class="image"><a href="assets/image%20150.png"><img style="width:709.9666748046875px" src="assets/image%20150.png"/></a></figure><p id="22c5b2cc-075b-8022-a2da-cff24268cfa4" class="">
</p><h1 id="22c5b2cc-075b-80fc-b9f3-fa57cfa145f9" class="">Zeek Scripts | Scripts and Signatures</h1><h2 id="22c5b2cc-075b-8083-b924-c3539d5caf5c" class="">Questions</h2><ol type="1" id="22c5b2cc-075b-8009-ab4a-f7e2434fa967" class="numbered-list" start="1"><li>Go to folder <strong>TASK-7/101</strong>.Investigate the sample.pcap file with <strong>103.zeek script</strong>. Investigate the <strong>terminal output</strong>. What is the number of the detected new connections?</li></ol><p id="22c5b2cc-075b-805e-9230-d48edaab32a4" class=""><code>zeek -C -r sample.pcap 103.zeek </code></p><p id="22c5b2cc-075b-804c-a85e-de7cf3c74705" class="">This will output eveything in the terminal, in order to find out how many new connections were found, ther are 2 ways to do it, One is to output this into a text file and use grep to find out how many are there</p><figure id="22c5b2cc-075b-806b-99a9-cecedd83e990" class="image"><a href="assets/image%20151.png"><img style="width:710px" src="assets/image%20151.png"/></a></figure><p id="22c5b2cc-075b-8039-b021-ce7d2b67e376" class="">or I can modify the script to include the count at the end.<br/></p><figure id="22c5b2cc-075b-8004-9146-f73af9436dc7" class="image"><a href="assets/image%20152.png"><img style="width:622px" src="assets/image%20152.png"/></a></figure><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="22c5b2cc-075b-80aa-8ca8-d671eecce0c6" class="code code-wrap"><code class="language-Python" style="white-space:pre-wrap;word-break:break-all">global new_conn_count: count = 0;
event new_connection(c: connection)
{
new_conn_count += 1;

print (&quot;###########################################################&quot;);
print (&quot;&quot;);
print (&quot;New Connection Found!&quot;);
print (&quot;&quot;);
print fmt (&quot;Source Host: %s # %s ---&gt;&quot;, c$id$orig_h, c$id$orig_p);
print fmt (&quot;Destination Host: resp: %s # %s &lt;---&quot;, c$id$resp_h, c$id$resp_p);
print (&quot;&quot;);
}
event zeek_done()
{
print (&quot;###########################################################&quot;);
print fmt(&quot;Total new connections detected: %d&quot;, new_conn_count);
}
</code></pre><ol type="1" id="22c5b2cc-075b-8086-8d03-fc2cdb3bdc68" class="numbered-list" start="2"><li>Go to folder TASK-7/201.Investigate the ftp.pcap file with <strong>ftp-admin.sig</strong> signature and  <strong>201.zeek </strong>script. Investigate the signatures.log file. What <strong>i</strong>s the number of signature hits?</li></ol><p id="22c5b2cc-075b-808c-a8a0-e4f63e3e90cc" class=""><code>zeek -C -r ftp.pcap -s ftp-admin.sig 201.zeek </code>  to do the analysis using both the signature and the zeek script, then to get the count from the output - <code>cat signatures.log | zeek-cut event_msg | wc -l</code></p><figure id="22c5b2cc-075b-8079-9519-f638a9c2f171"><div class="source"><a href="https://www.notion.soundefined"></a></div></figure><ol type="1" id="22c5b2cc-075b-8071-8d7f-f39ac31ed40d" class="numbered-list" start="3"><li>Investigate the signatures.log file. What is the total number of &quot;administrator&quot; username detections?<br/>I can use the same output, then use grep and wc to get the count</li></ol><figure id="22c5b2cc-075b-802f-bf38-f3adac26925e" class="image"><a href="assets/image%20153.png"><img style="width:710px" src="assets/image%20153.png"/></a></figure><ol type="1" id="22c5b2cc-075b-80d8-9c72-f5a38bcf361e" class="numbered-list" start="4"><li>Investigate the <strong>ftp.pcap</strong> file with <strong>all local scripts</strong>, and investigate the loaded_scripts.log file. What is the total number of loaded scripts?<br/>First i ran zeek with all ocal scripts loaded by <code>zeek -C -r ftp.pcap local</code>, then from the output, I need to identify the number of scripts tat was loaded, for that I had to grep out the metadata and do a count with wc -l<br/><code>grep -v &#x27;^#&#x27; loaded_scripts.log | wc -l</code></li></ol><figure id="22c5b2cc-075b-80dc-bc7d-ca32f109d2d4" class="image"><a href="assets/image%20154.png"><img style="width:709.9666748046875px" src="assets/image%20154.png"/></a></figure><ol type="1" id="22c5b2cc-075b-8069-9dab-d46370adc28b" class="numbered-list" start="5"><li>Go to folder TASK-7/202.Investigate the ftp-brute.pcap file with <strong>&quot;/opt/zeek/share/zeek/policy/protocols/ftp/detect-bruteforcing.zeek&quot; </strong>script. Investigate the notice.log file. What is the total number of brute-force detection?</li></ol><figure id="22c5b2cc-075b-80f8-b05d-d87c3d629b16" class="image"><a href="assets/image%20155.png"><img style="width:2242px" src="assets/image%20155.png"/></a></figure><p id="22c5b2cc-075b-80a8-b00e-ff69ff7a6242" class="">
</p><h2 id="22c5b2cc-075b-8055-b9d7-e1b95aca447a" class="">Zeek Scripts | Frameworks</h2><p id="22c5b2cc-075b-80c6-a706-f1b544cf2c6b" class=""><a href="https://docs.zeek.org/en/master/frameworks/index.html">https://docs.zeek.org/en/master/frameworks/index.html</a></p><p id="22c5b2cc-075b-80e4-a341-ddc7979a7854" class="">frameworks can be used to grab file hashes, extract files etc.</p><figure id="22c5b2cc-075b-8053-ba51-e0a95ca7d1ff" class="image"><a href="assets/image%20156.png"><img style="width:710px" src="assets/image%20156.png"/></a></figure><figure id="22c5b2cc-075b-80b3-a662-f181e120973f" class="image"><a href="assets/image%20157.png"><img style="width:709.9833374023438px" src="assets/image%20157.png"/></a></figure><p id="22c5b2cc-075b-800e-ad57-e7881ce1992b" class=""><br/>We successfully extracted files from the pcap. A new folder called &quot;extract_files&quot; is automatically created, and all  detected files are located in it. First, we will list the contents of the folder, and then we will use the <code>file</code> command to determine the file type of the extracted files.<br/></p><figure id="22c5b2cc-075b-8037-83cb-f3baaa4895ae" class="image"><a href="assets/image%20158.png"><img style="width:710px" src="assets/image%20158.png"/></a></figure><p id="22c5b2cc-075b-808a-b08e-cef18211affb" class="">The given terminal output shows us that there are three files extracted from the traffic capture. Let&#x27;s look at the file.log and correlate the findings with the rest of the log files. </p><figure id="22c5b2cc-075b-8069-be84-fc0c16c76c3d" class="image"><a href="assets/image%20159.png"><img style="width:710px" src="assets/image%20159.png"/></a></figure><p id="22c5b2cc-075b-8021-ba46-c706b4450c9c" class="">
</p><h2 id="22c5b2cc-075b-8069-86f3-d8e76f71cb8b" class="">Notice Framework | Intelligence</h2><figure id="22c5b2cc-075b-80a3-915b-c396278e3c2b" class="image"><a href="assets/image%20160.png"><img style="width:710px" src="assets/image%20160.png"/></a></figure><p id="22c5b2cc-075b-80f4-a2c0-e9e393339a5c" class="">
</p><p id="22c5b2cc-075b-806b-9115-ca914ac47c75" class="">Questions</p><ul id="22c5b2cc-075b-80da-bc44-f46b1e35d412" class="bulleted-list"><li style="list-style-type:disc">Investigate the <strong>case1</strong>.pcap file with <strong>intelligence-demo.zeek</strong> script. Investigate the <strong>intel.log</strong> file. Look at the second finding, where was the intel info found?</li></ul><p id="22c5b2cc-075b-8017-bdeb-cb172b2014ea" class="">I ran the pacp against the inetlligence demo script, and got an intel file, from teh intel file i can see that the intel was seen from the “seen.where” value, which is IN HOST HEADER</p><figure id="22c5b2cc-075b-807e-a374-de9bde39219d" class="image"><a href="assets/image%20161.png"><img style="width:710px" src="assets/image%20161.png"/></a></figure><figure id="22c5b2cc-075b-8069-94d1-c625a5023de6" class="image"><a href="assets/image%20162.png"><img style="width:710px" src="assets/image%20162.png"/></a></figure><ul id="22c5b2cc-075b-8059-a166-ee8c131e84c1" class="bulleted-list"><li style="list-style-type:disc">Investigate the <strong>http.log </strong>file. What is the name of the downloaded .exe file?</li></ul><figure id="22c5b2cc-075b-803b-ab47-f55a557cca9e" class="image"><a href="assets/image%20163.png"><img style="width:2282px" src="assets/image%20163.png"/></a></figure><ul id="22c5b2cc-075b-8019-aef1-c685d14fa279" class="bulleted-list"><li style="list-style-type:disc">Investigate the case1.pcap file with <strong>hash-demo.zeek </strong>script. Investigate the files.log file. What is the MD5 hash of the downloaded .exe file?</li></ul><p id="22c5b2cc-075b-8060-9db3-f13580ce52ae" class="">I ran the hash demo script, then I use zeek-cut to see only finename mime type nd md5 hash, from there i can see the exec md5 hash</p><figure id="22c5b2cc-075b-804d-b21b-d00b576f359f" class="image"><a href="assets/image%20164.png"><img style="width:2285px" src="assets/image%20164.png"/></a></figure><ul id="22c5b2cc-075b-80ed-88f7-c8f2d36f47b8" class="bulleted-list"><li style="list-style-type:disc">Investigate the case1.pcap file with <strong>file-extract-demo.zeek</strong> script. Investigate the &quot;extract_files&quot; folder. Review the contents of the text file. What is written in the file?</li></ul><figure id="22c5b2cc-075b-80cd-8586-d63d5966b050" class="image"><a href="assets/image%20165.png"><img style="width:2280px" src="assets/image%20165.png"/></a></figure><p id="22c5b2cc-075b-803b-9f1d-e867b0fae435" class="">in the extracted field folder, I can see 3 files, I used file 8 to know the types and then cat the txt file to see its content</p><p id="22c5b2cc-075b-80e6-9954-e55b78abc2e8" class="">
</p><h2 id="22c5b2cc-075b-809c-83dd-f3ce74777b0c" class="">Zeek Scripts | Packages</h2><figure id="22c5b2cc-075b-80cb-b5a3-f89a5b4cd592" class="image"><a href="assets/7f04a7fc9417676b573a29bbd914f6fa.png"><img style="width:710px" src="assets/7f04a7fc9417676b573a29bbd914f6fa.png"/></a></figure><p id="22c5b2cc-075b-8012-b573-c42b34992390" class="">Zeek Package Manager helps users install third-party scripts and plugins to extend Zeek functionalities with ease. The package manager is installed with Zeek and available with the <code>zkg</code> command. Users can install, load, remove, update and create packages with the &quot;zkg&quot; tool<br/><br/></p><table id="22c5b2cc-075b-805a-879f-ced82f535026" class="simple-table"><tbody><tr id="22c5b2cc-075b-8053-90f4-ce5f3061cd3a"><td id="yaj@" class=""><strong>Command</strong></td><td id="=_FN" class="" style="width:512px"><strong>Description</strong></td></tr><tr id="22c5b2cc-075b-8092-b0b3-f8d6c9ed5b5e"><td id="yaj@" class=""><code>zkg install package_path</code></td><td id="=_FN" class="" style="width:512px">Install a package. Example (zkg install zeek/j-gras/zeek-af_packet-plugin).</td></tr><tr id="22c5b2cc-075b-80c4-9615-d6c8eb62a652"><td id="yaj@" class=""><code>zkg install git_url</code></td><td id="=_FN" class="" style="width:512px">Install package. Example (zkg install https://github.com/corelight/ztest).</td></tr><tr id="22c5b2cc-075b-8022-82fe-e4d9a81abf04"><td id="yaj@" class=""><code>zkg list</code></td><td id="=_FN" class="" style="width:512px">List installed package.</td></tr><tr id="22c5b2cc-075b-80c8-9034-c3df09b37a21"><td id="yaj@" class=""><code>zkg remove</code></td><td id="=_FN" class="" style="width:512px">Remove installed package.</td></tr><tr id="22c5b2cc-075b-809d-96b0-ebc03cc55196"><td id="yaj@" class=""><code>zkg refresh</code></td><td id="=_FN" class="" style="width:512px">Check version updates for installed packages.</td></tr><tr id="22c5b2cc-075b-809c-9def-fc4da727c65d"><td id="yaj@" class=""><code>zkg upgrade</code></td><td id="=_FN" class="" style="width:512px">Update installed packages.</td></tr></tbody></table><p id="22c5b2cc-075b-80c6-8dfc-ee7dc300c979" class="">Let&#x27;s install a package first and then demonstrate the usage in different approaches. sor</p><figure id="22c5b2cc-075b-807b-a929-ee8bb77013a1" class="image"><a href="assets/image%20166.png"><img style="width:709.9666748046875px" src="assets/image%20166.png"/></a></figure><figure id="22c5b2cc-075b-805a-b103-c00fe8e4cd80" class="image"><a href="assets/image%20167.png"><img style="width:710px" src="assets/image%20167.png"/></a></figure><p id="22c5b2cc-075b-80de-a847-dfe21910e328" class="">The above output demonstrates how to execute/load packages against a pcap. You can use the best one for your case. The &quot;zeek-sniffpass&quot; package provides additional information in the notice.log file. Now let&#x27;s review the logs and discover the obtained data using the specific package.</p><figure id="22c5b2cc-075b-80ac-8446-e371e81821c7" class="image"><a href="assets/image%20168.png"><img style="width:709.9833374023438px" src="assets/image%20168.png"/></a></figure><figure id="22c5b2cc-075b-8051-a49d-f734fe700dcf" class="image"><a href="assets/image%20169.png"><img style="width:710px" src="assets/image%20169.png"/></a></figure><p id="22c5b2cc-075b-8097-a2c6-fff1bfd7125e" class="">
</p><h2 id="22c5b2cc-075b-8024-939e-ee5cd0a609dd" class="">questions</h2><ul id="22c5b2cc-075b-80ee-8286-db0b9943c9d2" class="bulleted-list"><li style="list-style-type:disc">Investigate the http.pcap file with the <strong>zeek-sniffpass</strong> module. Investigate the notice.log file. Which username has more module hits?</li></ul><figure id="22c5b2cc-075b-8028-8564-e5e82e3f22a4" class="image"><a href="assets/image%20170.png"><img style="width:710px" src="assets/image%20170.png"/></a></figure><ul id="22c5b2cc-075b-80a0-a7bc-c3353ba4df29" class="bulleted-list"><li style="list-style-type:disc">Investigate the case2.pcap file with <strong>geoip-conn </strong>module. Investigate the conn.log file. What is the name of the identified City?</li></ul><figure id="22c5b2cc-075b-8027-9e19-c4c095623ba5" class="image"><a href="assets/image%20171.png"><img style="width:709.9666748046875px" src="assets/image%20171.png"/></a></figure><ul id="22c5b2cc-075b-802b-a62c-c082bb87b943" class="bulleted-list"><li style="list-style-type:disc">Which IP address is associated with the identified City?</li></ul><p id="22c5b2cc-075b-80d9-b56c-f5544d6a867b" class="">from the above screenshot we can see that the IP 23 77 x x is associate dwith chicago</p><ul id="22c5b2cc-075b-8092-9100-f429fcab365b" class="bulleted-list"><li style="list-style-type:disc">Investigate the case2.pcap file with <strong>sumstats-counttable.zeek</strong> script. How many types of status codes are there in the given traffic capture?</li></ul><figure id="22c5b2cc-075b-8028-809b-d1b2ee2fd063" class="image"><a href="assets/image%20172.png"><img style="width:709.9500122070312px" src="assets/image%20172.png"/></a></figure></div></article><span class="sans" style="font-size:14px;padding-top:2em"></span></body></html>