<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>SIEM</title><style>
/* cspell:disable-file */
/* webkit printing magic: print all background colors */
html {
	-webkit-print-color-adjust: exact;
}
* {
	box-sizing: border-box;
	-webkit-print-color-adjust: exact;
}

html,
body {
	margin: 0;
	padding: 0;
}
@media only screen {
	body {
		margin: 2em auto;
		max-width: 900px;
		color: rgb(55, 53, 47);
	}
}

body {
	line-height: 1.5;
	white-space: pre-wrap;
}

a,
a.visited {
	color: inherit;
	text-decoration: underline;
}

.pdf-relative-link-path {
	font-size: 80%;
	color: #444;
}

h1,
h2,
h3 {
	letter-spacing: -0.01em;
	line-height: 1.2;
	font-weight: 600;
	margin-bottom: 0;
}

.page-title {
	font-size: 2.5rem;
	font-weight: 700;
	margin-top: 0;
	margin-bottom: 0.75em;
}

h1 {
	font-size: 1.875rem;
	margin-top: 1.875rem;
}

h2 {
	font-size: 1.5rem;
	margin-top: 1.5rem;
}

h3 {
	font-size: 1.25rem;
	margin-top: 1.25rem;
}

.source {
	border: 1px solid #ddd;
	border-radius: 3px;
	padding: 1.5em;
	word-break: break-all;
}

.callout {
	border-radius: 3px;
	padding: 1rem;
}

figure {
	margin: 1.25em 0;
	page-break-inside: avoid;
}

figcaption {
	opacity: 0.5;
	font-size: 85%;
	margin-top: 0.5em;
}

mark {
	background-color: transparent;
}

.indented {
	padding-left: 1.5em;
}

hr {
	background: transparent;
	display: block;
	width: 100%;
	height: 1px;
	visibility: visible;
	border: none;
	border-bottom: 1px solid rgba(55, 53, 47, 0.09);
}

img {
	max-width: 100%;
}

@media only print {
	img {
		max-height: 100vh;
		object-fit: contain;
	}
}

@page {
	margin: 1in;
}

.collection-content {
	font-size: 0.875rem;
}

.column-list {
	display: flex;
	justify-content: space-between;
}

.column {
	padding: 0 1em;
}

.column:first-child {
	padding-left: 0;
}

.column:last-child {
	padding-right: 0;
}

.table_of_contents-item {
	display: block;
	font-size: 0.875rem;
	line-height: 1.3;
	padding: 0.125rem;
}

.table_of_contents-indent-1 {
	margin-left: 1.5rem;
}

.table_of_contents-indent-2 {
	margin-left: 3rem;
}

.table_of_contents-indent-3 {
	margin-left: 4.5rem;
}

.table_of_contents-link {
	text-decoration: none;
	opacity: 0.7;
	border-bottom: 1px solid rgba(55, 53, 47, 0.18);
}

table,
th,
td {
	border: 1px solid rgba(55, 53, 47, 0.09);
	border-collapse: collapse;
}

table {
	border-left: none;
	border-right: none;
}

th,
td {
	font-weight: normal;
	padding: 0.25em 0.5em;
	line-height: 1.5;
	min-height: 1.5em;
	text-align: left;
}

th {
	color: rgba(55, 53, 47, 0.6);
}

ol,
ul {
	margin: 0;
	margin-block-start: 0.6em;
	margin-block-end: 0.6em;
}

li > ol:first-child,
li > ul:first-child {
	margin-block-start: 0.6em;
}

ul > li {
	list-style: disc;
}

ul.to-do-list {
	padding-inline-start: 0;
}

ul.to-do-list > li {
	list-style: none;
}

.to-do-children-checked {
	text-decoration: line-through;
	opacity: 0.375;
}

ul.toggle > li {
	list-style: none;
}

ul {
	padding-inline-start: 1.7em;
}

ul > li {
	padding-left: 0.1em;
}

ol {
	padding-inline-start: 1.6em;
}

ol > li {
	padding-left: 0.2em;
}

.mono ol {
	padding-inline-start: 2em;
}

.mono ol > li {
	text-indent: -0.4em;
}

.toggle {
	padding-inline-start: 0em;
	list-style-type: none;
}

/* Indent toggle children */
.toggle > li > details {
	padding-left: 1.7em;
}

.toggle > li > details > summary {
	margin-left: -1.1em;
}

.selected-value {
	display: inline-block;
	padding: 0 0.5em;
	background: rgba(206, 205, 202, 0.5);
	border-radius: 3px;
	margin-right: 0.5em;
	margin-top: 0.3em;
	margin-bottom: 0.3em;
	white-space: nowrap;
}

.collection-title {
	display: inline-block;
	margin-right: 1em;
}

.page-description {
	margin-bottom: 2em;
}

.simple-table {
	margin-top: 1em;
	font-size: 0.875rem;
	empty-cells: show;
}
.simple-table td {
	height: 29px;
	min-width: 120px;
}

.simple-table th {
	height: 29px;
	min-width: 120px;
}

.simple-table-header-color {
	background: rgb(247, 246, 243);
	color: black;
}
.simple-table-header {
	font-weight: 500;
}

time {
	opacity: 0.5;
}

.icon {
	display: inline-block;
	max-width: 1.2em;
	max-height: 1.2em;
	text-decoration: none;
	vertical-align: text-bottom;
	margin-right: 0.5em;
}

img.icon {
	border-radius: 3px;
}

.user-icon {
	width: 1.5em;
	height: 1.5em;
	border-radius: 100%;
	margin-right: 0.5rem;
}

.user-icon-inner {
	font-size: 0.8em;
}

.text-icon {
	border: 1px solid #000;
	text-align: center;
}

.page-cover-image {
	display: block;
	object-fit: cover;
	width: 100%;
	max-height: 30vh;
}

.page-header-icon {
	font-size: 3rem;
	margin-bottom: 1rem;
}

.page-header-icon-with-cover {
	margin-top: -0.72em;
	margin-left: 0.07em;
}

.page-header-icon img {
	border-radius: 3px;
}

.link-to-page {
	margin: 1em 0;
	padding: 0;
	border: none;
	font-weight: 500;
}

p > .user {
	opacity: 0.5;
}

td > .user,
td > time {
	white-space: nowrap;
}

input[type="checkbox"] {
	transform: scale(1.5);
	margin-right: 0.6em;
	vertical-align: middle;
}

p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.image {
	border: none;
	margin: 1.5em 0;
	padding: 0;
	border-radius: 0;
	text-align: center;
}

.code,
code {
	background: rgba(135, 131, 120, 0.15);
	border-radius: 3px;
	padding: 0.2em 0.4em;
	border-radius: 3px;
	font-size: 85%;
	tab-size: 2;
}

code {
	color: #eb5757;
}

.code {
	padding: 1.5em 1em;
}

.code-wrap {
	white-space: pre-wrap;
	word-break: break-all;
}

.code > code {
	background: none;
	padding: 0;
	font-size: 100%;
	color: inherit;
}

blockquote {
	font-size: 1.25em;
	margin: 1em 0;
	padding-left: 1em;
	border-left: 3px solid rgb(55, 53, 47);
}

.bookmark {
	text-decoration: none;
	max-height: 8em;
	padding: 0;
	display: flex;
	width: 100%;
	align-items: stretch;
}

.bookmark-title {
	font-size: 0.85em;
	overflow: hidden;
	text-overflow: ellipsis;
	height: 1.75em;
	white-space: nowrap;
}

.bookmark-text {
	display: flex;
	flex-direction: column;
}

.bookmark-info {
	flex: 4 1 180px;
	padding: 12px 14px 14px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
}

.bookmark-image {
	width: 33%;
	flex: 1 1 180px;
	display: block;
	position: relative;
	object-fit: cover;
	border-radius: 1px;
}

.bookmark-description {
	color: rgba(55, 53, 47, 0.6);
	font-size: 0.75em;
	overflow: hidden;
	max-height: 4.5em;
	word-break: break-word;
}

.bookmark-href {
	font-size: 0.75em;
	margin-top: 0.25em;
}

.sans { font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
.code { font-family: "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; }
.serif { font-family: Lyon-Text, Georgia, ui-serif, serif; }
.mono { font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; }
.pdf .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK JP'; }
.pdf:lang(zh-CN) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC'; }
.pdf:lang(zh-TW) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK TC'; }
.pdf:lang(ko-KR) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK KR'; }
.pdf .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK JP'; }
.pdf:lang(zh-CN) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK SC'; }
.pdf:lang(zh-TW) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK TC'; }
.pdf:lang(ko-KR) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK KR'; }
.pdf .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.highlight-default {
	color: rgba(50, 48, 44, 1);
}
.highlight-gray {
	color: rgba(115, 114, 110, 1);
	fill: rgba(115, 114, 110, 1);
}
.highlight-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.highlight-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.highlight-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.highlight-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.highlight-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.highlight-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.highlight-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.highlight-red {
	color: rgba(205, 60, 58, 1);
	fill: rgba(205, 60, 58, 1);
}
.highlight-default_background {
	color: rgba(50, 48, 44, 1);
}
.highlight-gray_background {
	background: rgba(248, 248, 247, 1);
}
.highlight-brown_background {
	background: rgba(244, 238, 238, 1);
}
.highlight-orange_background {
	background: rgba(251, 236, 221, 1);
}
.highlight-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.highlight-teal_background {
	background: rgba(237, 243, 236, 1);
}
.highlight-blue_background {
	background: rgba(231, 243, 248, 1);
}
.highlight-purple_background {
	background: rgba(248, 243, 252, 1);
}
.highlight-pink_background {
	background: rgba(252, 241, 246, 1);
}
.highlight-red_background {
	background: rgba(253, 235, 236, 1);
}
.block-color-default {
	color: inherit;
	fill: inherit;
}
.block-color-gray {
	color: rgba(115, 114, 110, 1);
	fill: rgba(115, 114, 110, 1);
}
.block-color-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.block-color-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.block-color-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.block-color-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.block-color-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.block-color-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.block-color-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.block-color-red {
	color: rgba(205, 60, 58, 1);
	fill: rgba(205, 60, 58, 1);
}
.block-color-default_background {
	color: inherit;
	fill: inherit;
}
.block-color-gray_background {
	background: rgba(248, 248, 247, 1);
}
.block-color-brown_background {
	background: rgba(244, 238, 238, 1);
}
.block-color-orange_background {
	background: rgba(251, 236, 221, 1);
}
.block-color-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.block-color-teal_background {
	background: rgba(237, 243, 236, 1);
}
.block-color-blue_background {
	background: rgba(231, 243, 248, 1);
}
.block-color-purple_background {
	background: rgba(248, 243, 252, 1);
}
.block-color-pink_background {
	background: rgba(252, 241, 246, 1);
}
.block-color-red_background {
	background: rgba(253, 235, 236, 1);
}
.select-value-color-default { background-color: rgba(84, 72, 49, 0.08); }
.select-value-color-gray { background-color: rgba(84, 72, 49, 0.15); }
.select-value-color-brown { background-color: rgba(210, 162, 141, 0.35); }
.select-value-color-orange { background-color: rgba(224, 124, 57, 0.27); }
.select-value-color-yellow { background-color: rgba(236, 191, 66, 0.39); }
.select-value-color-green { background-color: rgba(123, 183, 129, 0.27); }
.select-value-color-blue { background-color: rgba(93, 165, 206, 0.27); }
.select-value-color-purple { background-color: rgba(168, 129, 197, 0.27); }
.select-value-color-pink { background-color: rgba(225, 136, 179, 0.27); }
.select-value-color-red { background-color: rgba(244, 171, 159, 0.4); }

.checkbox {
	display: inline-flex;
	vertical-align: text-bottom;
	width: 16;
	height: 16;
	background-size: 16px;
	margin-left: 2px;
	margin-right: 5px;
}

.checkbox-on {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
}

.checkbox-off {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
}
	
</style></head><body><article id="2355b2cc-075b-8049-890c-fded586ad5ba" class="page sans"><header><div class="page-header-icon undefined"><img class="icon" src="https://tryhackme-images.s3.amazonaws.com/room-icons/66704dd0e54a1f39bff7b1a1-1735575366699"/></div><h1 class="page-title">SIEM</h1><p class="page-description"></p></header><div class="page-body"><p id="2355b2cc-075b-80ce-bd98-cad26b00c7e3" class="">Visibility</p><figure id="2355b2cc-075b-8011-9721-d3bfd80d2fff" class="image"><a href="assets/image%2040.png"><img style="width:496.0291748046875px" src="assets/image%2040.png"/></a></figure><p id="2355b2cc-075b-8023-a0a6-e462c3266808" class="">As we know, each network component can have one or more log sources generating different logs. One example could be setting up¬†Sysmon¬†along with Windows Event logs to have better visibility of Windows Endpoint. We can divide our network log sources into two logical parts:</p><p id="2355b2cc-075b-8098-b27f-d5e913124746" class=""><strong>1) Host-Centric Log Sources</strong></p><p id="2355b2cc-075b-807b-99a6-f8ebabc0c206" class="">These are log sources that capture events that occurred within or related to the host. Some log sources that generate host-centric logs are Windows Event logs,¬†Sysmon, Osquery, etc. Some examples of host-centric logs are:</p><ul id="2355b2cc-075b-805b-a094-dd6059a18deb" class="bulleted-list"><li style="list-style-type:disc">A user accessing a file</li></ul><ul id="2355b2cc-075b-8080-bf6b-f830b3c3fb63" class="bulleted-list"><li style="list-style-type:disc">A user attempting to authenticate.</li></ul><ul id="2355b2cc-075b-80ef-9813-cec5c7852950" class="bulleted-list"><li style="list-style-type:disc">A process Execution Activity</li></ul><ul id="2355b2cc-075b-801c-bfdf-eee10716fa8c" class="bulleted-list"><li style="list-style-type:disc">A process adding/editing/deleting a registry key or value.</li></ul><ul id="2355b2cc-075b-80d9-b26f-e98c53fda588" class="bulleted-list"><li style="list-style-type:disc">Powershell¬†execution</li></ul><p id="2355b2cc-075b-80da-9d7a-d35d9eb7b95b" class=""><strong>2) Network-Centric Log Sources</strong></p><p id="2355b2cc-075b-80a5-a859-daa00f1a1e47" class="">Network-related logs are generated when the hosts communicate with each other or access the internet to visit a website. Some network-based protocols are¬†SSH,¬†VPN,¬†HTTP/s,¬†FTP, etc. Examples of such events are:</p><ul id="2355b2cc-075b-8039-be4c-f37878f53714" class="bulleted-list"><li style="list-style-type:disc">SSH¬†connection</li></ul><ul id="2355b2cc-075b-80d8-9881-df774a7013ba" class="bulleted-list"><li style="list-style-type:disc">A file being accessed via¬†FTP</li></ul><ul id="2355b2cc-075b-8023-8336-ee257dfb2735" class="bulleted-list"><li style="list-style-type:disc">Web traffic</li></ul><ul id="2355b2cc-075b-806a-bf9c-d37dbd67f6d2" class="bulleted-list"><li style="list-style-type:disc">A user accessing company&#x27;s resources through¬†VPN.</li></ul><ul id="2355b2cc-075b-80dd-b196-ef10558079a2" class="bulleted-list"><li style="list-style-type:disc">Network file sharing Activity</li></ul><h1 id="2355b2cc-075b-8057-91eb-f543d77e2b41" class="">Importance of¬†SIEM</h1><figure id="2355b2cc-075b-8065-806b-f43fce98de1a" class="image"><a href="https://tryhackme-images.s3.amazonaws.com/user-uploads/5e8dd9a4a45e18443162feab/room-content/63724f4da84dd3cfbaf2937790910e20.png"><img src="https://tryhackme-images.s3.amazonaws.com/user-uploads/5e8dd9a4a45e18443162feab/room-content/63724f4da84dd3cfbaf2937790910e20.png"/></a></figure><p id="2355b2cc-075b-80a1-89c6-d2e7b022c2f4" class="">Now that we have covered various types of logs, it&#x27;s time to understand the importance of¬†SIEM. As all these devices generate hundreds of events per second, examining the imglogs on each device one by one in case of any incident can be a tedious task. That is one of the advantages of having a¬†SIEM¬†solution in place. It not only takes logs from various sources in real-time but also provides the ability to correlate between events, search through the logs, investigate incidents and respond promptly. Some key features provided by¬†SIEM¬†are:</p><ul id="2355b2cc-075b-8052-83a4-f51c53ded70a" class="bulleted-list"><li style="list-style-type:disc">Real-time log Ingestion</li></ul><ul id="2355b2cc-075b-80ce-a281-f8224b0ca72c" class="bulleted-list"><li style="list-style-type:disc">Alerting against abnormal activities</li></ul><ul id="2355b2cc-075b-80fe-a082-e3faaf4a7252" class="bulleted-list"><li style="list-style-type:disc">24/7 Monitoring and visibility</li></ul><ul id="2355b2cc-075b-801e-944a-e7df12ac1e3b" class="bulleted-list"><li style="list-style-type:disc">Protection against the latest threats through early detection</li></ul><ul id="2355b2cc-075b-80bb-a920-fc291503bcf9" class="bulleted-list"><li style="list-style-type:disc">Data Insights and visualization</li></ul><ul id="2355b2cc-075b-8080-8f20-c150b68dfab7" class="bulleted-list"><li style="list-style-type:disc">Ability to investigate past incidents.</li></ul><p id="2355b2cc-075b-80b3-b234-ea2a28d7df1f" class="">
</p><h2 id="2355b2cc-075b-80e4-9f90-c5450e73e899" class="">Log Sources and Log Ingestion</h2><h3 id="2355b2cc-075b-803d-983b-d9d7ce790dd6" class="">Windows Machine</h3><p id="2355b2cc-075b-80ed-b451-f59b1e633347" class="">Windows records every event that can be viewed through the Event Viewer utility. It assigns a unique ID to each type of log activity, making it easy for the analyst to examine and keep track of. To view events in a Windows environment, type¬†<code>Event Viewer</code>¬†in the search bar, and it takes you to the tool where different logs are stored and can be viewed, as shown below. These logs from all windows endpoints are forwarded to the¬†SIEM¬†solution for monitoring and better visibility.</p><figure id="2355b2cc-075b-807e-938f-d2034ccc39e2" class="image"><a href="https://tryhackme-images.s3.amazonaws.com/user-uploads/5e8dd9a4a45e18443162feab/room-content/30beed26fc514cb7f52773b88a4510b9.gif"><img style="width:700px" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/5e8dd9a4a45e18443162feab/room-content/30beed26fc514cb7f52773b88a4510b9.gif"/></a></figure><h3 id="2355b2cc-075b-80b8-b86f-fd9587c307bb" class="">Linux¬†Workstation</h3><p id="2355b2cc-075b-8078-881e-c7d2844d523f" class="">Linux¬†OS¬†stores all the related logs, such as events, errors, warnings, etc. Which are then ingested into¬†SIEM¬†for continuous monitoring. Some of the common locations where¬†Linux¬†store logs are:</p><blockquote id="2355b2cc-075b-80b0-a0ec-d9098201e68f" class="">/var/log/httpd¬†: Contains¬†HTTP¬†Request / Response and error logs.</blockquote><blockquote id="2355b2cc-075b-80d0-b168-e7ebfe312b11" class="">/var/log/cron : Events related to cron jobs are stored in this location.</blockquote><blockquote id="2355b2cc-075b-8021-b386-ff7e126737bb" class="">/var/log/auth.log and /var/log/secure¬†: Stores authentication related logs.</blockquote><blockquote id="2355b2cc-075b-80f8-8fbc-fa362e1478b2" class="">/var/log/kern¬†: This file stores kernel related events.</blockquote><p id="2355b2cc-075b-8050-9af2-ce6baf2d98fc" class="">Here is a sample of a cron log:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2355b2cc-075b-807e-b6c8-e3617e16f7a3" class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">May 28 13:04:20 ebr crond[2843]: /usr/sbin/crond 4.4 dillon&#x27;s cron daemon, started with loglevel notice
May 28 13:04:20 ebr crond[2843]: no timestamp found (user root job sys-hourly)
May 28 13:04:20 ebr crond[2843]: no timestamp found (user root job sys-daily)
May 28 13:04:20 ebr crond[2843]: no timestamp found (user root job sys-weekly)
May 28 13:04:20 ebr crond[2843]: no timestamp found (user root job sys-monthly)
Jun 13 07:46:22 ebr crond[3592]: unable to exec /usr/sbin/sendmail: cron output for user root job sys-daily to /dev/null</code></pre><hr id="2355b2cc-075b-805a-bed8-f18268b6e262"/><h3 id="2355b2cc-075b-8055-abd2-cae28f38e1a5" class="">Web Server</h3><p id="2355b2cc-075b-80b2-bfbd-d7e3af15f881" class="">It is important to keep an eye on all the requests/responses coming in and out of the webserver for any potential web attack attempt. In¬†Linux, common locations to write all¬†apache¬†related logs are¬†/var/log/apache¬†or¬†/var/log/httpd.</p><p id="2355b2cc-075b-80e6-a9ff-eeec9136ddf7" class="">Here is an example of¬†Apache¬†Logs:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2355b2cc-075b-80f2-9f8a-e5b52eac11f0" class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">192.168.21.200 - - [21/March/2022:10:17:10 -0300] &quot;GET /cgi-bin/try/HTTP/1.0&quot; 200 3395
127.0.0.1 - - [21/March/2022:10:22:04 -0300] &quot;GET /HTTP/1.0&quot; 200 2216</code></pre><hr id="2355b2cc-075b-804f-8773-f6f61f075a2c"/><h3 id="2355b2cc-075b-80af-ba5c-cc6c7e00f417" class="">Log Ingestion</h3><figure id="2355b2cc-075b-806b-8e4c-d2f3b4a46309" class="image"><a href="https://tryhackme-images.s3.amazonaws.com/user-uploads/5e8dd9a4a45e18443162feab/room-content/593abd2bfd9fb31329bd1a6a80bf5ee0.png"><img src="https://tryhackme-images.s3.amazonaws.com/user-uploads/5e8dd9a4a45e18443162feab/room-content/593abd2bfd9fb31329bd1a6a80bf5ee0.png"/></a></figure><p id="2355b2cc-075b-80c4-8ae9-d8943a2572cb" class="">All these logs provide a wealth of information and can help in identifying security issues. Each¬†SIEM¬†solution has its own way of ingesting the logs. Some common methods used by these¬†SIEM¬†solutions are explained below:</p><p id="2355b2cc-075b-80b4-9759-de8a8695981c" class="">1) Agent / Forwarder:¬†These¬†SIEM¬†solutions provide a lightweight tool called an agent (forwarder by¬†Splunk) that gets installed in the Endpoint. It is configured to capture all the important logs and send them to the¬†SIEM¬†server.</p><p id="2355b2cc-075b-80cd-8a18-d93937c1d9ba" class="">2) Syslog:¬†Syslog is a widely used protocol to collect data from various systems like web servers, databases, etc., are sent real-time data to the centralized destination.</p><p id="2355b2cc-075b-80f4-8cbb-edefd7761af7" class="">3) Manual Upload:¬†Some¬†SIEM¬†solutions, like¬†Splunk,¬†ELK, etc., allow users to ingest offline data for quick analysis. Once the data is ingested, it is normalized and made available for analysis.</p><p id="2355b2cc-075b-80cb-b930-e951e2b6dc17" class="">4) Port-Forwarding:¬†SIEM¬†solutions can also be configured to listen on a certain port, and then the endpoints forward the data to the¬†SIEM¬†instance on the listening port.</p><p id="2355b2cc-075b-8019-ab9a-fb44b74b172a" class="">An example of how¬†Splunk¬†provides various methods for log Ingestion is shown below:</p><figure id="2355b2cc-075b-8041-86be-c9f70f692bc0" class="image"><a href="https://tryhackme-images.s3.amazonaws.com/user-uploads/5e8dd9a4a45e18443162feab/room-content/82d3a3a56537be4635c58cc10caee050.png"><img style="width:700px" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/5e8dd9a4a45e18443162feab/room-content/82d3a3a56537be4635c58cc10caee050.png"/></a></figure><p id="2355b2cc-075b-80ba-b292-fcd4462deab6" class="">
</p><h2 id="2355b2cc-075b-8045-acd8-f1842912b8ae" class="">SIEM¬†Capabilities</h2><p id="2355b2cc-075b-8031-bf6d-db242928caec" class="">SIEM¬†is one major component of a Security Operations Center (SOC) ecosystem, as illustrated below.¬†SIEM¬†starts by collecting logs and examining if any event/flow has matched the condition set in the rule or crossed a certain threshold</p><p id="2355b2cc-075b-8048-a7e8-f3d6d362d2a1" class="">Some of the common capabilities of¬†SIEM¬†are:</p><ul id="2355b2cc-075b-8036-aec8-f7da9a484f0e" class="bulleted-list"><li style="list-style-type:disc">Correlation between events from different log sources.</li></ul><ul id="2355b2cc-075b-803e-b65e-eaea95c5ebff" class="bulleted-list"><li style="list-style-type:disc">Provide visibility on both Host-centric and Network-centric activities.</li></ul><ul id="2355b2cc-075b-806b-85fa-d1d2ebd32b39" class="bulleted-list"><li style="list-style-type:disc">Allow analysts to investigate the latest threats and timely responses.</li></ul><ul id="2355b2cc-075b-8003-b752-f11216e46c22" class="bulleted-list"><li style="list-style-type:disc">Hunt for threats that are not detected by the rules in place.</li></ul><figure id="2355b2cc-075b-80f8-b35f-cc18a4d50ab8" class="image"><a href="assets/image%2041.png"><img style="width:685.986328125px" src="assets/image%2041.png"/></a></figure><p id="2355b2cc-075b-8044-98f1-f7c93aa27d4b" class="">
</p><figure id="1945b2cc-075b-80b7-a58f-caeebfd47910" class="link-to-page"><a href="ELK%20THM%20Labs%201945b2cc075b80b7a58fcaeebfd47910.html"><span class="icon">üå°Ô∏è</span>ELK THM Labs</a></figure><figure id="2355b2cc-075b-806b-a77b-ec8288967110" class="link-to-page"><a href="Splunk%202355b2cc075b806ba77bec8288967110.html"><img class="icon" src="https://tryhackme-images.s3.amazonaws.com/room-icons/2cc38529b8c7c0fa0207c71dcb8f990c.png"/>Splunk</a></figure><figure id="2355b2cc-075b-8081-b6f0-d5f17d6aa141" class="link-to-page"><a href="Splunk%20Incident%20Handling%202355b2cc075b8081b6f0d5f17d6aa141.html"><img class="icon" src="https://tryhackme-images.s3.amazonaws.com/room-icons/82e133a20e4c9d556cf0eebcaf5ca500.png"/>Splunk Incident Handling</a></figure><figure id="2365b2cc-075b-8040-aee3-deeea13aca2d" class="link-to-page"><a href="Splunk%20Challenge%202365b2cc075b8040aee3deeea13aca2d.html"><img class="icon" src="https://tryhackme-images.s3.amazonaws.com/room-icons/4877188bdb864e7b204ed849c95320ac.png"/>Splunk Challenge</a></figure><figure id="2365b2cc-075b-8050-a9d0-c9429f18b5c6" class="link-to-page"><a href="Benign%202365b2cc075b8050a9d0c9429f18b5c6.html"><img class="icon" src="https://tryhackme-images.s3.amazonaws.com/room-icons/43027f83fddeab1e7b9d5642fc876390.png"/>Benign</a></figure></div></article><span class="sans" style="font-size:14px;padding-top:2em"></span></body></html>