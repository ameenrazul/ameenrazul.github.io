<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>Boogeyman 2</title><style>
/* cspell:disable-file */
/* webkit printing magic: print all background colors */
html {
	-webkit-print-color-adjust: exact;
}
* {
	box-sizing: border-box;
	-webkit-print-color-adjust: exact;
}

html,
body {
	margin: 0;
	padding: 0;
}
@media only screen {
	body {
		margin: 2em auto;
		max-width: 900px;
		color: rgb(55, 53, 47);
	}
}

body {
	line-height: 1.5;
	white-space: pre-wrap;
}

a,
a.visited {
	color: inherit;
	text-decoration: underline;
}

.pdf-relative-link-path {
	font-size: 80%;
	color: #444;
}

h1,
h2,
h3 {
	letter-spacing: -0.01em;
	line-height: 1.2;
	font-weight: 600;
	margin-bottom: 0;
}

.page-title {
	font-size: 2.5rem;
	font-weight: 700;
	margin-top: 0;
	margin-bottom: 0.75em;
}

h1 {
	font-size: 1.875rem;
	margin-top: 1.875rem;
}

h2 {
	font-size: 1.5rem;
	margin-top: 1.5rem;
}

h3 {
	font-size: 1.25rem;
	margin-top: 1.25rem;
}

.source {
	border: 1px solid #ddd;
	border-radius: 3px;
	padding: 1.5em;
	word-break: break-all;
}

.callout {
	border-radius: 3px;
	padding: 1rem;
}

figure {
	margin: 1.25em 0;
	page-break-inside: avoid;
}

figcaption {
	opacity: 0.5;
	font-size: 85%;
	margin-top: 0.5em;
}

mark {
	background-color: transparent;
}

.indented {
	padding-left: 1.5em;
}

hr {
	background: transparent;
	display: block;
	width: 100%;
	height: 1px;
	visibility: visible;
	border: none;
	border-bottom: 1px solid rgba(55, 53, 47, 0.09);
}

img {
	max-width: 100%;
}

@media only print {
	img {
		max-height: 100vh;
		object-fit: contain;
	}
}

@page {
	margin: 1in;
}

.collection-content {
	font-size: 0.875rem;
}

.column-list {
	display: flex;
	justify-content: space-between;
}

.column {
	padding: 0 1em;
}

.column:first-child {
	padding-left: 0;
}

.column:last-child {
	padding-right: 0;
}

.table_of_contents-item {
	display: block;
	font-size: 0.875rem;
	line-height: 1.3;
	padding: 0.125rem;
}

.table_of_contents-indent-1 {
	margin-left: 1.5rem;
}

.table_of_contents-indent-2 {
	margin-left: 3rem;
}

.table_of_contents-indent-3 {
	margin-left: 4.5rem;
}

.table_of_contents-link {
	text-decoration: none;
	opacity: 0.7;
	border-bottom: 1px solid rgba(55, 53, 47, 0.18);
}

table,
th,
td {
	border: 1px solid rgba(55, 53, 47, 0.09);
	border-collapse: collapse;
}

table {
	border-left: none;
	border-right: none;
}

th,
td {
	font-weight: normal;
	padding: 0.25em 0.5em;
	line-height: 1.5;
	min-height: 1.5em;
	text-align: left;
}

th {
	color: rgba(55, 53, 47, 0.6);
}

ol,
ul {
	margin: 0;
	margin-block-start: 0.6em;
	margin-block-end: 0.6em;
}

li > ol:first-child,
li > ul:first-child {
	margin-block-start: 0.6em;
}

ul > li {
	list-style: disc;
}

ul.to-do-list {
	padding-inline-start: 0;
}

ul.to-do-list > li {
	list-style: none;
}

.to-do-children-checked {
	text-decoration: line-through;
	opacity: 0.375;
}

ul.toggle > li {
	list-style: none;
}

ul {
	padding-inline-start: 1.7em;
}

ul > li {
	padding-left: 0.1em;
}

ol {
	padding-inline-start: 1.6em;
}

ol > li {
	padding-left: 0.2em;
}

.mono ol {
	padding-inline-start: 2em;
}

.mono ol > li {
	text-indent: -0.4em;
}

.toggle {
	padding-inline-start: 0em;
	list-style-type: none;
}

/* Indent toggle children */
.toggle > li > details {
	padding-left: 1.7em;
}

.toggle > li > details > summary {
	margin-left: -1.1em;
}

.selected-value {
	display: inline-block;
	padding: 0 0.5em;
	background: rgba(206, 205, 202, 0.5);
	border-radius: 3px;
	margin-right: 0.5em;
	margin-top: 0.3em;
	margin-bottom: 0.3em;
	white-space: nowrap;
}

.collection-title {
	display: inline-block;
	margin-right: 1em;
}

.page-description {
	margin-bottom: 2em;
}

.simple-table {
	margin-top: 1em;
	font-size: 0.875rem;
	empty-cells: show;
}
.simple-table td {
	height: 29px;
	min-width: 120px;
}

.simple-table th {
	height: 29px;
	min-width: 120px;
}

.simple-table-header-color {
	background: rgb(247, 246, 243);
	color: black;
}
.simple-table-header {
	font-weight: 500;
}

time {
	opacity: 0.5;
}

.icon {
	display: inline-block;
	max-width: 1.2em;
	max-height: 1.2em;
	text-decoration: none;
	vertical-align: text-bottom;
	margin-right: 0.5em;
}

img.icon {
	border-radius: 3px;
}

.user-icon {
	width: 1.5em;
	height: 1.5em;
	border-radius: 100%;
	margin-right: 0.5rem;
}

.user-icon-inner {
	font-size: 0.8em;
}

.text-icon {
	border: 1px solid #000;
	text-align: center;
}

.page-cover-image {
	display: block;
	object-fit: cover;
	width: 100%;
	max-height: 30vh;
}

.page-header-icon {
	font-size: 3rem;
	margin-bottom: 1rem;
}

.page-header-icon-with-cover {
	margin-top: -0.72em;
	margin-left: 0.07em;
}

.page-header-icon img {
	border-radius: 3px;
}

.link-to-page {
	margin: 1em 0;
	padding: 0;
	border: none;
	font-weight: 500;
}

p > .user {
	opacity: 0.5;
}

td > .user,
td > time {
	white-space: nowrap;
}

input[type="checkbox"] {
	transform: scale(1.5);
	margin-right: 0.6em;
	vertical-align: middle;
}

p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.image {
	border: none;
	margin: 1.5em 0;
	padding: 0;
	border-radius: 0;
	text-align: center;
}

.code,
code {
	background: rgba(135, 131, 120, 0.15);
	border-radius: 3px;
	padding: 0.2em 0.4em;
	border-radius: 3px;
	font-size: 85%;
	tab-size: 2;
}

code {
	color: #eb5757;
}

.code {
	padding: 1.5em 1em;
}

.code-wrap {
	white-space: pre-wrap;
	word-break: break-all;
}

.code > code {
	background: none;
	padding: 0;
	font-size: 100%;
	color: inherit;
}

blockquote {
	font-size: 1.25em;
	margin: 1em 0;
	padding-left: 1em;
	border-left: 3px solid rgb(55, 53, 47);
}

.bookmark {
	text-decoration: none;
	max-height: 8em;
	padding: 0;
	display: flex;
	width: 100%;
	align-items: stretch;
}

.bookmark-title {
	font-size: 0.85em;
	overflow: hidden;
	text-overflow: ellipsis;
	height: 1.75em;
	white-space: nowrap;
}

.bookmark-text {
	display: flex;
	flex-direction: column;
}

.bookmark-info {
	flex: 4 1 180px;
	padding: 12px 14px 14px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
}

.bookmark-image {
	width: 33%;
	flex: 1 1 180px;
	display: block;
	position: relative;
	object-fit: cover;
	border-radius: 1px;
}

.bookmark-description {
	color: rgba(55, 53, 47, 0.6);
	font-size: 0.75em;
	overflow: hidden;
	max-height: 4.5em;
	word-break: break-word;
}

.bookmark-href {
	font-size: 0.75em;
	margin-top: 0.25em;
}

.sans { font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
.code { font-family: "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; }
.serif { font-family: Lyon-Text, Georgia, ui-serif, serif; }
.mono { font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; }
.pdf .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK JP'; }
.pdf:lang(zh-CN) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC'; }
.pdf:lang(zh-TW) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK TC'; }
.pdf:lang(ko-KR) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK KR'; }
.pdf .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK JP'; }
.pdf:lang(zh-CN) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK SC'; }
.pdf:lang(zh-TW) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK TC'; }
.pdf:lang(ko-KR) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK KR'; }
.pdf .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.highlight-default {
	color: rgba(50, 48, 44, 1);
}
.highlight-gray {
	color: rgba(115, 114, 110, 1);
	fill: rgba(115, 114, 110, 1);
}
.highlight-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.highlight-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.highlight-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.highlight-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.highlight-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.highlight-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.highlight-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.highlight-red {
	color: rgba(205, 60, 58, 1);
	fill: rgba(205, 60, 58, 1);
}
.highlight-default_background {
	color: rgba(50, 48, 44, 1);
}
.highlight-gray_background {
	background: rgba(248, 248, 247, 1);
}
.highlight-brown_background {
	background: rgba(244, 238, 238, 1);
}
.highlight-orange_background {
	background: rgba(251, 236, 221, 1);
}
.highlight-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.highlight-teal_background {
	background: rgba(237, 243, 236, 1);
}
.highlight-blue_background {
	background: rgba(231, 243, 248, 1);
}
.highlight-purple_background {
	background: rgba(248, 243, 252, 1);
}
.highlight-pink_background {
	background: rgba(252, 241, 246, 1);
}
.highlight-red_background {
	background: rgba(253, 235, 236, 1);
}
.block-color-default {
	color: inherit;
	fill: inherit;
}
.block-color-gray {
	color: rgba(115, 114, 110, 1);
	fill: rgba(115, 114, 110, 1);
}
.block-color-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.block-color-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.block-color-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.block-color-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.block-color-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.block-color-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.block-color-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.block-color-red {
	color: rgba(205, 60, 58, 1);
	fill: rgba(205, 60, 58, 1);
}
.block-color-default_background {
	color: inherit;
	fill: inherit;
}
.block-color-gray_background {
	background: rgba(248, 248, 247, 1);
}
.block-color-brown_background {
	background: rgba(244, 238, 238, 1);
}
.block-color-orange_background {
	background: rgba(251, 236, 221, 1);
}
.block-color-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.block-color-teal_background {
	background: rgba(237, 243, 236, 1);
}
.block-color-blue_background {
	background: rgba(231, 243, 248, 1);
}
.block-color-purple_background {
	background: rgba(248, 243, 252, 1);
}
.block-color-pink_background {
	background: rgba(252, 241, 246, 1);
}
.block-color-red_background {
	background: rgba(253, 235, 236, 1);
}
.select-value-color-default { background-color: rgba(84, 72, 49, 0.08); }
.select-value-color-gray { background-color: rgba(84, 72, 49, 0.15); }
.select-value-color-brown { background-color: rgba(210, 162, 141, 0.35); }
.select-value-color-orange { background-color: rgba(224, 124, 57, 0.27); }
.select-value-color-yellow { background-color: rgba(236, 191, 66, 0.39); }
.select-value-color-green { background-color: rgba(123, 183, 129, 0.27); }
.select-value-color-blue { background-color: rgba(93, 165, 206, 0.27); }
.select-value-color-purple { background-color: rgba(168, 129, 197, 0.27); }
.select-value-color-pink { background-color: rgba(225, 136, 179, 0.27); }
.select-value-color-red { background-color: rgba(244, 171, 159, 0.4); }

.checkbox {
	display: inline-flex;
	vertical-align: text-bottom;
	width: 16;
	height: 16;
	background-size: 16px;
	margin-left: 2px;
	margin-right: 5px;
}

.checkbox-on {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
}

.checkbox-off {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
}
	
</style></head><body><article id="24a5b2cc-075b-80f5-91ed-e972fc247692" class="page sans"><header><img class="page-cover-image" src="E16668CD-740C-4250-BEF7-1C99886C183F.png" style="object-position:center 50%"/><div class="page-header-icon page-header-icon-with-cover"><img class="icon" src="https://tryhackme-images.s3.amazonaws.com/room-icons/2fb0a9b7f813718a338cbc765071c7e7.png"/></div><h1 class="page-title"><strong>Boogeyman 2</strong></h1><p class="page-description"></p></header><div class="page-body"><h1 id="24a5b2cc-075b-8084-98f3-c4ecd351db44" class="">Artefacts</h1><p id="24a5b2cc-075b-8092-89b0-f9505be238b5" class="">For the investigation, you will be provided with the following artefacts:</p><ul id="24a5b2cc-075b-80f2-8e98-e8a6b134b099" class="bulleted-list"><li style="list-style-type:disc">Copy of the phishing email.</li></ul><ul id="24a5b2cc-075b-80e3-b803-c066608a5fb2" class="bulleted-list"><li style="list-style-type:disc">Memory dump of the victim&#x27;s workstation.</li></ul><p id="24a5b2cc-075b-80d2-b2ed-e5bb159aee22" class="">You may find these files in the /home/ubuntu/Desktop/Artefacts directory.</p><h1 id="24a5b2cc-075b-800a-aca0-f13659c9b9c0" class="">Tools</h1><p id="24a5b2cc-075b-8032-b32f-e221958d136e" class="">The provided VM contains the following tools at your disposal:</p><ul id="24a5b2cc-075b-80f6-a497-c913588e1b52" class="bulleted-list"><li style="list-style-type:disc">Volatility - an <a href="https://github.com/volatilityfoundation/volatility3">open-source framework</a> for extracting digital artefacts from volatile memory (RAM) samples.<p id="24a5b2cc-075b-8055-854e-f7cf8c9afd9a" class="">ubuntu@tryhackme:~</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="24a5b2cc-075b-807b-8b8a-c0fe8295c2e9" class="code code-wrap"><code class="language-Shell" style="white-space:pre-wrap;word-break:break-all">ubuntu@tryhackme$ # Volatility usage:ubuntu@tryhackme$ vol -f memorydump.raw &lt;plugin&gt;# To list all available pluginsubuntu@tryhackme$ vol -f memorydump.raw -h</code></pre><p id="24a5b2cc-075b-805e-9e74-e0d744221516" class="">
</p></li></ul><ul id="24a5b2cc-075b-804d-85bb-d5aae50688d9" class="bulleted-list"><li style="list-style-type:disc">Olevba - a tool for analysing and extracting VBA macros from Microsoft Office documents. This tool is also a part of the <a href="https://github.com/decalage2/oletools">Oletools suite</a>.<p id="24a5b2cc-075b-80ee-a46f-cdb525f5762e" class="">ubuntu@tryhackme:~</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="24a5b2cc-075b-8079-a522-e08d022a07cf" class="code code-wrap"><code class="language-Shell" style="white-space:pre-wrap;word-break:break-all">ubuntu@tryhackme$ # Olevba usage:ubuntu@tryhackme$ olevba document.doc</code></pre></li></ul><p id="24a5b2cc-075b-807d-b318-e32052f11975" class="">
</p><h2 id="24a5b2cc-075b-8022-8e80-eee415a9bf93" class="">Spear Phishing Human Resources</h2><p id="24a5b2cc-075b-8073-8139-f38544746a28" class="">
</p><p id="24a5b2cc-075b-80e1-a2f8-ce79df1ff7aa" class="">Maxine, a Human Resource Specialist working for Quick Logistics LLC, received an application from one of the open positions in the company. Unbeknownst to her, the attached resume was malicious and compromised her workstation.</p><figure id="24a5b2cc-075b-80f1-9629-e5b0a514c267" class="image"><a href="https://tryhackme-images.s3.amazonaws.com/user-uploads/5dbea226085ab6182a2ee0f7/room-content/3179f87c7b1815007fe33e6b8e14de6e.png"><img src="https://tryhackme-images.s3.amazonaws.com/user-uploads/5dbea226085ab6182a2ee0f7/room-content/3179f87c7b1815007fe33e6b8e14de6e.png"/></a></figure><p id="24a5b2cc-075b-8001-870d-d151028b71ef" class="">The security team was able to flag some suspicious commands executed on the workstation of Maxine, which prompted the investigation. Given this, you are tasked to analyse and assess the impact of the compromise.</p><p id="24a5b2cc-075b-805c-b512-de082c2879ea" class=""><a href="https://tools.sendmarc.com/header-analysis">https://tools.sendmarc.com/header-analysis</a></p><ul id="24a5b2cc-075b-8098-9326-c6900a0b83d4" class="bulleted-list"><li style="list-style-type:disc">What email was used to send the phishing email?<br/></li></ul><figure id="24a5b2cc-075b-8026-95d7-f2c00a80fc0e" class="image"><a href="3F17F168-21AE-4BDB-8104-C0574D9BD07D.png"><img style="width:568px" src="3F17F168-21AE-4BDB-8104-C0574D9BD07D.png"/></a></figure><ul id="24a5b2cc-075b-8085-9c4c-df96a0228c66" class="bulleted-list"><li style="list-style-type:disc">What is the email of the victim employee?</li></ul><figure id="24a5b2cc-075b-8014-95c7-d8fb901d2885" class="image"><a href="85217040-176C-405B-A05B-2B2C5AC3FFAB.png"><img style="width:624px" src="85217040-176C-405B-A05B-2B2C5AC3FFAB.png"/></a></figure><ul id="24a5b2cc-075b-80d3-bcfc-c824617ae271" class="bulleted-list"><li style="list-style-type:disc">What is the name of the attached malicious document?</li></ul><figure id="24a5b2cc-075b-80d1-ba7a-eb201b772a63" class="image"><a href="DCAC1C89-5557-4E14-98CF-557B17BC3D25.png"><img style="width:675px" src="DCAC1C89-5557-4E14-98CF-557B17BC3D25.png"/></a></figure><ul id="24a5b2cc-075b-805a-91b3-da28b8be96f5" class="bulleted-list"><li style="list-style-type:disc">What is the MD5 hash of the malicious attachment?<br/><br/>i saved the attachment to local and used md5sum to get the hash<br/></li></ul><figure id="24a5b2cc-075b-803c-afe9-f8a41d7d3368" class="image"><a href="5671CD4F-4BC3-4744-9F2E-79B76B39C21B.png"><img style="width:710px" src="5671CD4F-4BC3-4744-9F2E-79B76B39C21B.png"/></a></figure><ul id="24a5b2cc-075b-8024-9e53-cd9b62670c91" class="bulleted-list"><li style="list-style-type:disc">What URL is used to download the stage 2 payload based on the document&#x27;s macro?<br/></li></ul><p id="24a5b2cc-075b-801c-a0c7-e322f3336c36" class="">I ran olevba with the attachment doc, it’s a typical VBA dropper embedded in a Word document, designed to run automatically on open and download a second-stage payload.</p><p id="24a5b2cc-075b-8060-a32f-c07bc79ee8ee" class="">File is downloaded to the hidden <code><strong>C:\ProgramData\</strong></code><strong> </strong><br/>Uses <code>Microsoft.XMLHTTP</code> to send an HTTP GET request to the URL as seen in the screenshot, even though it says update.png, its most likely not, as its saved as a js file. </p><p id="24a5b2cc-075b-80dd-8c69-ed88005b1da3" class="">Its then run <code>CreateObject(&quot;WScript.Shell&quot;).Exec(&quot;wscript.exe C:\ProgramData\update.js&quot;)</code><br/>This launches the downloaded JavaScript with <strong>Windows Script Host</strong>, giving it full execution privileges.<br/></p><figure id="24a5b2cc-075b-80ef-8df7-f82f5c435099" class="image"><a href="25264DBF-2B01-4F2D-81F2-4308C7440C33.png"><img style="width:710px" src="25264DBF-2B01-4F2D-81F2-4308C7440C33.png"/></a></figure><ul id="24a5b2cc-075b-808a-9227-e138d32e8ff7" class="bulleted-list"><li style="list-style-type:disc">What is the name of the process that executed the newly downloaded stage 2 payload?<br/><br/>I ran volatility on the provided .raw file with windows.pslist</li></ul><figure id="24a5b2cc-075b-806e-a8fa-d6515a0e4d3c" class="image"><a href="C7B9599E-0745-4780-8335-64EB3974A72B.png"><img style="width:710px" src="C7B9599E-0745-4780-8335-64EB3974A72B.png"/></a></figure><figure id="24a5b2cc-075b-8063-a3dd-ce22f1b8951a" class="image"><a href="51A9B52C-A820-4B17-B309-792A4B6AA81F.png"><img style="width:710px" src="51A9B52C-A820-4B17-B309-792A4B6AA81F.png"/></a></figure><ul id="24a5b2cc-075b-802d-8f60-cd203a139277" class="bulleted-list"><li style="list-style-type:disc">What is the full file path of the malicious stage 2 payload?<br/><br/>We know this from examining the script<br/><code>C:\ProgramData\update.js</code><br/></li></ul><ul id="24a5b2cc-075b-8078-98a1-c224cb8f3562" class="bulleted-list"><li style="list-style-type:disc">What is the PID of the process that executed the stage 2 payload?<br/><br/>From the pstree output we can see that wscript was launched under winword.exe </li></ul><figure id="24a5b2cc-075b-809a-b1c3-f756ebd2878e" class="image"><a href="426C403D-D26B-4DE0-B5F7-FCD09A37F922.png"><img style="width:709.9833374023438px" src="426C403D-D26B-4DE0-B5F7-FCD09A37F922.png"/></a></figure><p id="24a5b2cc-075b-8025-a136-f79dbf184c35" class="">
</p><ul id="24a5b2cc-075b-80b4-bce3-f03884304d75" class="bulleted-list"><li style="list-style-type:disc">What is the parent PID of the process that executed the stage 2 payload?<br/><br/>PPID of wscript is 1124 as seen in the previous screenshot<br/><br/></li></ul><ul id="24a5b2cc-075b-803d-b7c1-c80d1e100fd1" class="bulleted-list"><li style="list-style-type:disc">What URL is used to download the malicious binary executed by the stage 2 payload?<br/><br/>since I saw an update.exe running in the pstree, I believe that could have been downloaded from running the js, So i used strings to look for urls with the same domain as the initial payload.<br/><code>strings WKSTN-2961.raw | grep boogeymanisback</code></li></ul><figure id="24a5b2cc-075b-8031-9290-e9e9c83ce6d4" class="image"><a href="image%20318.png"><img style="width:710px" src="image%20318.png"/></a></figure><p id="24a5b2cc-075b-8080-b498-c20cbd31744c" class="">
</p><ul id="24a5b2cc-075b-8041-a18c-c086f89964c0" class="bulleted-list"><li style="list-style-type:disc">What is the PID of the malicious process used to establish the C2 connection?<br/><br/>we can use the netscan plugin in volatility to see network connections from services<br/>updater.exe was used to establish the c2 connection as it launches a conhost.exe, so the PID is 6216<br/></li></ul><figure id="24a5b2cc-075b-80a7-a849-d9e628744f77" class="image"><a href="A03E6AE4-494B-4305-B33C-EC4EB2D20FE8.png"><img style="width:710px" src="A03E6AE4-494B-4305-B33C-EC4EB2D20FE8.png"/></a></figure><ul id="24a5b2cc-075b-805a-9974-dabe59ea8be2" class="bulleted-list"><li style="list-style-type:disc">What is the full file path of the malicious process used to establish the C2 connection?<br/><br/>I used the windows.dlllist to get the list of dlls used by the PID 6216</li></ul><figure id="24a5b2cc-075b-80c0-a4a7-f89e1d3ec803" class="image"><a href="AB386967-1F6A-4373-B80C-F381B1F9495C.png"><img style="width:710px" src="AB386967-1F6A-4373-B80C-F381B1F9495C.png"/></a></figure><p id="24a5b2cc-075b-807c-b61e-e873dbab97c4" class="">
</p><ul id="24a5b2cc-075b-80d7-9b5c-c63d4df439ae" class="bulleted-list"><li style="list-style-type:disc">What is the IP address and port of the C2 connection initiated by the malicious binary? (Format: IP address:port)<br/><br/>from running windows.netscan against the raw file, we can see that updater.exe has been listening to this external ip on port 8080</li></ul><figure id="24a5b2cc-075b-8028-b3ba-eef25ecd59ba" class="image"><a href="686119B5-8290-4CE7-BCA6-643E13ACCE22.png"><img style="width:710px" src="686119B5-8290-4CE7-BCA6-643E13ACCE22.png"/></a></figure><p id="24a5b2cc-075b-8002-988e-c8b6baf7e6c2" class="">
</p><ul id="24a5b2cc-075b-80a3-bf11-cb4dd5a31495" class="bulleted-list"><li style="list-style-type:disc">What is the full file path of the malicious email attachment based on the memory dump?<br/><br/>I used the windows.filescan module to run trough the dump to get list of files, I saved the output to a file and then used cat and grep to look for the document name since we already know its name</li></ul><figure id="24a5b2cc-075b-80cd-8ef6-c7aeaa6b6ffa" class="image"><a href="15532D89-F902-48F0-890F-719C9DB1588E.png"><img style="width:709.9500122070312px" src="15532D89-F902-48F0-890F-719C9DB1588E.png"/></a></figure><p id="24a5b2cc-075b-80ba-9ecb-d0173639479f" class="">
</p><ul id="24a5b2cc-075b-801a-8084-dc699d1cf5f3" class="bulleted-list"><li style="list-style-type:disc">The attacker implanted a scheduled task right after establishing the c2 callback. What is the full command used by the attacker to maintain persistent access?<br/><br/>I tried to run windows.cmdline but I couldnt figure out anything from there, so i decided to Dump the memory dump of the malicious process 6216, <br/><code>sudo vol -f WKSTN-2961.raw windows.memmap --dump --pid 6216</code></li></ul><p id="24a5b2cc-075b-8060-bd42-f9064c12486a" class="">      Then once its saved to a dmp file, i used strings to look for schtasks execution, then i found t but iot doesnt seem like the full command</p><figure id="24a5b2cc-075b-8076-b255-e3dfbc2c9978" class="image"><a href="3579A0AD-ED36-4B57-8518-F17280E37F21.png"><img style="width:709.8333129882812px" src="3579A0AD-ED36-4B57-8518-F17280E37F21.png"/></a></figure><p id="24a5b2cc-075b-80c3-9a25-dacaa4ec6eac" class="">Then i ran the grep search against the whole dump and found it</p><figure id="24a5b2cc-075b-80df-b214-c3ee37bf8c9f" class="image"><a href="F4BF42FA-774A-499E-BBF8-5443AA1FD84A.png"><img style="width:2187px" src="F4BF42FA-774A-499E-BBF8-5443AA1FD84A.png"/></a></figure><p id="24a5b2cc-075b-80f6-bea7-d389a84e63fb" class="">
</p></div></article><span class="sans" style="font-size:14px;padding-top:2em"></span></body></html>