<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>BRIM aka ZUI</title><style>
/* cspell:disable-file */
/* webkit printing magic: print all background colors */
html {
	-webkit-print-color-adjust: exact;
}
* {
	box-sizing: border-box;
	-webkit-print-color-adjust: exact;
}

html,
body {
	margin: 0;
	padding: 0;
}
@media only screen {
	body {
		margin: 2em auto;
		max-width: 900px;
		color: rgb(55, 53, 47);
	}
}

body {
	line-height: 1.5;
	white-space: pre-wrap;
}

a,
a.visited {
	color: inherit;
	text-decoration: underline;
}

.pdf-relative-link-path {
	font-size: 80%;
	color: #444;
}

h1,
h2,
h3 {
	letter-spacing: -0.01em;
	line-height: 1.2;
	font-weight: 600;
	margin-bottom: 0;
}

.page-title {
	font-size: 2.5rem;
	font-weight: 700;
	margin-top: 0;
	margin-bottom: 0.75em;
}

h1 {
	font-size: 1.875rem;
	margin-top: 1.875rem;
}

h2 {
	font-size: 1.5rem;
	margin-top: 1.5rem;
}

h3 {
	font-size: 1.25rem;
	margin-top: 1.25rem;
}

.source {
	border: 1px solid #ddd;
	border-radius: 3px;
	padding: 1.5em;
	word-break: break-all;
}

.callout {
	border-radius: 3px;
	padding: 1rem;
}

figure {
	margin: 1.25em 0;
	page-break-inside: avoid;
}

figcaption {
	opacity: 0.5;
	font-size: 85%;
	margin-top: 0.5em;
}

mark {
	background-color: transparent;
}

.indented {
	padding-left: 1.5em;
}

hr {
	background: transparent;
	display: block;
	width: 100%;
	height: 1px;
	visibility: visible;
	border: none;
	border-bottom: 1px solid rgba(55, 53, 47, 0.09);
}

img {
	max-width: 100%;
}

@media only print {
	img {
		max-height: 100vh;
		object-fit: contain;
	}
}

@page {
	margin: 1in;
}

.collection-content {
	font-size: 0.875rem;
}

.column-list {
	display: flex;
	justify-content: space-between;
}

.column {
	padding: 0 1em;
}

.column:first-child {
	padding-left: 0;
}

.column:last-child {
	padding-right: 0;
}

.table_of_contents-item {
	display: block;
	font-size: 0.875rem;
	line-height: 1.3;
	padding: 0.125rem;
}

.table_of_contents-indent-1 {
	margin-left: 1.5rem;
}

.table_of_contents-indent-2 {
	margin-left: 3rem;
}

.table_of_contents-indent-3 {
	margin-left: 4.5rem;
}

.table_of_contents-link {
	text-decoration: none;
	opacity: 0.7;
	border-bottom: 1px solid rgba(55, 53, 47, 0.18);
}

table,
th,
td {
	border: 1px solid rgba(55, 53, 47, 0.09);
	border-collapse: collapse;
}

table {
	border-left: none;
	border-right: none;
}

th,
td {
	font-weight: normal;
	padding: 0.25em 0.5em;
	line-height: 1.5;
	min-height: 1.5em;
	text-align: left;
}

th {
	color: rgba(55, 53, 47, 0.6);
}

ol,
ul {
	margin: 0;
	margin-block-start: 0.6em;
	margin-block-end: 0.6em;
}

li > ol:first-child,
li > ul:first-child {
	margin-block-start: 0.6em;
}

ul > li {
	list-style: disc;
}

ul.to-do-list {
	padding-inline-start: 0;
}

ul.to-do-list > li {
	list-style: none;
}

.to-do-children-checked {
	text-decoration: line-through;
	opacity: 0.375;
}

ul.toggle > li {
	list-style: none;
}

ul {
	padding-inline-start: 1.7em;
}

ul > li {
	padding-left: 0.1em;
}

ol {
	padding-inline-start: 1.6em;
}

ol > li {
	padding-left: 0.2em;
}

.mono ol {
	padding-inline-start: 2em;
}

.mono ol > li {
	text-indent: -0.4em;
}

.toggle {
	padding-inline-start: 0em;
	list-style-type: none;
}

/* Indent toggle children */
.toggle > li > details {
	padding-left: 1.7em;
}

.toggle > li > details > summary {
	margin-left: -1.1em;
}

.selected-value {
	display: inline-block;
	padding: 0 0.5em;
	background: rgba(206, 205, 202, 0.5);
	border-radius: 3px;
	margin-right: 0.5em;
	margin-top: 0.3em;
	margin-bottom: 0.3em;
	white-space: nowrap;
}

.collection-title {
	display: inline-block;
	margin-right: 1em;
}

.page-description {
	margin-bottom: 2em;
}

.simple-table {
	margin-top: 1em;
	font-size: 0.875rem;
	empty-cells: show;
}
.simple-table td {
	height: 29px;
	min-width: 120px;
}

.simple-table th {
	height: 29px;
	min-width: 120px;
}

.simple-table-header-color {
	background: rgb(247, 246, 243);
	color: black;
}
.simple-table-header {
	font-weight: 500;
}

time {
	opacity: 0.5;
}

.icon {
	display: inline-block;
	max-width: 1.2em;
	max-height: 1.2em;
	text-decoration: none;
	vertical-align: text-bottom;
	margin-right: 0.5em;
}

img.icon {
	border-radius: 3px;
}

.user-icon {
	width: 1.5em;
	height: 1.5em;
	border-radius: 100%;
	margin-right: 0.5rem;
}

.user-icon-inner {
	font-size: 0.8em;
}

.text-icon {
	border: 1px solid #000;
	text-align: center;
}

.page-cover-image {
	display: block;
	object-fit: cover;
	width: 100%;
	max-height: 30vh;
}

.page-header-icon {
	font-size: 3rem;
	margin-bottom: 1rem;
}

.page-header-icon-with-cover {
	margin-top: -0.72em;
	margin-left: 0.07em;
}

.page-header-icon img {
	border-radius: 3px;
}

.link-to-page {
	margin: 1em 0;
	padding: 0;
	border: none;
	font-weight: 500;
}

p > .user {
	opacity: 0.5;
}

td > .user,
td > time {
	white-space: nowrap;
}

input[type="checkbox"] {
	transform: scale(1.5);
	margin-right: 0.6em;
	vertical-align: middle;
}

p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.image {
	border: none;
	margin: 1.5em 0;
	padding: 0;
	border-radius: 0;
	text-align: center;
}

.code,
code {
	background: rgba(135, 131, 120, 0.15);
	border-radius: 3px;
	padding: 0.2em 0.4em;
	border-radius: 3px;
	font-size: 85%;
	tab-size: 2;
}

code {
	color: #eb5757;
}

.code {
	padding: 1.5em 1em;
}

.code-wrap {
	white-space: pre-wrap;
	word-break: break-all;
}

.code > code {
	background: none;
	padding: 0;
	font-size: 100%;
	color: inherit;
}

blockquote {
	font-size: 1.25em;
	margin: 1em 0;
	padding-left: 1em;
	border-left: 3px solid rgb(55, 53, 47);
}

.bookmark {
	text-decoration: none;
	max-height: 8em;
	padding: 0;
	display: flex;
	width: 100%;
	align-items: stretch;
}

.bookmark-title {
	font-size: 0.85em;
	overflow: hidden;
	text-overflow: ellipsis;
	height: 1.75em;
	white-space: nowrap;
}

.bookmark-text {
	display: flex;
	flex-direction: column;
}

.bookmark-info {
	flex: 4 1 180px;
	padding: 12px 14px 14px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
}

.bookmark-image {
	width: 33%;
	flex: 1 1 180px;
	display: block;
	position: relative;
	object-fit: cover;
	border-radius: 1px;
}

.bookmark-description {
	color: rgba(55, 53, 47, 0.6);
	font-size: 0.75em;
	overflow: hidden;
	max-height: 4.5em;
	word-break: break-word;
}

.bookmark-href {
	font-size: 0.75em;
	margin-top: 0.25em;
}

.sans { font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
.code { font-family: "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; }
.serif { font-family: Lyon-Text, Georgia, ui-serif, serif; }
.mono { font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; }
.pdf .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK JP'; }
.pdf:lang(zh-CN) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC'; }
.pdf:lang(zh-TW) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK TC'; }
.pdf:lang(ko-KR) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK KR'; }
.pdf .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK JP'; }
.pdf:lang(zh-CN) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK SC'; }
.pdf:lang(zh-TW) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK TC'; }
.pdf:lang(ko-KR) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK KR'; }
.pdf .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.highlight-default {
	color: rgba(50, 48, 44, 1);
}
.highlight-gray {
	color: rgba(115, 114, 110, 1);
	fill: rgba(115, 114, 110, 1);
}
.highlight-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.highlight-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.highlight-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.highlight-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.highlight-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.highlight-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.highlight-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.highlight-red {
	color: rgba(205, 60, 58, 1);
	fill: rgba(205, 60, 58, 1);
}
.highlight-default_background {
	color: rgba(50, 48, 44, 1);
}
.highlight-gray_background {
	background: rgba(248, 248, 247, 1);
}
.highlight-brown_background {
	background: rgba(244, 238, 238, 1);
}
.highlight-orange_background {
	background: rgba(251, 236, 221, 1);
}
.highlight-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.highlight-teal_background {
	background: rgba(237, 243, 236, 1);
}
.highlight-blue_background {
	background: rgba(231, 243, 248, 1);
}
.highlight-purple_background {
	background: rgba(248, 243, 252, 1);
}
.highlight-pink_background {
	background: rgba(252, 241, 246, 1);
}
.highlight-red_background {
	background: rgba(253, 235, 236, 1);
}
.block-color-default {
	color: inherit;
	fill: inherit;
}
.block-color-gray {
	color: rgba(115, 114, 110, 1);
	fill: rgba(115, 114, 110, 1);
}
.block-color-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.block-color-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.block-color-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.block-color-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.block-color-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.block-color-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.block-color-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.block-color-red {
	color: rgba(205, 60, 58, 1);
	fill: rgba(205, 60, 58, 1);
}
.block-color-default_background {
	color: inherit;
	fill: inherit;
}
.block-color-gray_background {
	background: rgba(248, 248, 247, 1);
}
.block-color-brown_background {
	background: rgba(244, 238, 238, 1);
}
.block-color-orange_background {
	background: rgba(251, 236, 221, 1);
}
.block-color-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.block-color-teal_background {
	background: rgba(237, 243, 236, 1);
}
.block-color-blue_background {
	background: rgba(231, 243, 248, 1);
}
.block-color-purple_background {
	background: rgba(248, 243, 252, 1);
}
.block-color-pink_background {
	background: rgba(252, 241, 246, 1);
}
.block-color-red_background {
	background: rgba(253, 235, 236, 1);
}
.select-value-color-default { background-color: rgba(84, 72, 49, 0.08); }
.select-value-color-gray { background-color: rgba(84, 72, 49, 0.15); }
.select-value-color-brown { background-color: rgba(210, 162, 141, 0.35); }
.select-value-color-orange { background-color: rgba(224, 124, 57, 0.27); }
.select-value-color-yellow { background-color: rgba(236, 191, 66, 0.39); }
.select-value-color-green { background-color: rgba(123, 183, 129, 0.27); }
.select-value-color-blue { background-color: rgba(93, 165, 206, 0.27); }
.select-value-color-purple { background-color: rgba(168, 129, 197, 0.27); }
.select-value-color-pink { background-color: rgba(225, 136, 179, 0.27); }
.select-value-color-red { background-color: rgba(244, 171, 159, 0.4); }

.checkbox {
	display: inline-flex;
	vertical-align: text-bottom;
	width: 16;
	height: 16;
	background-size: 16px;
	margin-left: 2px;
	margin-right: 5px;
}

.checkbox-on {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
}

.checkbox-off {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
}
	
</style></head><body><article id="22c5b2cc-075b-8018-bcdb-e3c2170751d9" class="page sans"><header><div class="page-header-icon undefined"><img class="icon" src="https://tryhackme-images.s3.amazonaws.com/room-icons/2fd190921720b45068ae86c286ed4098.png"/></div><h1 class="page-title">BRIM aka ZUI</h1><p class="page-description"></p></header><div class="page-body"><figure id="22c5b2cc-075b-8030-86b9-c597027d27fa" class="image"><a href="https://tryhackme-images.s3.amazonaws.com/user-uploads/6131132af49360005df01ae3/room-content/ff4d1d9dead9acca747fc48cc2f43ec2.png"><img src="https://tryhackme-images.s3.amazonaws.com/user-uploads/6131132af49360005df01ae3/room-content/ff4d1d9dead9acca747fc48cc2f43ec2.png"/></a></figure><p id="22c5b2cc-075b-8022-9d29-d7060c91909a" class=""><strong>What is Brim?</strong></p><p id="22c5b2cc-075b-8055-81f3-cb4b3c9dbfc8" class="">Brim is an open-source desktop application that processes pcap files and logs files, with a primary focus on providing search and analytics. It uses the Zeek log processing format. It also supports Zeek signatures and Suricata Rules for detection.</p><p id="22c5b2cc-075b-8075-a973-c1d5fa4f6fcf" class="">It can handle two types of data as an input;</p><ul id="22c5b2cc-075b-80c6-a00f-dbf8293b6c35" class="bulleted-list"><li style="list-style-type:disc">Packet Capture Files: Pcap files created with tcpdump, tshark and Wireshark like applications.</li></ul><ul id="22c5b2cc-075b-80a9-b82f-fab8e290e5f8" class="bulleted-list"><li style="list-style-type:disc">Log Files: Structured log files like Zeek logs.</li></ul><p id="22c5b2cc-075b-801f-a463-f901a0820b04" class="">Brim is built on open-source platforms:</p><ul id="22c5b2cc-075b-8016-9250-fa1b666ce4bd" class="bulleted-list"><li style="list-style-type:disc"><strong>Zeek:</strong> Log generating engine.</li></ul><ul id="22c5b2cc-075b-809f-84f5-f28a18d27ee2" class="bulleted-list"><li style="list-style-type:disc"><strong>Zed Language:</strong> Log querying language that allows performing keywoırd searches with filters and pipelines.</li></ul><ul id="22c5b2cc-075b-804e-a4d4-e5ce4ce32b95" class="bulleted-list"><li style="list-style-type:disc"><strong>ZNG Data Format:</strong> Data storage format that supports saving data streams.</li></ul><ul id="22c5b2cc-075b-80e2-b637-c1b61ca5fd25" class="bulleted-list"><li style="list-style-type:disc"><strong>Electron and React:</strong> Cross-platform UI.</li></ul><p id="22c5b2cc-075b-8030-b675-cf8fc9b8aad8" class=""><strong>Why Brim?</strong></p><p id="22c5b2cc-075b-808d-ad47-ca6a255fcf91" class="">Ever had to investigate a big pcap file? Pcap files bigger than one gigabyte are cumbersome for Wireshark. Processing big pcaps with tcpdump and Zeek is efficient but requires time and effort. Brim reduces the time and effort spent processing pcap files and investigating the log files by providing a simple and powerful GUI application.</p><p id="22c5b2cc-075b-8070-a6cd-dc274e675b9c" class=""><strong>Brim vs Wireshark vs Zeek</strong></p><p id="22c5b2cc-075b-80ec-ab0e-ee437fa0f15a" class="">While<br/> each of them is powerful and useful, it is good to know the strengths <br/>and weaknesses of each tool and which one to use for the best outcome. <br/>As a traffic capture analyser, some overlapping functionalities exist, <br/>but each one has a unique value for different situations.</p><p id="22c5b2cc-075b-8036-8e78-e8e0526588b9" class="">The common best practice is handling medium-sized pcaps with Wireshark, creating logs and correlating events with Zeek, and processing multiple logs in Brim.</p><table id="22c5b2cc-075b-80ef-8c72-de43cd70c261" class="simple-table"><tbody><tr id="22c5b2cc-075b-8066-8cf0-f7624242d250"><td id="Fuu]" class=""></td><td id="^A[K" class="">Brim</td><td id="s?_L" class="">Wireshark</td><td id="T`eN" class="">Zeek</td></tr><tr id="22c5b2cc-075b-8016-b4a3-f06c48452c49"><td id="Fuu]" class="">Purpose</td><td id="^A[K" class="">Pcap processing; event/stream and log investigation.</td><td id="s?_L" class="">Traffic sniffing. Pcap processing; packet and stream investigation.</td><td id="T`eN" class="">Pcap processing; event/stream and log investigation.</td></tr><tr id="22c5b2cc-075b-8047-8a7b-dad682453e5e"><td id="Fuu]" class="">GUI</td><td id="^A[K" class=""><strong>✔</strong></td><td id="s?_L" class=""><strong>✔</strong></td><td id="T`eN" class="">✖</td></tr><tr id="22c5b2cc-075b-80f2-a955-fd52a63a002d"><td id="Fuu]" class="">Sniffing</td><td id="^A[K" class="">✖</td><td id="s?_L" class=""><strong>✔</strong></td><td id="T`eN" class=""><strong>✔</strong></td></tr><tr id="22c5b2cc-075b-8087-b224-ce5866cd3c85"><td id="Fuu]" class="">Pcap processing</td><td id="^A[K" class=""><strong>✔</strong></td><td id="s?_L" class=""><strong>✔</strong></td><td id="T`eN" class=""><strong>✔</strong></td></tr><tr id="22c5b2cc-075b-80b0-87c1-cdf552e88746"><td id="Fuu]" class="">Log processing</td><td id="^A[K" class=""><strong>✔</strong></td><td id="s?_L" class="">✖</td><td id="T`eN" class=""><strong>✔</strong></td></tr><tr id="22c5b2cc-075b-805c-9978-ea34e827c770"><td id="Fuu]" class="">Packet decoding</td><td id="^A[K" class="">✖</td><td id="s?_L" class=""><strong>✔</strong></td><td id="T`eN" class=""><strong>✔</strong></td></tr><tr id="22c5b2cc-075b-801d-8c62-c08bb8dd1c9f"><td id="Fuu]" class="">Filtering</td><td id="^A[K" class=""><strong>✔</strong></td><td id="s?_L" class=""><strong>✔</strong></td><td id="T`eN" class=""><strong>✔</strong></td></tr><tr id="22c5b2cc-075b-80a2-9f8b-e5ce7cadfd4c"><td id="Fuu]" class="">Scripting</td><td id="^A[K" class="">✖</td><td id="s?_L" class="">✖</td><td id="T`eN" class=""><strong>✔</strong></td></tr><tr id="22c5b2cc-075b-809c-bc03-cfe15af3f60c"><td id="Fuu]" class="">Signature Support</td><td id="^A[K" class=""><strong>✔</strong></td><td id="s?_L" class="">✖</td><td id="T`eN" class=""><strong>✔</strong></td></tr><tr id="22c5b2cc-075b-802d-b3d5-df29507342e1"><td id="Fuu]" class="">Statistics</td><td id="^A[K" class=""><strong>✔</strong></td><td id="s?_L" class=""><strong>✔</strong></td><td id="T`eN" class=""><strong>✔</strong></td></tr><tr id="22c5b2cc-075b-80b9-9f55-fa1d53464525"><td id="Fuu]" class="">File Extraction</td><td id="^A[K" class="">✖</td><td id="s?_L" class=""><strong>✔</strong></td><td id="T`eN" class=""><strong>✔</strong></td></tr><tr id="22c5b2cc-075b-8038-93de-f0d093db0cd0"><td id="Fuu]" class="">Handling  pcaps over 1GB</td><td id="^A[K" class="">Medium performance</td><td id="s?_L" class="">Low performance</td><td id="T`eN" class="">Good performance</td></tr><tr id="22c5b2cc-075b-8010-b2bf-c52844db922d"><td id="Fuu]" class="">Ease of Management</td><td id="^A[K" class="">4/5</td><td id="s?_L" class="">4/5</td><td id="T`eN" class="">3/5</td></tr></tbody></table><h1 id="22c5b2cc-075b-801b-a131-cd03aed3a73b" class="">BRIM Dashboard</h1><figure id="22c5b2cc-075b-80ca-96af-e6bb257a68fa" class="image"><a href="image%20190.png"><img style="width:2499px" src="image%20190.png"/></a></figure><p id="22c5b2cc-075b-8013-8c05-c68da561a10a" class="">
</p><p id="22c5b2cc-075b-80a9-8fea-dd235becd5eb" class="">Answer the questions below</p><ul id="22c5b2cc-075b-8091-84f5-dd2705df5ad2" class="bulleted-list"><li style="list-style-type:disc">Process the &quot;sample.pcap&quot; file and look at the details of the first DNS log <br/>that appear on the dashboard. What is the &quot;qclass_name&quot;?</li></ul><figure id="22c5b2cc-075b-801c-a0af-cf2e03d6bee4" class="image"><a href="image%20191.png"><img style="width:2221px" src="image%20191.png"/></a></figure><ul id="22c5b2cc-075b-80a9-be8a-d8d38c02258e" class="bulleted-list"><li style="list-style-type:disc">Look at the details of the first NTP log that appear on the dashboard. What is the &quot;duration&quot; value?</li></ul><figure id="22c5b2cc-075b-8005-ad89-e68c4b422757" class="image"><a href="image%20192.png"><img style="width:2214px" src="image%20192.png"/></a></figure><ul id="22c5b2cc-075b-805e-9e75-e7329ef5baa5" class="bulleted-list"><li style="list-style-type:disc">Look at the details of the STATS packet log that is visible on the dashboard. What is the &quot;reassem_tcp_size&quot;?</li></ul><figure id="22c5b2cc-075b-808e-b7c6-f5b8518166b7" class="image"><a href="image%20193.png"><img style="width:2220px" src="image%20193.png"/></a></figure><p id="22c5b2cc-075b-80db-a1df-d8ac29b71ac9" class="">
</p><h2 id="22c5b2cc-075b-8068-b028-df4e27f68f2f" class="">QUERIES</h2><p id="22c5b2cc-075b-8016-8397-c561822c8f21" class="">There are 12 built in queries</p><figure id="22c5b2cc-075b-8031-bdb9-da08026688fa" class="image"><a href="image%20194.png"><img style="width:567px" src="image%20194.png"/></a></figure><ul id="22c5b2cc-075b-8068-8dc0-c9bc37e5acf6" class="bulleted-list"><li style="list-style-type:disc">Investigate the files. What is the name of the detected GIF file?</li></ul><figure id="22c5b2cc-075b-80d6-8d88-f9c61a09fc3f" class="image"><a href="image%20195.png"><img style="width:2219px" src="image%20195.png"/></a></figure><ul id="22c5b2cc-075b-800e-a49b-d50ee32e3ca8" class="bulleted-list"><li style="list-style-type:disc">Investigate the conn logfile. What is the number of the identified city names?</li></ul><p id="22c5b2cc-075b-80e4-9989-d1ad558ecd0a" class=""><code>_path==&quot;conn&quot; | cut geo.resp.country_code, geo.resp.region, geo.resp.city</code><br/></p><figure id="22c5b2cc-075b-8075-9c5a-cdae9ccbaee5" class="image"><a href="image%20196.png"><img style="width:578px" src="image%20196.png"/></a></figure><ul id="22c5b2cc-075b-801b-a82f-cef1d1dba795" class="bulleted-list"><li style="list-style-type:disc">Investigate the Suricata alerts. What is the Signature id of the alert category &quot;Potential Corporate Privacy Violation&quot;?</li></ul><figure id="22c5b2cc-075b-802c-ba40-d834980fa266" class="image"><a href="image%20197.png"><img style="width:709.9833374023438px" src="image%20197.png"/></a></figure><p id="22c5b2cc-075b-8098-b8f4-ff9a8dcd0878" class="">
</p><p id="22c5b2cc-075b-80a7-a5e4-d36a8a0a3582" class="">
</p><h2 id="22c5b2cc-075b-80dc-bce7-ea0d3b794f2b" class="">CUSTOM QUERIES</h2><p id="22c5b2cc-075b-8049-8b82-e80373afbe35" class=""><strong>Brim Query Reference</strong></p><table id="22c5b2cc-075b-8008-820f-e86e6cc4fa41" class="simple-table"><tbody><tr id="22c5b2cc-075b-8014-8670-cfcdd7e2d6c4"><td id=":Dyc" class=""><strong>Purpose</strong></td><td id="WBef" class=""><strong>Syntax</strong></td><td id="Pz;t" class="" style="width:342.56666564941406px"><strong>Example Query</strong></td></tr><tr id="22c5b2cc-075b-8073-8667-f56056e8d8af"><td id=":Dyc" class="">Basic search</td><td id="WBef" class="">You can search any string and numeric value.</td><td id="Pz;t" class="" style="width:342.56666564941406px">Find logs containing an IP address or any value.<br/>        <code>10.0.0.1</code></td></tr><tr id="22c5b2cc-075b-80c9-9a55-f74bbf52ec17"><td id=":Dyc" class="">Logical operators</td><td id="WBef" class="">Or, And, Not.</td><td id="Pz;t" class="" style="width:342.56666564941406px">Find logs contain three digits of an IP AND NTP keyword.<br/>        <code>192 and NTP</code></td></tr><tr id="22c5b2cc-075b-80c6-8b03-fd77cdb9cc44"><td id=":Dyc" class="">Filter values</td><td id="WBef" class="">&quot;field name&quot; == &quot;value&quot;</td><td id="Pz;t" class="" style="width:342.56666564941406px">Filter source IP.<code>id.orig_h==192.168.121.40</code></td></tr><tr id="22c5b2cc-075b-8073-8ff9-cdb873d0bd54"><td id=":Dyc" class="">List specific log file contents</td><td id="WBef" class="">_path==&quot;log name&quot;</td><td id="Pz;t" class="" style="width:342.56666564941406px">List the contents of the conn log file.<br/>        <code>_path==&quot;conn&quot;</code></td></tr><tr id="22c5b2cc-075b-80f0-8b11-f2d978f9fad3"><td id=":Dyc" class="">Count field values</td><td id="WBef" class="">count () by &quot;field&quot;</td><td id="Pz;t" class="" style="width:342.56666564941406px">Count the number of the available log files.<br/>        <code>count () by _path</code></td></tr><tr id="22c5b2cc-075b-8094-9fa4-e3fb2fd4871e"><td id=":Dyc" class="">Sort findings</td><td id="WBef" class="">sort</td><td id="Pz;t" class="" style="width:342.56666564941406px">Count the number of the available log files and sort<br/>            recursively.<br/>        <code>count () by _path | sort -r</code></td></tr><tr id="22c5b2cc-075b-80c6-95e1-e9b4f37d04d2"><td id=":Dyc" class="">Cut specific field from a log file</td><td id="WBef" class="">_path==&quot;conn&quot; | cut &quot;field name&quot;</td><td id="Pz;t" class="" style="width:342.56666564941406px">Cut the source IP, destination port and destination IP addresses<br/>            from the conn log file.<br/>        <code>_path==&quot;conn&quot; | cut id.orig_h, id.resp_p, id.resp_h</code></td></tr><tr id="22c5b2cc-075b-80e8-9f27-cd53544e4b50"><td id=":Dyc" class="">List unique values</td><td id="WBef" class="">uniq</td><td id="Pz;t" class="" style="width:342.56666564941406px">Show the unique network connections. <br/>        <br/><code>_path==&quot;conn&quot; | cut id.orig_h, id.resp_p, id.resp_h | sort | uniq</code></td></tr></tbody></table><table id="22c5b2cc-075b-8038-93e1-fb7b0fe3b5b2" class="simple-table"><tbody><tr id="22c5b2cc-075b-80f4-a398-c6ca52b5f343"><td id="H{qm" class=""><strong>Communicated Hosts</strong></td><td id="TSc@" class="" style="width:568px">Identifying the list of communicated hosts is the first step of the<br/>          investigation. Security analysts need to know which hosts are actively<br/>          communicating on the network to detect any suspicious and abnormal<br/>          activity in the first place. This approach will help analysts to<br/>          detect possible access violations, exploitation attempts and malware<br/>          infections.<br/>        <br/>Query: <code>_path==&quot;conn&quot; | cut id.orig_h, id.resp_h | sort | uniq</code></td></tr><tr id="22c5b2cc-075b-8021-9af4-d0a030f14663"><td id="H{qm" class=""><strong>Frequently Communicated Hosts</strong></td><td id="TSc@" class="" style="width:568px">After having the list of communicated hosts, it is important to<br/>          identify which hosts communicate with each other most frequently. This<br/>          will help security analysts to detect possible data exfiltration,<br/>          exploitation and backdooring activities.<br/>        <br/>Query: <code>_path==&quot;conn&quot; | cut id.orig_h, id.resp_h | sort | uniq -c | sort -r</code></td></tr><tr id="22c5b2cc-075b-8080-9319-ef363fc20772"><td id="H{qm" class=""><strong>Most Active Ports</strong></td><td id="TSc@" class="" style="width:568px">Suspicious activities are not always detectable in the first place.<br/>          Attackers use multiple ways of hiding and bypassing methods to avoid<br/>          detection. However, since the data is evidence, it is impossible to<br/>          hide the packet traces. Investigating the most active ports will help<br/>          analysts to detect silent and well-hidden anomalies by focusing on the<br/>          data bus and used services. <br/>        <br/><strong>Query:</strong><code>_path==&quot;conn&quot; | cut id.resp_p, service | sort | uniq -c | sort -r count</code><br/><br/>Query:  <code>_path==&quot;conn&quot; | cut id.orig_h, id.resp_h, id.resp_p, service | sort id.resp_p | uniq -c | sort -r </code></td></tr><tr id="22c5b2cc-075b-80ec-8048-e3bc1996209f"><td id="H{qm" class=""><strong>Long Connections</strong></td><td id="TSc@" class="" style="width:568px">For security analysts, the long connections could be the first anomaly<br/>          indicator. If the client is not designed to serve a continuous<br/>          service, investigating the connection duration between two IP<br/>          addresses can reveal possible anomalies like backdoors.<br/>        <br/>Query: <code>_path==&quot;conn&quot; | cut id.orig_h, id.resp_p, id.resp_h, duration | sort -r duration</code></td></tr><tr id="22c5b2cc-075b-8099-bee5-ded5e0b89f60"><td id="H{qm" class=""><strong>Transferred Data</strong></td><td id="TSc@" class="" style="width:568px">Another essential point is calculating the transferred data size. If<br/>          the client is not designed to serve and receive files and act as a<br/>          file server, it is important to investigate the total bytes for each<br/>          connection. Thus, analysts can distinguish possible data exfiltration<br/>          or suspicious file actions like malware downloading and spreading.<br/>        <br/>Query: <code>_path==&quot;conn&quot;<br/> | put total_bytes := orig_bytes + resp_bytes | sort -r total_bytes | <br/>cut uid, id, orig_bytes, resp_bytes, total_bytes</code></td></tr><tr id="22c5b2cc-075b-8088-8c15-d2dd9b37e20e"><td id="H{qm" class="">DNS<strong> and HTTP Queries</strong></td><td id="TSc@" class="" style="width:568px">Identifying suspicious and out of ordinary domain connections and<br/>          requests is another significant point for a security analyst. Abnormal<br/>          connections can help detect C2 communications and possible compromised/infected hosts.<br/>          Identifying the suspicious DNS queries and HTTP requests help security<br/>          analysts to detect malware C2 channels and support the investigation<br/>          hypothesis.<br/><br/>Query: <code>_path==&quot;dns&quot; | count () by query | sort -r</code><br/><br/>Query: <code>_path==&quot;http&quot; | count () by uri | sort -r</code></td></tr><tr id="22c5b2cc-075b-8083-8d1e-c2c3d828bf2e"><td id="H{qm" class=""><strong>Suspicious Hostnames</strong></td><td id="TSc@" class="" style="width:568px">Identifying suspicious and out of ordinary hostnames helps analysts to<br/>          detect rogue hosts. Investigating the DHCP logs provides the hostname<br/>          and domain information.<br/>        <br/>Query: <code>_path==&quot;dhcp&quot; | cut host_name, domain</code></td></tr><tr id="22c5b2cc-075b-80e5-aad8-d0b0f095baf1"><td id="H{qm" class=""><strong>Suspicious IP Addresses</strong></td><td id="TSc@" class="" style="width:568px">For security analysts, identifying suspicious and out of ordinary IP<br/>          addresses is essential as identifying weird domain addresses. Since<br/>          the connection logs are stored in one single log file (conn),<br/>          filtering IP addresses is more manageable and provides more reliable<br/>          results.<br/>        <br/>Query: <code>_path==&quot;conn&quot; | put classnet := network_of(id.resp_h) | cut classnet | count() by classnet | sort -r</code></td></tr><tr id="22c5b2cc-075b-80c2-8b55-f5619bed6725"><td id="H{qm" class=""><strong>Detect Files</strong></td><td id="TSc@" class="" style="width:568px">Investigating transferred files is another important point of traffic<br/>          investigation. Performing this hunt will help security analysts to<br/>          detect the transfer of malware or infected files by correlating the<br/>          hash values. This act is also valuable for detecting transferring of<br/>          sensitive files.<br/>        <br/>Query: <code>filename!=null</code></td></tr><tr id="22c5b2cc-075b-8042-824c-f5e1da5c3c32"><td id="H{qm" class=""><strong>SMB Activity</strong></td><td id="TSc@" class="" style="width:568px">Another significant point is investigating the SMB activity. This will<br/>          help analysts to detect possible malicious activities like<br/>          exploitation, lateral movement and malicious file sharing. When<br/>          running an investigation, it is suggested to ask, &quot;What is going on in<br/>          SMB?&quot;.<br/>        <br/>Query: <code>_path==&quot;dce_rpc&quot; OR _path==&quot;smb_mapping&quot; OR _path==&quot;smb_files&quot;</code></td></tr><tr id="22c5b2cc-075b-803e-a954-cd16533e18b5"><td id="H{qm" class=""><strong>Known Patterns</strong></td><td id="TSc@" class="" style="width:568px">Known patterns represent alerts generated by security solutions. These<br/>          alerts are generated against the common attack/threat/malware patterns<br/>          and known by endpoint security products, firewalls and IDS/IPS<br/>          solutions. This data source highly relies on available signatures,<br/>          attacks and anomaly patterns. Investigating available log sources<br/>          containing alerts is vital for a security analyst.<br/>        <br/><br/>          Brim supports the Zeek and Suricata logs, so any anomaly detected by<br/>          these products will create a log file. Investigating these log files<br/>          can provide a clue where the analyst should focus.<br/>        <br/>Query: <code>event_type==&quot;alert&quot; or _path==&quot;notice&quot; or _path==&quot;signatures&quot;</code></td></tr></tbody></table><h1 id="22c5b2cc-075b-8017-bf4d-ea4d292de71f" class="block-color-purple"><strong>Threat Hunting with Brim | Malware C2 Detection</strong></h1><p id="22c5b2cc-075b-803b-9940-c537488a97e4" class="">What is the name of the file downloaded from the CobaltStrike C2 connection?<br/></p><figure id="22c5b2cc-075b-8028-a11a-ce64f39850aa" class="image"><a href="image%20198.png"><img style="width:710px" src="image%20198.png"/></a></figure><p id="22c5b2cc-075b-80f1-8e1b-c8f77e7d88ea" class="">What is the number of CobaltStrike connections using port 443?<br/></p><figure id="22c5b2cc-075b-80d4-b388-cc31954f89d2" class="image"><a href="image%20199.png"><img style="width:710px" src="image%20199.png"/></a></figure><p id="22c5b2cc-075b-80b8-a673-f1bc91658064" class="">There is an additional C2 channel in used the given case. What is the name of the secondary C2 channel?</p><p id="22c5b2cc-075b-8050-b5c2-e4668c2a3876" class=""><code>event_type==&quot;alert&quot; | cut alert.signature | sort -r | uniq -c | sort -r count</code></p><figure id="22c5b2cc-075b-801f-bc28-eecb4e89ee0b" class="image"><a href="image%20200.png"><img style="width:578px" src="image%20200.png"/></a></figure><p id="22c5b2cc-075b-8086-9065-f5c755832781" class="">First i looked at alerts, then form therei traced the identified suspicious IP</p><p id="22c5b2cc-075b-8057-b7c2-ca6801a87a86" class="">
</p><h2 id="22c5b2cc-075b-800a-9405-d8aa2641a50a" class="block-color-teal"><strong>Threat Hunting with Brim | Crypto Mining</strong></h2><p id="22c5b2cc-075b-80d8-9fc4-ca9c2ecf3305" class="">How many connections used port 19999?</p><figure id="22c5b2cc-075b-80a4-8d27-e7085869b0f4" class="image"><a href="image%20201.png"><img style="width:578px" src="image%20201.png"/></a></figure><p id="22c5b2cc-075b-8034-9861-e2d2deb73ac5" class="">What is the name of the service used by port 6666?</p><figure id="22c5b2cc-075b-8092-bd8e-d0823d60406e" class="image"><a href="image%20202.png"><img style="width:578px" src="image%20202.png"/></a></figure><p id="22c5b2cc-075b-803a-8116-c7ba36fcc448" class="">What is the amount of transferred total bytes to &quot;101.201.172.235:8888&quot;?</p><p id="22c5b2cc-075b-809a-bd89-d3aef48b0aaf" class="">total bytes = orig+resp</p><figure id="22c5b2cc-075b-8070-abae-f00862ab6f37" class="image"><a href="image%20203.png"><img style="width:710px" src="image%20203.png"/></a></figure><p id="22c5b2cc-075b-8025-a870-fa021e89fa83" class="">What is the detected MITRE tactic id?</p><figure id="22c5b2cc-075b-80c3-95ca-fb704b37e7da" class="image"><a href="image%20204.png"><img style="width:710px" src="image%20204.png"/></a></figure></div></article><span class="sans" style="font-size:14px;padding-top:2em"></span></body></html>