<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>Investigating with ELK 101</title><style>
/* cspell:disable-file */
/* webkit printing magic: print all background colors */
html {
	-webkit-print-color-adjust: exact;
}
* {
	box-sizing: border-box;
	-webkit-print-color-adjust: exact;
}

html,
body {
	margin: 0;
	padding: 0;
}
@media only screen {
	body {
		margin: 2em auto;
		max-width: 900px;
		color: rgb(55, 53, 47);
	}
}

body {
	line-height: 1.5;
	white-space: pre-wrap;
}

a,
a.visited {
	color: inherit;
	text-decoration: underline;
}

.pdf-relative-link-path {
	font-size: 80%;
	color: #444;
}

h1,
h2,
h3 {
	letter-spacing: -0.01em;
	line-height: 1.2;
	font-weight: 600;
	margin-bottom: 0;
}

.page-title {
	font-size: 2.5rem;
	font-weight: 700;
	margin-top: 0;
	margin-bottom: 0.75em;
}

h1 {
	font-size: 1.875rem;
	margin-top: 1.875rem;
}

h2 {
	font-size: 1.5rem;
	margin-top: 1.5rem;
}

h3 {
	font-size: 1.25rem;
	margin-top: 1.25rem;
}

.source {
	border: 1px solid #ddd;
	border-radius: 3px;
	padding: 1.5em;
	word-break: break-all;
}

.callout {
	border-radius: 3px;
	padding: 1rem;
}

figure {
	margin: 1.25em 0;
	page-break-inside: avoid;
}

figcaption {
	opacity: 0.5;
	font-size: 85%;
	margin-top: 0.5em;
}

mark {
	background-color: transparent;
}

.indented {
	padding-left: 1.5em;
}

hr {
	background: transparent;
	display: block;
	width: 100%;
	height: 1px;
	visibility: visible;
	border: none;
	border-bottom: 1px solid rgba(55, 53, 47, 0.09);
}

img {
	max-width: 100%;
}

@media only print {
	img {
		max-height: 100vh;
		object-fit: contain;
	}
}

@page {
	margin: 1in;
}

.collection-content {
	font-size: 0.875rem;
}

.column-list {
	display: flex;
	justify-content: space-between;
}

.column {
	padding: 0 1em;
}

.column:first-child {
	padding-left: 0;
}

.column:last-child {
	padding-right: 0;
}

.table_of_contents-item {
	display: block;
	font-size: 0.875rem;
	line-height: 1.3;
	padding: 0.125rem;
}

.table_of_contents-indent-1 {
	margin-left: 1.5rem;
}

.table_of_contents-indent-2 {
	margin-left: 3rem;
}

.table_of_contents-indent-3 {
	margin-left: 4.5rem;
}

.table_of_contents-link {
	text-decoration: none;
	opacity: 0.7;
	border-bottom: 1px solid rgba(55, 53, 47, 0.18);
}

table,
th,
td {
	border: 1px solid rgba(55, 53, 47, 0.09);
	border-collapse: collapse;
}

table {
	border-left: none;
	border-right: none;
}

th,
td {
	font-weight: normal;
	padding: 0.25em 0.5em;
	line-height: 1.5;
	min-height: 1.5em;
	text-align: left;
}

th {
	color: rgba(55, 53, 47, 0.6);
}

ol,
ul {
	margin: 0;
	margin-block-start: 0.6em;
	margin-block-end: 0.6em;
}

li > ol:first-child,
li > ul:first-child {
	margin-block-start: 0.6em;
}

ul > li {
	list-style: disc;
}

ul.to-do-list {
	padding-inline-start: 0;
}

ul.to-do-list > li {
	list-style: none;
}

.to-do-children-checked {
	text-decoration: line-through;
	opacity: 0.375;
}

ul.toggle > li {
	list-style: none;
}

ul {
	padding-inline-start: 1.7em;
}

ul > li {
	padding-left: 0.1em;
}

ol {
	padding-inline-start: 1.6em;
}

ol > li {
	padding-left: 0.2em;
}

.mono ol {
	padding-inline-start: 2em;
}

.mono ol > li {
	text-indent: -0.4em;
}

.toggle {
	padding-inline-start: 0em;
	list-style-type: none;
}

/* Indent toggle children */
.toggle > li > details {
	padding-left: 1.7em;
}

.toggle > li > details > summary {
	margin-left: -1.1em;
}

.selected-value {
	display: inline-block;
	padding: 0 0.5em;
	background: rgba(206, 205, 202, 0.5);
	border-radius: 3px;
	margin-right: 0.5em;
	margin-top: 0.3em;
	margin-bottom: 0.3em;
	white-space: nowrap;
}

.collection-title {
	display: inline-block;
	margin-right: 1em;
}

.page-description {
	margin-bottom: 2em;
}

.simple-table {
	margin-top: 1em;
	font-size: 0.875rem;
	empty-cells: show;
}
.simple-table td {
	height: 29px;
	min-width: 120px;
}

.simple-table th {
	height: 29px;
	min-width: 120px;
}

.simple-table-header-color {
	background: rgb(247, 246, 243);
	color: black;
}
.simple-table-header {
	font-weight: 500;
}

time {
	opacity: 0.5;
}

.icon {
	display: inline-block;
	max-width: 1.2em;
	max-height: 1.2em;
	text-decoration: none;
	vertical-align: text-bottom;
	margin-right: 0.5em;
}

img.icon {
	border-radius: 3px;
}

.user-icon {
	width: 1.5em;
	height: 1.5em;
	border-radius: 100%;
	margin-right: 0.5rem;
}

.user-icon-inner {
	font-size: 0.8em;
}

.text-icon {
	border: 1px solid #000;
	text-align: center;
}

.page-cover-image {
	display: block;
	object-fit: cover;
	width: 100%;
	max-height: 30vh;
}

.page-header-icon {
	font-size: 3rem;
	margin-bottom: 1rem;
}

.page-header-icon-with-cover {
	margin-top: -0.72em;
	margin-left: 0.07em;
}

.page-header-icon img {
	border-radius: 3px;
}

.link-to-page {
	margin: 1em 0;
	padding: 0;
	border: none;
	font-weight: 500;
}

p > .user {
	opacity: 0.5;
}

td > .user,
td > time {
	white-space: nowrap;
}

input[type="checkbox"] {
	transform: scale(1.5);
	margin-right: 0.6em;
	vertical-align: middle;
}

p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.image {
	border: none;
	margin: 1.5em 0;
	padding: 0;
	border-radius: 0;
	text-align: center;
}

.code,
code {
	background: rgba(135, 131, 120, 0.15);
	border-radius: 3px;
	padding: 0.2em 0.4em;
	border-radius: 3px;
	font-size: 85%;
	tab-size: 2;
}

code {
	color: #eb5757;
}

.code {
	padding: 1.5em 1em;
}

.code-wrap {
	white-space: pre-wrap;
	word-break: break-all;
}

.code > code {
	background: none;
	padding: 0;
	font-size: 100%;
	color: inherit;
}

blockquote {
	font-size: 1.25em;
	margin: 1em 0;
	padding-left: 1em;
	border-left: 3px solid rgb(55, 53, 47);
}

.bookmark {
	text-decoration: none;
	max-height: 8em;
	padding: 0;
	display: flex;
	width: 100%;
	align-items: stretch;
}

.bookmark-title {
	font-size: 0.85em;
	overflow: hidden;
	text-overflow: ellipsis;
	height: 1.75em;
	white-space: nowrap;
}

.bookmark-text {
	display: flex;
	flex-direction: column;
}

.bookmark-info {
	flex: 4 1 180px;
	padding: 12px 14px 14px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
}

.bookmark-image {
	width: 33%;
	flex: 1 1 180px;
	display: block;
	position: relative;
	object-fit: cover;
	border-radius: 1px;
}

.bookmark-description {
	color: rgba(55, 53, 47, 0.6);
	font-size: 0.75em;
	overflow: hidden;
	max-height: 4.5em;
	word-break: break-word;
}

.bookmark-href {
	font-size: 0.75em;
	margin-top: 0.25em;
}

.sans { font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
.code { font-family: "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; }
.serif { font-family: Lyon-Text, Georgia, ui-serif, serif; }
.mono { font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; }
.pdf .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK JP'; }
.pdf:lang(zh-CN) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC'; }
.pdf:lang(zh-TW) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK TC'; }
.pdf:lang(ko-KR) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK KR'; }
.pdf .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK JP'; }
.pdf:lang(zh-CN) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK SC'; }
.pdf:lang(zh-TW) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK TC'; }
.pdf:lang(ko-KR) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK KR'; }
.pdf .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.highlight-default {
	color: rgba(50, 48, 44, 1);
}
.highlight-gray {
	color: rgba(115, 114, 110, 1);
	fill: rgba(115, 114, 110, 1);
}
.highlight-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.highlight-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.highlight-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.highlight-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.highlight-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.highlight-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.highlight-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.highlight-red {
	color: rgba(205, 60, 58, 1);
	fill: rgba(205, 60, 58, 1);
}
.highlight-default_background {
	color: rgba(50, 48, 44, 1);
}
.highlight-gray_background {
	background: rgba(248, 248, 247, 1);
}
.highlight-brown_background {
	background: rgba(244, 238, 238, 1);
}
.highlight-orange_background {
	background: rgba(251, 236, 221, 1);
}
.highlight-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.highlight-teal_background {
	background: rgba(237, 243, 236, 1);
}
.highlight-blue_background {
	background: rgba(231, 243, 248, 1);
}
.highlight-purple_background {
	background: rgba(248, 243, 252, 1);
}
.highlight-pink_background {
	background: rgba(252, 241, 246, 1);
}
.highlight-red_background {
	background: rgba(253, 235, 236, 1);
}
.block-color-default {
	color: inherit;
	fill: inherit;
}
.block-color-gray {
	color: rgba(115, 114, 110, 1);
	fill: rgba(115, 114, 110, 1);
}
.block-color-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.block-color-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.block-color-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.block-color-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.block-color-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.block-color-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.block-color-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.block-color-red {
	color: rgba(205, 60, 58, 1);
	fill: rgba(205, 60, 58, 1);
}
.block-color-default_background {
	color: inherit;
	fill: inherit;
}
.block-color-gray_background {
	background: rgba(248, 248, 247, 1);
}
.block-color-brown_background {
	background: rgba(244, 238, 238, 1);
}
.block-color-orange_background {
	background: rgba(251, 236, 221, 1);
}
.block-color-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.block-color-teal_background {
	background: rgba(237, 243, 236, 1);
}
.block-color-blue_background {
	background: rgba(231, 243, 248, 1);
}
.block-color-purple_background {
	background: rgba(248, 243, 252, 1);
}
.block-color-pink_background {
	background: rgba(252, 241, 246, 1);
}
.block-color-red_background {
	background: rgba(253, 235, 236, 1);
}
.select-value-color-default { background-color: rgba(84, 72, 49, 0.08); }
.select-value-color-gray { background-color: rgba(84, 72, 49, 0.15); }
.select-value-color-brown { background-color: rgba(210, 162, 141, 0.35); }
.select-value-color-orange { background-color: rgba(224, 124, 57, 0.27); }
.select-value-color-yellow { background-color: rgba(236, 191, 66, 0.39); }
.select-value-color-green { background-color: rgba(123, 183, 129, 0.27); }
.select-value-color-blue { background-color: rgba(93, 165, 206, 0.27); }
.select-value-color-purple { background-color: rgba(168, 129, 197, 0.27); }
.select-value-color-pink { background-color: rgba(225, 136, 179, 0.27); }
.select-value-color-red { background-color: rgba(244, 171, 159, 0.4); }

.checkbox {
	display: inline-flex;
	vertical-align: text-bottom;
	width: 16;
	height: 16;
	background-size: 16px;
	margin-left: 2px;
	margin-right: 5px;
}

.checkbox-on {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
}

.checkbox-off {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
}
	
</style></head><body><article id="1945b2cc-075b-80a3-a7f4-d52c96cb52af" class="page sans"><header><h1 class="page-title"><strong>Investigating with ELK 101</strong></h1><p class="page-description"></p></header><div class="page-body"><p id="1945b2cc-075b-80c0-a080-e67f7cd61730" class="">A US-based company <code><strong>CyberT</strong></code> has been monitoring the VPN logs of the employees, and the SOC team detected some anomalies in the VPN activities. Our task as SOC Analysts is to examine the VPN logs for January 2022 and identify the anomalies. Some of the key points to note before the investigation are:</p><ul id="1945b2cc-075b-8057-b911-e35d369520bb" class="bulleted-list"><li style="list-style-type:disc">All VPN logs are being ingested into the index <code><strong>vpn_connections</strong></code>.</li></ul><ul id="1945b2cc-075b-804d-9f81-e380f15bd664" class="bulleted-list"><li style="list-style-type:disc">The index contains the VPN logs for January 2022.</li></ul><ul id="1945b2cc-075b-8083-acb9-e11e376514d2" class="bulleted-list"><li style="list-style-type:disc">A user <code><strong>Johny Brown</strong></code> was terminated on 1st January 2022.</li></ul><ul id="1945b2cc-075b-807e-aa48-ea7b5e49a3c1" class="bulleted-list"><li style="list-style-type:disc">We observed failed connection attempts against some users that need to be investigated</li></ul><p id="1945b2cc-075b-8064-af0b-c8a4840fb9b0" class="">
</p><figure id="1945b2cc-075b-801d-a8b9-ed8921863a4b" class="image"><a href="image%20327.png"><img style="width:708.6792602539062px" src="image%20327.png"/></a></figure><p id="1945b2cc-075b-80d4-9e11-c421c75fcea9" class="">
</p><p id="1945b2cc-075b-8046-be92-fa70ee9b6a3f" class=""><strong>KQL (Kibana Query Language)</strong> is a search query language used to search the ingested logs/documents in the elasticsearch. Apart from the KQL language, Kibana also supports <strong>Lucene Query Language</strong>. We can disable the KQL query as shown below.</p><figure id="1945b2cc-075b-80f4-86e1-fc81c9f70bd1" class="image"><a href="https://tryhackme-images.s3.amazonaws.com/user-uploads/5e8dd9a4a45e18443162feab/room-content/3327ee49838ed3b50aa9ffca5295b271.png"><img src="https://tryhackme-images.s3.amazonaws.com/user-uploads/5e8dd9a4a45e18443162feab/room-content/3327ee49838ed3b50aa9ffca5295b271.png"/></a></figure><p id="1945b2cc-075b-805e-8677-f3464b1432a8" class="">In this task, we will be exploring KQL syntax. With KQL, we can search for the logs in two different ways.</p><ul id="1945b2cc-075b-8007-8ee4-ebb27aeb3e8c" class="bulleted-list"><li style="list-style-type:disc">Free text search</li></ul><ul id="1945b2cc-075b-8061-8731-f739fc538411" class="bulleted-list"><li style="list-style-type:disc">Field-based search</li></ul><p id="1945b2cc-075b-8020-915a-f615b502aea0" class=""><strong>Free text Search</strong></p><p id="1945b2cc-075b-80fb-ad66-d6a23de7e84c" class="">Free text search allows users to search for the logs based on the <strong>text-only</strong>. That means a simple search of the term <code>security</code> will return all the documents that contain this term, irrespective of the field.</p><p id="1945b2cc-075b-8076-8b5f-cd926e765404" class="">Let us look at the index, which includes the VPN logs. One of the fields <code>Source_Country</code> has the list of countries from where the VPN connections originated, as shown below.</p><figure id="1945b2cc-075b-8003-b451-e595bbd46486" class="image"><a href="https://tryhackme-images.s3.amazonaws.com/user-uploads/5e8dd9a4a45e18443162feab/room-content/5563237bfda366e4aee6572cf206b92c.png"><img src="https://tryhackme-images.s3.amazonaws.com/user-uploads/5e8dd9a4a45e18443162feab/room-content/5563237bfda366e4aee6572cf206b92c.png"/></a></figure><p id="1945b2cc-075b-80aa-b0e9-dc805316d090" class="">Let&#x27;s search for the text <code><strong>United States</strong></code> in the search bar to return all the logs that contain this term regardless of the place or the field. This search returned 2304 hits, as shown below.</p><figure id="1945b2cc-075b-807e-b355-e5ee270a0fa7" class="image"><a href="https://tryhackme-images.s3.amazonaws.com/user-uploads/5e8dd9a4a45e18443162feab/room-content/beb9f3912904e689952027ced1475755.png"><img src="https://tryhackme-images.s3.amazonaws.com/user-uploads/5e8dd9a4a45e18443162feab/room-content/beb9f3912904e689952027ced1475755.png"/></a></figure><p id="1945b2cc-075b-80ee-af16-e6da101d3d40" class="">What if we only search for the term <code>United</code> Will it return any result?</p><figure id="1945b2cc-075b-8021-8a44-db7c16650b99" class="image"><a href="https://tryhackme-images.s3.amazonaws.com/user-uploads/5e8dd9a4a45e18443162feab/room-content/a4cbeb5fe4b5507762c0f3a7bfaf43ca.png"><img src="https://tryhackme-images.s3.amazonaws.com/user-uploads/5e8dd9a4a45e18443162feab/room-content/a4cbeb5fe4b5507762c0f3a7bfaf43ca.png"/></a></figure><p id="1945b2cc-075b-8090-ae7d-cba5b061b63d" class="">It didn&#x27;t return any result because KQL looks for the whole term/word in the documents.</p><p id="1945b2cc-075b-80b6-9f14-f2b9fc491131" class=""><strong>WILD CARD</strong></p><p id="1945b2cc-075b-80fc-aac5-c526386e0565" class="">KQL allows the wild card <code>*</code> to match parts of the term/word. Let&#x27;s find out how to use this wild card in the search query.</p><p id="1945b2cc-075b-8002-9ae2-d960301b6bd4" class=""><strong>Search Query:</strong> <code>United*</code></p><figure id="1945b2cc-075b-80f8-b8b6-f4fd9df22def" class="image"><a href="https://tryhackme-images.s3.amazonaws.com/user-uploads/5e8dd9a4a45e18443162feab/room-content/e4ce12cedbed2b6c7d5519d49a000881.png"><img src="https://tryhackme-images.s3.amazonaws.com/user-uploads/5e8dd9a4a45e18443162feab/room-content/e4ce12cedbed2b6c7d5519d49a000881.png"/></a></figure><p id="1945b2cc-075b-801e-9564-d765ad2ca950" class="">We have used the wildcard with the term <strong>United</strong> to return all the results containing the term United and any other term. If we had logs with the term <code>United Nations</code>It would also have returned those as a result of this wildcard.</p><p id="1945b2cc-075b-807b-97cf-c65f1ac375d2" class=""><strong>Logical Operators (AND | OR | NOT)</strong></p><p id="1945b2cc-075b-802e-b921-c06e6bcf951f" class="">KQL also allows users to utilize the logical operators in the search query. Let us see the examples below.</p><p id="1945b2cc-075b-804d-9491-e37987b6f157" class=""><strong>1- OR Operator</strong></p><p id="1945b2cc-075b-80e2-a39f-ee2aed3cd5c3" class="">We will use the <strong>OR</strong> operator to show logs that contain either the <strong>United States</strong> or <strong>England</strong>.</p><p id="1945b2cc-075b-802e-8002-d22923b5475c" class=""><strong>Search Query:</strong> <code>&quot;United States&quot;    </code><code><strong>OR</strong></code><code>     &quot;England&quot;</code></p><figure id="1945b2cc-075b-8004-a387-f89e24d9b20d" class="image"><a href="https://tryhackme-images.s3.amazonaws.com/user-uploads/5e8dd9a4a45e18443162feab/room-content/3397dcf2455056e7cab5a14a4fe28c45.png"><img src="https://tryhackme-images.s3.amazonaws.com/user-uploads/5e8dd9a4a45e18443162feab/room-content/3397dcf2455056e7cab5a14a4fe28c45.png"/></a></figure><p id="1945b2cc-075b-802c-974b-fcc503d9bdf3" class=""><strong>2- AND Operator</strong></p><p id="1945b2cc-075b-8081-ad35-e41418d13b4c" class="">Here, we will use <strong>AND</strong> Operator to create a search that will return the logs that contain the terms &quot;<strong>UNITED STATES</strong>&quot; AND &quot;<strong>Virginia</strong>.&quot;</p><p id="1945b2cc-075b-80e8-b1db-e3dbc5153430" class=""><strong>Search Query: </strong><code>&quot;United States&quot; </code><code><strong>AND</strong></code><code> &quot;Virginia&quot;</code></p><figure id="1945b2cc-075b-80e7-95d9-e51db3deabe1" class="image"><a href="https://tryhackme-images.s3.amazonaws.com/user-uploads/5e8dd9a4a45e18443162feab/room-content/18302e0059d525f30f5627af20f309c9.png"><img src="https://tryhackme-images.s3.amazonaws.com/user-uploads/5e8dd9a4a45e18443162feab/room-content/18302e0059d525f30f5627af20f309c9.png"/></a></figure><p id="1945b2cc-075b-803a-9b97-ed04cfbb19e0" class=""><strong>3- NOT Operator</strong></p><p id="1945b2cc-075b-8068-a94b-f99da98cc3fa" class="">Similarly, we can use <strong>NOT</strong> Operator to remove the particular term from the search results. This search query will show the logs from <strong>the United States</strong>, including all states but ignoring Florida.</p><p id="1945b2cc-075b-803c-a2d1-e37e7484a5c3" class=""><strong>Search Query:</strong> <code>&quot;United States&quot; </code><code><strong>AND NOT</strong></code><code> (&quot;Florida&quot;)</code></p><h1 id="1945b2cc-075b-8037-a102-ef79d130c13e" class=""></h1><figure id="1945b2cc-075b-809f-b83e-f734f5a2baa4" class="image"><a href="https://tryhackme-images.s3.amazonaws.com/user-uploads/5e8dd9a4a45e18443162feab/room-content/12ba759b11ceebb78375a61097e826b3.png"><img src="https://tryhackme-images.s3.amazonaws.com/user-uploads/5e8dd9a4a45e18443162feab/room-content/12ba759b11ceebb78375a61097e826b3.png"/></a></figure><p id="1945b2cc-075b-8091-966d-fdcd978cdd3c" class=""><strong>Field-based search</strong></p><p id="1945b2cc-075b-8010-bf05-da74bab6cb69" class="">In the Field-based search, we will provide the field name and the value we are looking for in the logs. This search has a special syntax as <code>FIELD : VALUE</code>. It uses a colon <code>:</code> as a separator between the field and the value. Let&#x27;s look at a few examples.</p><p id="1945b2cc-075b-80f4-b0b5-f67930ad083d" class=""><strong>Search Query:</strong> <code><strong>Source_ip</strong></code><code> : 238.163.231.224    </code><code><strong>AND     </strong></code><code>UserName</code><code><strong> </strong></code><code>: Suleman</code></p><p id="1945b2cc-075b-8004-8cc4-fa094fe48d11" class=""><strong>Explanation:</strong> We are telling Kibana to display all the documents in which the <strong>field</strong> <code>Source_ip</code> contains the value <code><strong>19.112.190.54</strong></code> and <code>UserName</code> as <code>Suleman</code> as shown below.</p><figure id="1945b2cc-075b-80e7-b9fd-f05607eadcb0" class="image"><a href="https://tryhackme-images.s3.amazonaws.com/user-uploads/5e8dd9a4a45e18443162feab/room-content/ffbf735277d98273d6229f4d9ee586bf.gif"><img src="https://tryhackme-images.s3.amazonaws.com/user-uploads/5e8dd9a4a45e18443162feab/room-content/ffbf735277d98273d6229f4d9ee586bf.gif"/></a></figure><p id="1945b2cc-075b-8043-8d88-c2159e33b9bb" class="">As we click on the search bar, we will be presented with all the available fields that we can use in our search query. To explore the other options of KQL, look at this official reference <a href="https://www.elastic.co/guide/en/kibana/7.17/kuery-query.html">https://www.elastic.co/guide/en/kibana/7.17/kuery-query.html</a></p></div></article><span class="sans" style="font-size:14px;padding-top:2em"></span></body></html>