<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>Windows Forensics 1</title><style>
/* cspell:disable-file */
/* webkit printing magic: print all background colors */
html {
	-webkit-print-color-adjust: exact;
}
* {
	box-sizing: border-box;
	-webkit-print-color-adjust: exact;
}

html,
body {
	margin: 0;
	padding: 0;
}
@media only screen {
	body {
		margin: 2em auto;
		max-width: 900px;
		color: rgb(55, 53, 47);
	}
}

body {
	line-height: 1.5;
	white-space: pre-wrap;
}

a,
a.visited {
	color: inherit;
	text-decoration: underline;
}

.pdf-relative-link-path {
	font-size: 80%;
	color: #444;
}

h1,
h2,
h3 {
	letter-spacing: -0.01em;
	line-height: 1.2;
	font-weight: 600;
	margin-bottom: 0;
}

.page-title {
	font-size: 2.5rem;
	font-weight: 700;
	margin-top: 0;
	margin-bottom: 0.75em;
}

h1 {
	font-size: 1.875rem;
	margin-top: 1.875rem;
}

h2 {
	font-size: 1.5rem;
	margin-top: 1.5rem;
}

h3 {
	font-size: 1.25rem;
	margin-top: 1.25rem;
}

.source {
	border: 1px solid #ddd;
	border-radius: 3px;
	padding: 1.5em;
	word-break: break-all;
}

.callout {
	border-radius: 3px;
	padding: 1rem;
}

figure {
	margin: 1.25em 0;
	page-break-inside: avoid;
}

figcaption {
	opacity: 0.5;
	font-size: 85%;
	margin-top: 0.5em;
}

mark {
	background-color: transparent;
}

.indented {
	padding-left: 1.5em;
}

hr {
	background: transparent;
	display: block;
	width: 100%;
	height: 1px;
	visibility: visible;
	border: none;
	border-bottom: 1px solid rgba(55, 53, 47, 0.09);
}

img {
	max-width: 100%;
}

@media only print {
	img {
		max-height: 100vh;
		object-fit: contain;
	}
}

@page {
	margin: 1in;
}

.collection-content {
	font-size: 0.875rem;
}

.column-list {
	display: flex;
	justify-content: space-between;
}

.column {
	padding: 0 1em;
}

.column:first-child {
	padding-left: 0;
}

.column:last-child {
	padding-right: 0;
}

.table_of_contents-item {
	display: block;
	font-size: 0.875rem;
	line-height: 1.3;
	padding: 0.125rem;
}

.table_of_contents-indent-1 {
	margin-left: 1.5rem;
}

.table_of_contents-indent-2 {
	margin-left: 3rem;
}

.table_of_contents-indent-3 {
	margin-left: 4.5rem;
}

.table_of_contents-link {
	text-decoration: none;
	opacity: 0.7;
	border-bottom: 1px solid rgba(55, 53, 47, 0.18);
}

table,
th,
td {
	border: 1px solid rgba(55, 53, 47, 0.09);
	border-collapse: collapse;
}

table {
	border-left: none;
	border-right: none;
}

th,
td {
	font-weight: normal;
	padding: 0.25em 0.5em;
	line-height: 1.5;
	min-height: 1.5em;
	text-align: left;
}

th {
	color: rgba(55, 53, 47, 0.6);
}

ol,
ul {
	margin: 0;
	margin-block-start: 0.6em;
	margin-block-end: 0.6em;
}

li > ol:first-child,
li > ul:first-child {
	margin-block-start: 0.6em;
}

ul > li {
	list-style: disc;
}

ul.to-do-list {
	padding-inline-start: 0;
}

ul.to-do-list > li {
	list-style: none;
}

.to-do-children-checked {
	text-decoration: line-through;
	opacity: 0.375;
}

ul.toggle > li {
	list-style: none;
}

ul {
	padding-inline-start: 1.7em;
}

ul > li {
	padding-left: 0.1em;
}

ol {
	padding-inline-start: 1.6em;
}

ol > li {
	padding-left: 0.2em;
}

.mono ol {
	padding-inline-start: 2em;
}

.mono ol > li {
	text-indent: -0.4em;
}

.toggle {
	padding-inline-start: 0em;
	list-style-type: none;
}

/* Indent toggle children */
.toggle > li > details {
	padding-left: 1.7em;
}

.toggle > li > details > summary {
	margin-left: -1.1em;
}

.selected-value {
	display: inline-block;
	padding: 0 0.5em;
	background: rgba(206, 205, 202, 0.5);
	border-radius: 3px;
	margin-right: 0.5em;
	margin-top: 0.3em;
	margin-bottom: 0.3em;
	white-space: nowrap;
}

.collection-title {
	display: inline-block;
	margin-right: 1em;
}

.page-description {
	margin-bottom: 2em;
}

.simple-table {
	margin-top: 1em;
	font-size: 0.875rem;
	empty-cells: show;
}
.simple-table td {
	height: 29px;
	min-width: 120px;
}

.simple-table th {
	height: 29px;
	min-width: 120px;
}

.simple-table-header-color {
	background: rgb(247, 246, 243);
	color: black;
}
.simple-table-header {
	font-weight: 500;
}

time {
	opacity: 0.5;
}

.icon {
	display: inline-block;
	max-width: 1.2em;
	max-height: 1.2em;
	text-decoration: none;
	vertical-align: text-bottom;
	margin-right: 0.5em;
}

img.icon {
	border-radius: 3px;
}

.user-icon {
	width: 1.5em;
	height: 1.5em;
	border-radius: 100%;
	margin-right: 0.5rem;
}

.user-icon-inner {
	font-size: 0.8em;
}

.text-icon {
	border: 1px solid #000;
	text-align: center;
}

.page-cover-image {
	display: block;
	object-fit: cover;
	width: 100%;
	max-height: 30vh;
}

.page-header-icon {
	font-size: 3rem;
	margin-bottom: 1rem;
}

.page-header-icon-with-cover {
	margin-top: -0.72em;
	margin-left: 0.07em;
}

.page-header-icon img {
	border-radius: 3px;
}

.link-to-page {
	margin: 1em 0;
	padding: 0;
	border: none;
	font-weight: 500;
}

p > .user {
	opacity: 0.5;
}

td > .user,
td > time {
	white-space: nowrap;
}

input[type="checkbox"] {
	transform: scale(1.5);
	margin-right: 0.6em;
	vertical-align: middle;
}

p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.image {
	border: none;
	margin: 1.5em 0;
	padding: 0;
	border-radius: 0;
	text-align: center;
}

.code,
code {
	background: rgba(135, 131, 120, 0.15);
	border-radius: 3px;
	padding: 0.2em 0.4em;
	border-radius: 3px;
	font-size: 85%;
	tab-size: 2;
}

code {
	color: #eb5757;
}

.code {
	padding: 1.5em 1em;
}

.code-wrap {
	white-space: pre-wrap;
	word-break: break-all;
}

.code > code {
	background: none;
	padding: 0;
	font-size: 100%;
	color: inherit;
}

blockquote {
	font-size: 1.25em;
	margin: 1em 0;
	padding-left: 1em;
	border-left: 3px solid rgb(55, 53, 47);
}

.bookmark {
	text-decoration: none;
	max-height: 8em;
	padding: 0;
	display: flex;
	width: 100%;
	align-items: stretch;
}

.bookmark-title {
	font-size: 0.85em;
	overflow: hidden;
	text-overflow: ellipsis;
	height: 1.75em;
	white-space: nowrap;
}

.bookmark-text {
	display: flex;
	flex-direction: column;
}

.bookmark-info {
	flex: 4 1 180px;
	padding: 12px 14px 14px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
}

.bookmark-image {
	width: 33%;
	flex: 1 1 180px;
	display: block;
	position: relative;
	object-fit: cover;
	border-radius: 1px;
}

.bookmark-description {
	color: rgba(55, 53, 47, 0.6);
	font-size: 0.75em;
	overflow: hidden;
	max-height: 4.5em;
	word-break: break-word;
}

.bookmark-href {
	font-size: 0.75em;
	margin-top: 0.25em;
}

.sans { font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
.code { font-family: "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; }
.serif { font-family: Lyon-Text, Georgia, ui-serif, serif; }
.mono { font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; }
.pdf .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK JP'; }
.pdf:lang(zh-CN) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC'; }
.pdf:lang(zh-TW) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK TC'; }
.pdf:lang(ko-KR) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK KR'; }
.pdf .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK JP'; }
.pdf:lang(zh-CN) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK SC'; }
.pdf:lang(zh-TW) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK TC'; }
.pdf:lang(ko-KR) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK KR'; }
.pdf .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.highlight-default {
	color: rgba(50, 48, 44, 1);
}
.highlight-gray {
	color: rgba(115, 114, 110, 1);
	fill: rgba(115, 114, 110, 1);
}
.highlight-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.highlight-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.highlight-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.highlight-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.highlight-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.highlight-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.highlight-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.highlight-red {
	color: rgba(205, 60, 58, 1);
	fill: rgba(205, 60, 58, 1);
}
.highlight-default_background {
	color: rgba(50, 48, 44, 1);
}
.highlight-gray_background {
	background: rgba(248, 248, 247, 1);
}
.highlight-brown_background {
	background: rgba(244, 238, 238, 1);
}
.highlight-orange_background {
	background: rgba(251, 236, 221, 1);
}
.highlight-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.highlight-teal_background {
	background: rgba(237, 243, 236, 1);
}
.highlight-blue_background {
	background: rgba(231, 243, 248, 1);
}
.highlight-purple_background {
	background: rgba(248, 243, 252, 1);
}
.highlight-pink_background {
	background: rgba(252, 241, 246, 1);
}
.highlight-red_background {
	background: rgba(253, 235, 236, 1);
}
.block-color-default {
	color: inherit;
	fill: inherit;
}
.block-color-gray {
	color: rgba(115, 114, 110, 1);
	fill: rgba(115, 114, 110, 1);
}
.block-color-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.block-color-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.block-color-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.block-color-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.block-color-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.block-color-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.block-color-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.block-color-red {
	color: rgba(205, 60, 58, 1);
	fill: rgba(205, 60, 58, 1);
}
.block-color-default_background {
	color: inherit;
	fill: inherit;
}
.block-color-gray_background {
	background: rgba(248, 248, 247, 1);
}
.block-color-brown_background {
	background: rgba(244, 238, 238, 1);
}
.block-color-orange_background {
	background: rgba(251, 236, 221, 1);
}
.block-color-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.block-color-teal_background {
	background: rgba(237, 243, 236, 1);
}
.block-color-blue_background {
	background: rgba(231, 243, 248, 1);
}
.block-color-purple_background {
	background: rgba(248, 243, 252, 1);
}
.block-color-pink_background {
	background: rgba(252, 241, 246, 1);
}
.block-color-red_background {
	background: rgba(253, 235, 236, 1);
}
.select-value-color-default { background-color: rgba(84, 72, 49, 0.08); }
.select-value-color-gray { background-color: rgba(84, 72, 49, 0.15); }
.select-value-color-brown { background-color: rgba(210, 162, 141, 0.35); }
.select-value-color-orange { background-color: rgba(224, 124, 57, 0.27); }
.select-value-color-yellow { background-color: rgba(236, 191, 66, 0.39); }
.select-value-color-green { background-color: rgba(123, 183, 129, 0.27); }
.select-value-color-blue { background-color: rgba(93, 165, 206, 0.27); }
.select-value-color-purple { background-color: rgba(168, 129, 197, 0.27); }
.select-value-color-pink { background-color: rgba(225, 136, 179, 0.27); }
.select-value-color-red { background-color: rgba(244, 171, 159, 0.4); }

.checkbox {
	display: inline-flex;
	vertical-align: text-bottom;
	width: 16;
	height: 16;
	background-size: 16px;
	margin-left: 2px;
	margin-right: 5px;
}

.checkbox-on {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
}

.checkbox-off {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
}
	
</style></head><body><article id="2375b2cc-075b-803d-9d6d-f4cbbf95b9b1" class="page sans"><header><div class="page-header-icon undefined"><img class="icon" src="https://tryhackme-images.s3.amazonaws.com/room-icons/4f3a37633c01bc4453668af0f2d3e7ef.png"/></div><h1 class="page-title">Windows Forensics 1</h1><p class="page-description"></p></header><div class="page-body"><h3 id="2375b2cc-075b-8000-bf98-fa8ac098d781" class="">🖥️ Computer Forensics Overview</h3><ul id="2375b2cc-075b-803c-a46d-fafdc86283bd" class="bulleted-list"><li style="list-style-type:disc">Computer forensics is part of <strong>digital forensics</strong>, focusing on gathering and analyzing digital evidence from computers.</li></ul><ul id="2375b2cc-075b-8029-8491-ed9fd5644f91" class="bulleted-list"><li style="list-style-type:disc">Applications range from <strong>legal investigations</strong> (civil/criminal cases) to <strong>corporate incidents</strong> and <strong>intrusion analysis</strong>.</li></ul><h3 id="2375b2cc-075b-8011-9211-f2df68e7696e" class="">🕵️‍♂️ Real-World Example</h3><ul id="2375b2cc-075b-805f-aa42-e3f7786e8084" class="bulleted-list"><li style="list-style-type:disc"><strong>BTK serial killer case</strong>: Solved using digital forensics—police traced a deleted Word document from a floppy disk to identify the culprit.</li></ul><h3 id="2375b2cc-075b-80e6-a224-c0cdb1c68a59" class="">💻 Windows &amp; Forensic Importance</h3><ul id="2375b2cc-075b-802e-b4bb-e11fe626e77e" class="bulleted-list"><li style="list-style-type:disc">Windows holds <strong>~80% of the desktop OS market</strong>, making it crucial for forensic study.</li></ul><ul id="2375b2cc-075b-808b-a762-cee6bd6cdf25" class="bulleted-list"><li style="list-style-type:disc">Investigators examine data from the <strong>Windows Registry</strong> to trace user activity.</li></ul><h3 id="2375b2cc-075b-805e-8245-c725ece68e5c" class="">🧩 What Are Forensic Artifacts?</h3><ul id="2375b2cc-075b-8046-83e8-f606674eabcf" class="bulleted-list"><li style="list-style-type:disc">Artifacts are <strong>traces of human activity</strong>, like digital fingerprints.</li></ul><ul id="2375b2cc-075b-805d-a704-e78fd44a60c8" class="bulleted-list"><li style="list-style-type:disc">On Windows, these include user preferences, app usage, and browser data—all stored across various system files.</li></ul><h3 id="2375b2cc-075b-809c-8900-ed07562a3e79" class="">👀 Is Your Computer Spying?</h3><ul id="2375b2cc-075b-805e-ae20-c320d51a9e46" class="bulleted-list"><li style="list-style-type:disc">Windows tracks user activity mainly to <strong>personalize the user experience</strong>, not to spy.</li></ul><ul id="2375b2cc-075b-80ed-926e-d6c922f948e6" class="bulleted-list"><li style="list-style-type:disc">However, this data is repurposed by forensic analysts during investigations.</li></ul><p id="2375b2cc-075b-8064-8834-da96a43745ae" class="">
</p><h2 id="2375b2cc-075b-8044-9fef-feb1a2626b8a" class=""><strong>Windows Registry: </strong></h2><p id="2385b2cc-075b-8034-ac61-f6f167a844b7" class="">
</p><p id="2375b2cc-075b-8092-ba2a-e9aeaf5eb690" class="">The Windows Registry is a collection of databases that contains the system&#x27;s configuration data. This configuration data can be about the hardware, the software, or the user&#x27;s information. It also includes data about the recently used files, programs used, or devices connected to the system. As you can understand, this data is beneficial from a forensics standpoint. Throughout this room, we will learn ways to read this data to identify the required information about the system. You can view the registry using regedit.exe, a built-in Windows utility to view and edit the registry. We&#x27;ll explore other tools to learn about the registry in the upcoming tasks.</p><p id="2375b2cc-075b-8043-a301-c38ce41bf17d" class="">The Windows registry consists of Keys and Values. When you open the regedit.exe utility to view the registry, the folders you see are Registry Keys. Registry Values are the data stored in these Registry Keys. A <a href="https://docs.microsoft.com/en-us/windows/win32/sysinfo/registry-hives#:~:text=Registry%20Hives.%20A%20hive%20is%20a%20logical%20group,with%20a%20separate%20file%20for%20the%20user%20profile.">Registry Hive </a> is a group of Keys, subkeys, and values stored in a single file on the disk.</p><p id="2375b2cc-075b-809a-8a1b-f96361edd4c1" class=""><strong>Structure of the Registry: </strong></p><p id="2375b2cc-075b-8043-acdd-c353944e7a7b" class="">The registry on any Windows system contains the following five root keys:</p><ol type="1" id="2375b2cc-075b-809d-8f70-c300b7ad5083" class="numbered-list" start="1"><li>HKEY_CURRENT_USER</li></ol><ol type="1" id="2375b2cc-075b-80db-87b0-efbc5b40ea18" class="numbered-list" start="2"><li>HKEY_USERS</li></ol><ol type="1" id="2375b2cc-075b-80df-9278-ffb3c2f21e29" class="numbered-list" start="3"><li>HKEY_LOCAL_MACHINE</li></ol><ol type="1" id="2375b2cc-075b-8006-a3c6-fb01d5f25084" class="numbered-list" start="4"><li>HKEY_CLASSES_ROOT</li></ol><ol type="1" id="2375b2cc-075b-80ec-8e71-dea74311fe78" class="numbered-list" start="5"><li>HKEY_CURRENT_CONFIG</li></ol><p id="2375b2cc-075b-80ae-ab48-d947e203be77" class="">You can view these keys when you open the <code>regedit.exe</code>utility. To open the registry editor, press the Windows key and the R key simultaneously. It will open a <code>run</code>prompt that looks like this:</p><figure id="2375b2cc-075b-8083-8a17-d0b485528072" class="image"><a href="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/9d33389f2fd0445a63e75dce3f6d7a88.png"><img style="width:261px" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/9d33389f2fd0445a63e75dce3f6d7a88.png"/></a></figure><p id="2375b2cc-075b-8032-8355-cb710252f7d3" class="">In this prompt, type <code>regedit.exe</code>, and you will be greeted with the registry editor window. It will look something like this:</p><figure id="2375b2cc-075b-807e-be32-f87948d4c8d1" class="image"><a href="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/e14ef3193fce1f4b35c37a96862d71da.png"><img style="width:700px" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/e14ef3193fce1f4b35c37a96862d71da.png"/></a></figure><p id="2375b2cc-075b-8011-a7ee-c0bebdf2b744" class="">Here you can see the root keys in the left pane in a tree view that shows the included registry keys, and the values in the selected key are shown in the right pane. You can right-click on the value shown in the right pane and select properties to view the properties of this value.</p><p id="2375b2cc-075b-80d1-80c1-c9a45b7f7912" class="">Here is how Microsoft defines each of these root keys. For more detail and information about the following Windows registry keys, please visit  <a href="https://docs.microsoft.com/en-US/troubleshoot/windows-server/performance/windows-registry-advanced-users">Microsoft&#x27;s documentation </a>.</p><p id="2385b2cc-075b-8015-994c-dc771d65f3b3" class="">
</p><figure id="2385b2cc-075b-800b-98b3-ce4f9a3803d3" class="image"><a href="assets/image%20270.png"><img style="width:710px" src="assets/image%20270.png"/></a></figure><h2 id="2385b2cc-075b-8052-8393-cca8d9068ec5" class=""><strong>Accessing registry hives offline</strong></h2><p id="2385b2cc-075b-8098-a1f9-d391e9678ff6" class="">If you are accessing a live system, you will be able to access the registry using regedit.exe, and you will be greeted with all of the standard root keys we learned about in the previous task. However, if you only have access to a disk image, you must know where the registry hives are located on the disk. The majority of these hives are located in the <code>C:\Windows\System32\Config</code> directory and are:</p><ol type="1" id="2385b2cc-075b-8070-b7e8-ef6c64d558a1" class="numbered-list" start="1"><li><strong>DEFAULT </strong>(mounted on <code>HKEY_USERS\DEFAULT</code>)</li></ol><ol type="1" id="2385b2cc-075b-80c6-808e-c920d2a4da48" class="numbered-list" start="2"><li><strong>SAM </strong>(mounted on <code>HKEY_LOCAL_MACHINE\SAM</code>)</li></ol><ol type="1" id="2385b2cc-075b-8053-b73f-cd381e3a91d7" class="numbered-list" start="3"><li><strong>SECURITY </strong>(mounted on <code>HKEY_LOCAL_MACHINE\Security</code>)</li></ol><ol type="1" id="2385b2cc-075b-8008-ae0e-c506a5d7238d" class="numbered-list" start="4"><li><strong>SOFTWARE </strong>(mounted on <code>HKEY_LOCAL_MACHINE\Software</code>)</li></ol><ol type="1" id="2385b2cc-075b-806d-bc2d-e3600b1eac2e" class="numbered-list" start="5"><li><strong>SYSTEM </strong>(mounted on <code>HKEY_LOCAL_MACHINE\System</code>)</li></ol><p id="2385b2cc-075b-80e0-a61a-c76f8cf1124f" class=""><strong>Hives containing user information:</strong></p><p id="2385b2cc-075b-80e7-92b0-dc8168407580" class="">Apart from these hives, two other hives containing user information can be found in the User profile directory. For Windows 7 and above, a user’s profile directory is located in <code>C:\Users\&lt;username&gt;\</code> where the hives are:</p><ol type="1" id="2385b2cc-075b-8097-a1a5-efbeab032966" class="numbered-list" start="1"><li><strong>NTUSER.DAT</strong> (mounted on HKEY_CURRENT_USER when a user logs in)</li></ol><ol type="1" id="2385b2cc-075b-8062-b8b6-f24785ae2569" class="numbered-list" start="2"><li><strong>USRCLASS.DAT</strong> (mounted on HKEY_CURRENT_USER\Software\CLASSES)</li></ol><p id="2385b2cc-075b-803b-a688-d56885efb66c" class="">The USRCLASS.DAT hive is located in the directory <code>C:\Users\&lt;username&gt;\AppData\Local\Microsoft\Windows</code>.</p><figure id="2385b2cc-075b-80ae-b9b2-e610e4f3cfe6" class="image"><a href="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/3ffadf20ebe241040d659958db115c2f.png"><img src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/3ffadf20ebe241040d659958db115c2f.png"/></a></figure><p id="2385b2cc-075b-8091-be77-e5e1799584c8" class="">The NTUSER.DAT hive is located in the directory <code>C:\Users\&lt;username&gt;\</code>.</p><figure id="2385b2cc-075b-8077-b693-e247bf3509ab" class="image"><a href="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/f3091f38f680b418f89cf79128d1933c.png"><img src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/f3091f38f680b418f89cf79128d1933c.png"/></a></figure><p id="2385b2cc-075b-80ad-88f5-d7c531f06529" class="">Remember that NTUSER.DAT and USRCLASS.DAT are hidden files.</p><h3 id="2385b2cc-075b-80d8-a27d-f26d11c87078" class=""><strong>The Amcache Hive:</strong></h3><p id="2385b2cc-075b-806b-9ca6-c8c3d96e5b17" class="">Apart from these files, there is another very important hive called the AmCache hive. This hive is located in <code>C:\Windows\AppCompat\Programs\Amcache.hve</code>. Windows creates this hive to save information on programs that were recently run on the system.</p><h3 id="2385b2cc-075b-801b-8bb9-da4b9cf2a12e" class=""><strong>Transaction Logs and Backups:</strong></h3><p id="2385b2cc-075b-80a6-a2e3-cb06c6cff496" class="">Some other very vital sources of forensic data are the registry transaction logs and backups. The transaction logs can be considered as the journal of the changelog of the registry hive. Windows often uses transaction logs when writing data to registry hives. This means that the transaction logs can often have the latest changes in the registry that haven&#x27;t made their way to the registry hives themselves. The transaction log for each hive is stored as a .LOG file in the same directory as the hive itself. It has the same name as the registry hive, but the extension is .LOG. For example, the transaction log for the SAM hive will be located in <code>C:\Windows\System32\Config</code> in the filename SAM.LOG. Sometimes there can be multiple transaction logs as well. In that case, they will have .LOG1, .LOG2 etc., as their extension. It is prudent to look at the transaction logs as well when <br/>performing registry forensics.</p><p id="2385b2cc-075b-80cc-bd8e-e7bb2023f4cf" class="">Registry backups are the opposite of Transaction logs. These are the backups of the registry hives located in the <code>C:\Windows\System32\Config</code> directory. These hives are copied to the <code>C\Windows\System32\Config\RegBack =</code>directory every ten days. It might be an excellent place to look if you suspect that some registry keys might have been deleted/modified recently.</p><p id="2385b2cc-075b-805b-9c93-ec4161b95e95" class="">
</p><h2 id="2385b2cc-075b-8098-bf4a-efc24f068097" class="">Data Acquisition</h2><p id="2385b2cc-075b-80aa-ba0c-c434369f4520" class="">When performing forensics, we will either encounter a live system or an image taken of the system. For the sake of accuracy, it is recommended practice to image the system or make a copy of the required data and perform forensics on it. This process is called data acquisition. Below we discuss different ways to acquire registry data from a live system or a disk image:</p><p id="2385b2cc-075b-8022-a478-eaf7dad7da0f" class="">Though we can view the registry through the registry editor, the forensically correct method is to acquire a copy of this data and perform analysis on that. However, when we go to copy the registry hives from <code>%WINDIR%\System32\Config</code> we cannot because it is a restricted file. So, what to do now?</p><p id="2385b2cc-075b-804b-876a-fb55d02108f4" class="">For acquiring these files, we can use one of the following tools:</p><p id="2385b2cc-075b-80ea-b09c-f2bc46bb45b4" class=""><strong>KAPE:</strong></p><p id="2385b2cc-075b-8012-80c7-ff22a1f60123" class=""><a href="https://www.kroll.com/en/services/cyber-risk/incident-response-litigation-support/kroll-artifact-parser-extractor-kape">KAPE </a>is a live data acquisition and analysis tool which can be used to acquire registry data. It is primarily a command-line tool but also comes with a GUI. The below screenshot shows what the KAPE GUI looks like. We have already selected all the settings to extract the registry data using KAPE in this screenshot. We will learn more about collecting forensic artifacts using KAPE in a dedicated KAPE room.</p><figure id="2385b2cc-075b-80d9-ace1-d2414e364c33" class="image"><a href="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/48b9656c4037d0537bf517d6084517a8.png"><img src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/48b9656c4037d0537bf517d6084517a8.png"/></a></figure><p id="2385b2cc-075b-80dd-b68e-d370938c7f91" class=""><strong>Autopsy:</strong></p><p id="2385b2cc-075b-80b9-a50c-feb24a7b6c18" class=""><a href="https://www.autopsy.com/">Autopsy </a> gives you the option to acquire data from both live systems or from a disk image. After adding your data source, navigate to the location of the files you want to extract, then right-click and select the Extract File(s) option. It will look similar to what you see in the screenshot <br/>below.</p><figure id="2385b2cc-075b-80b1-adc3-f04d4d331435" class="image"><a href="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/5faf350078f7e7e1d1400f46e11e74a9.png"><img style="width:700px" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/5faf350078f7e7e1d1400f46e11e74a9.png"/></a></figure><p id="2385b2cc-075b-80ab-9358-e698de0e0bf4" class=""><strong>FTK Imager:</strong></p><p id="2385b2cc-075b-80bc-b837-f4b0258c2de8" class=""><a href="https://www.exterro.com/ftk-imager">FTK Imager </a> is similar to Autopsy and allows you to extract files from a disk image or a live system by mounting the said disk image or drive in FTK Imager. Below you can see the option to Export files as highlighted in the screenshot.</p><figure id="2385b2cc-075b-8028-bffd-e894824be749" class="image"><a href="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/08b1f97dd47b33c4261fb362d49ac929.png"><img src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/08b1f97dd47b33c4261fb362d49ac929.png"/></a></figure><p id="2385b2cc-075b-80d6-9bc5-cad7e08e26b5" class="">Another way you can extract Registry files from FTK Imager is through the Obtain Protected Files option. This option is only available for live systems and is highlighted in the screenshot below. This option allows you to extract all the registry hives to a location of your <br/>choosing. However, it will not copy the <code>Amcache.hve</code>file, which is often necessary to investigate evidence of programs that were last executed.</p><figure id="2385b2cc-075b-8051-96be-e3d434e9a186" class="image"><a href="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/6aa5e6825bb003dc803106d5f70e155c.png"><img src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/6aa5e6825bb003dc803106d5f70e155c.png"/></a></figure><p id="2385b2cc-075b-806f-89c5-d2a8e5efb05d" class="">
</p><h3 id="2385b2cc-075b-8059-8cf3-d2a6f2025f3d" class=""><strong>Exploring Windows Registry</strong></h3><p id="2385b2cc-075b-8015-97b4-fb03a120aebe" class="">Once we have extracted the registry hives, we need a tool to view these files as we would in the registry editor. Since the registry editor only works with live systems and can&#x27;t load exported hives, we can use the following tools:</p><p id="2385b2cc-075b-8037-936e-c36bac07df9e" class=""><strong>Registry Viewer:</strong></p><p id="2385b2cc-075b-8068-9740-cd042a96b1f4" class="">As we can see in the screenshot below, <a href="https://accessdata.com/product-download/registry-viewer-2-0-0">AccessData&#x27;s Registry Viewer </a> has a similar user interface to the Windows Registry Editor. There are a couple of limitations, though. It only loads one hive at a time, and it can&#x27;t take the transaction logs into account.</p><figure id="2385b2cc-075b-8081-9e2a-cb2f931eb33d" class="image"><a href="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/888afb265fa265d771dc02ae8f610dc0.png"><img style="width:700px" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/888afb265fa265d771dc02ae8f610dc0.png"/></a></figure><p id="2385b2cc-075b-8043-b744-e8639b0b5de5" class=""><strong>Zimmerman&#x27;s Registry Explorer:</strong></p><p id="2385b2cc-075b-80ab-873f-da3db631093b" class="">Eric Zimmerman has developed a handful of <a href="https://ericzimmerman.github.io/#!index.md">tools </a> that are very useful for performing Digital Forensics and Incident Response. One of them is the Registry Explorer. It looks like the below <br/>screenshot. It can load multiple hives simultaneously and add data from transaction logs into the hive to make a more &#x27;cleaner&#x27; hive with more up-to-date data. It also has a handy &#x27;Bookmarks&#x27; option containing forensically important registry keys often sought by forensics <br/>investigators. Investigators can go straight to the interesting registry keys and values with the bookmarks menu item. We will explore these in more detail in the upcoming tasks.</p><figure id="2385b2cc-075b-80bf-ad96-d7eabb23ac7b" class="image"><a href="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/414dee2639b9456334c9580aacdc2be1.png"><img style="width:700px" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/414dee2639b9456334c9580aacdc2be1.png"/></a></figure><p id="2385b2cc-075b-807a-9b30-fd6620b2b919" class=""><strong> RegRipper:</strong></p><p id="2385b2cc-075b-8050-8eaa-dc4bd94a6a59" class=""><a href="https://github.com/keydet89/RegRipper3.0">RegRipper </a>is a utility that takes a registry hive as input and outputs a report that extracts data from some of the forensically important keys and values in that hive. The output report is in a text file and shows all the results in sequential order.</p><p id="2385b2cc-075b-80f1-831c-d1e4de011684" class="">RegRipper is available in both a CLI and GUI form which is shown in the screenshot below.</p><figure id="2385b2cc-075b-8057-8fce-e121098a9af7" class="image"><a href="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/70e6fef3920cb9b0443bc1fa9d9fac5d.png"><img src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/70e6fef3920cb9b0443bc1fa9d9fac5d.png"/></a></figure><p id="2385b2cc-075b-80a0-ba21-f540dee61053" class="">One shortcoming of RegRipper is that it does not take the transaction logs into account. We must use Registry Explorer to merge transaction logs with the respective registry hives before sending the output to RegRipper for a more accurate result.</p><p id="2385b2cc-075b-80de-a2e5-e86aaee17064" class="">Even though we have discussed these different tools, for the purpose of this room, we will only be using Registry Explorer and some of Eric Zimmerman&#x27;s tools.</p><p id="2385b2cc-075b-8096-a50c-e15db0f5fe4e" class="">
</p><h2 id="2385b2cc-075b-80c6-b88d-edefcfb0f291" class="">System Information and System Accounts</h2><p id="2385b2cc-075b-800f-b1c5-d3626de9192a" class="">Now that we have learned how to read registry data, let&#x27;s find out where to look in the registry to <br/>perform our forensic analysis.</p><p id="2385b2cc-075b-803a-9887-e0f18a98328f" class="">When we start performing forensic analysis, the first step is to find out about the system information. This task will cover gathering information related to a machine&#x27;s System and Account information.</p><p id="2385b2cc-075b-8021-a247-d68cba12d866" class=""><strong>OS Version: </strong></p><p id="2385b2cc-075b-80db-b2de-e8f8befd0d53" class="">If we only have triage data to perform forensics, we can determine the OS version from which this data was pulled through the registry. To find the OS version, we can use the following registry key:</p><p id="2385b2cc-075b-80c6-a357-d1f942300bf6" class=""><code>SOFTWARE\Microsoft\Windows NT\CurrentVersion</code></p><p id="2385b2cc-075b-8035-8d84-dbbd4e3fb85a" class="">This is how Registry Explorer shows this registry key. Take a look and answer Question # 1.</p><figure id="2385b2cc-075b-8051-9e45-fe6d6f7ae3ed" class="image"><a href="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/1362c5a15d1879a1a5a5a5237a426108.png"><img src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/1362c5a15d1879a1a5a5a5237a426108.png"/></a></figure><p id="2385b2cc-075b-8021-99e9-eff2e3e8a4c0" class=""><strong>Current control set: </strong></p><p id="2385b2cc-075b-80a1-bf20-e1a8488c0120" class="">The hives containing the machine’s configuration data used for controlling system startup are called Control Sets. Commonly, we will see two Control Sets, ControlSet001 and ControlSet002, in the SYSTEM hive on a machine. In most cases (but not always), ControlSet001 will <br/>point to the Control Set that the machine booted with, and ControlSet002 will be the <code>last known good</code> configuration. Their locations will be:</p><p id="2385b2cc-075b-8097-a6ee-f152b54bff4b" class=""><code>SYSTEM\ControlSet001 </code>&amp;<code> SYSTEM\ControlSet002</code></p><p id="2385b2cc-075b-80e7-a272-ce8c9da9a5db" class="">Windows creates a volatile Control Set when the machine is live, called the CurrentControlSet ( <code>HKLM\SYSTEM\CurrentControlSet</code>). For getting the most accurate system information, this is <br/>the hive that we will refer to. We can find out which Control Set is being used as the CurrentControlSet by looking at the following registry value:</p><p id="2385b2cc-075b-80e9-b5ab-fccf8557271b" class=""><code>SYSTEM\Select\Current</code></p><p id="2385b2cc-075b-8099-9452-da63cb97df59" class="">Similarly, the <code>last known good</code> configuration can be found using the following registry value:</p><p id="2385b2cc-075b-806d-a43d-dde021a0dd3c" class=""><code>SYSTEM\Select\LastKnownGood</code></p><p id="2385b2cc-075b-80c4-8bf9-fa9f80c2fec6" class="">This is how it looks like in Registry Explorer. Take a look and answer Question # 2.</p><figure id="2385b2cc-075b-8076-a15b-d37726b59c7e" class="image"><a href="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/f3b34b5e44e98e76034b76fc608a7670.png"><img src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/f3b34b5e44e98e76034b76fc608a7670.png"/></a></figure><p id="2385b2cc-075b-804e-a2fe-f30de79e01fe" class="">It is vital to establish this information before moving forward with the analysis. As we will see, many forensic artifacts we collect will be collected from the Control Sets.</p><p id="2385b2cc-075b-80df-8644-d89b108fb07c" class=""><strong>Computer Name: </strong></p><p id="2385b2cc-075b-8075-b99f-e453285472be" class="">It is crucial to establish the Computer Name while performing forensic analysis to ensure that we are working on the machine we are supposed to work on. We can find the Computer Name from the following location:</p><p id="2385b2cc-075b-8087-ba99-e99dab0f67dd" class=""><code>SYSTEM\CurrentControlSet\Control\ComputerName\ComputerName</code></p><p id="2385b2cc-075b-803d-ad86-f94a6cfa5573" class="">Registry Explorer shows it like this. Take a look and answer Question # 3:</p><figure id="2385b2cc-075b-808b-b625-d03c3b72b6ee" class="image"><a href="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/bb73d7942a6e30cb96e78926ad36fddb.png"><img src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/bb73d7942a6e30cb96e78926ad36fddb.png"/></a></figure><p id="2385b2cc-075b-80a8-a1c0-d31c9d31ea08" class=""><strong>Time Zone Information: </strong></p><p id="2385b2cc-075b-80a0-866d-f262b5e476c4" class="">For accuracy, it is important to establish what time zone the computer is located in. This will help us understand the chronology of the events as they happened. For finding the Time Zone Information, we can look at the following location:</p><p id="2385b2cc-075b-8014-b261-c26f7b5768a3" class=""><code>SYSTEM\CurrentControlSet\Control\TimeZoneInformation</code></p><p id="2385b2cc-075b-80de-a271-fe72d86d2ed4" class="">Here&#x27;s how it looks in Registry Explorer. Take a look and answer Question # 4.</p><figure id="2385b2cc-075b-808a-971d-f9a900ac52a5" class="image"><a href="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/08d5e86bb3a5be6057928a8062cf7de3.png"><img style="width:700px" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/08d5e86bb3a5be6057928a8062cf7de3.png"/></a></figure><p id="2385b2cc-075b-80f4-9f0e-dee3606b4b80" class="">Time Zone Information is important because some data in the computer will have their timestamps in UTC/GMT and others in the local time zone. Knowledge of the local time zone helps in establishing a timeline when merging data from all the sources.</p><p id="2385b2cc-075b-8076-89c5-f8308d443592" class=""><strong>Network Interfaces and Past Networks: </strong></p><p id="2385b2cc-075b-80f4-8792-e8a9288b460b" class="">The following registry key will give a list of network interfaces on the machine we are investigating:</p><p id="2385b2cc-075b-80aa-b186-ee98c82262fd" class=""><code>SYSTEM\CurrentControlSet\Services\Tcpip\Parameters\Interfaces</code></p><p id="2385b2cc-075b-806e-9019-fc7c40be2b27" class="">Take a look at this registry key as shown in Registry Explorer and answer Question # 5.</p><figure id="2385b2cc-075b-80cd-8b71-d472d11e1bbb" class="image"><a href="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/7f0ed33ad442f22ec9475488d6af4421.png"><img style="width:700px" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/7f0ed33ad442f22ec9475488d6af4421.png"/></a></figure><p id="2385b2cc-075b-80cf-aaeb-d9f25c1d3629" class="">Each Interface is represented with a unique identifier (GUID) subkey, which contains values relating to the interface’s TCP/IP configuration. This key will provide us with information like IP addresses, DHCP IP address and Subnet Mask, DNS Servers, and more. This information is significant because it helps you make sure that you are performing forensics on the machine that you are supposed to perform it on.</p><p id="2385b2cc-075b-80ac-95b7-cc1e81a8d383" class="">The past networks a given machine was connected to can be found in the following locations:</p><p id="2385b2cc-075b-808a-bfeb-c236fc07a21d" class=""><code>SOFTWARE\Microsoft\Windows NT\CurrentVersion\NetworkList\Signatures\Unmanaged</code></p><p id="2385b2cc-075b-8010-8aa7-d3dbf6f4df0c" class=""><code>SOFTWARE\Microsoft\Windows NT\CurrentVersion\NetworkList\Signatures\Managed</code></p><figure id="2385b2cc-075b-805c-add3-faa5a849e545" class="image"><a href="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/fae511770c0ac57458073992ef221251.png"><img src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/fae511770c0ac57458073992ef221251.png"/></a></figure><p id="2385b2cc-075b-80d4-8732-e84a7a9479ba" class="">These registry keys contain past networks as well as the last time they were connected. The last write time of the registry key points to the last time these networks were connected.</p><p id="2385b2cc-075b-800c-a8c8-eb3fa9263708" class=""><strong>Autostart Programs (Autoruns): </strong></p><p id="2385b2cc-075b-8082-a2e5-da51397dde91" class="">The following registry keys include information about programs or commands that run when a user logs on.</p><p id="2385b2cc-075b-80fa-a5b0-f67d2cbf84e2" class=""><code>NTUSER.DAT\Software\Microsoft\Windows\CurrentVersion\Run</code></p><p id="2385b2cc-075b-801e-af8b-c1973a615a38" class=""><code>NTUSER.DAT\Software\Microsoft\Windows\CurrentVersion\RunOnce</code></p><p id="2385b2cc-075b-802d-9a64-d4a95aff1e5a" class=""><code>SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnce</code></p><p id="2385b2cc-075b-809e-903c-e5d71dc52f6e" class=""><code>SOFTWARE\Microsoft\Windows\CurrentVersion\policies\Explorer\Run</code></p><p id="2385b2cc-075b-803e-8040-eb8e64f804f9" class=""><code>SOFTWARE\Microsoft\Windows\CurrentVersion\Run</code></p><figure id="2385b2cc-075b-8036-bc7c-d531baa185d2" class="image"><a href="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/6745df01d5c2f896795d5d6f481461b7.png"><img src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/6745df01d5c2f896795d5d6f481461b7.png"/></a></figure><p id="2385b2cc-075b-8097-8a9c-d86151a24039" class="">The following registry key contains information about services:</p><p id="2385b2cc-075b-808d-9102-e76b798e1aaa" class=""><code>SYSTEM\CurrentControlSet\Services</code></p><p id="2385b2cc-075b-8003-b3b6-c5b3a0f0c7e1" class="">Notice the Value of the Start key in the screenshot below.</p><figure id="2385b2cc-075b-80c2-8790-faee2dd14976" class="image"><a href="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/5605bfda34393bfcb8c4aee6a5ad771f.png"><img style="width:700px" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/5605bfda34393bfcb8c4aee6a5ad771f.png"/></a></figure><p id="2385b2cc-075b-801e-a70e-c1916d71cb9d" class="">In this registry key, if the <code>start</code> key is set to 0x02, this means that this service will start at boot.</p><p id="2385b2cc-075b-80fc-82d9-f46c00ac518f" class=""><strong>SAM hive and user information: </strong></p><p id="2385b2cc-075b-800c-9648-ee0ea07446c2" class="">The SAM hive contains user account information, login information, and group information. This information is mainly located in the following location:</p><p id="2385b2cc-075b-8087-88b2-e7acbc92e9be" class=""><code>SAM\Domains\Account\Users</code></p><p id="2385b2cc-075b-80ac-8bac-c7c7233e3ace" class="">Take a look at the below screenshot and answer Question # 6.</p><figure id="2385b2cc-075b-80c1-87ef-cbb1e7990fd7" class="image"><a href="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/d24056c00af7ef9e77ea25b883cdf06c.png"><img src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/d24056c00af7ef9e77ea25b883cdf06c.png"/></a></figure><p id="2385b2cc-075b-80a4-b71a-caae0895d5bd" class="">The information contained here includes the relative identifier (RID) of the user, number of times the user logged in, last login time, last failed login, last password change, password expiry, password policy and password hint, and any groups that the user is a part of.</p><figure id="2385b2cc-075b-802d-9e53-d78b9ca9c15d" class="image"><a href="assets/image%20271.png"><img style="width:710px" src="assets/image%20271.png"/></a></figure><p id="2385b2cc-075b-80f0-ab07-c4560d2d131a" class="">
</p><h2 id="2385b2cc-075b-809f-bf99-fcc9bf93adb6" class="">Usage or knowledge of files/folders</h2><p id="2385b2cc-075b-801d-8371-c7160ed5e9bb" class="">
</p><p id="2385b2cc-075b-80c1-91a8-cc58396d3a4e" class="">Windows maintains a list of recently opened files for each user. As we might have seen when using Windows Explorer, it shows us a list of recently used files.  This information is stored in the NTUSER hive and can be found on the following location:</p><p id="2385b2cc-075b-80b0-911e-c5baad7987a7" class=""><code>NTUSER.DAT\Software\Microsoft\Windows\CurrentVersion\Explorer\RecentDocs</code></p><figure id="2385b2cc-075b-80da-be3d-cec1ac457556" class="image"><a href="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/aff5ea8e993f2989f5f8caf94798a3c7.png"><img src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/aff5ea8e993f2989f5f8caf94798a3c7.png"/></a></figure><p id="2385b2cc-075b-80d6-a7ea-c06afa53cd46" class="">Registry Explorer allows us to sort data contained in registry keys quickly. For example, the Recent documents tab arranges the Most Recently Used (MRU) file at the top of the list. Registry Explorer also arranges them so that the Most Recently Used (MRU) file is shown at the <br/>top of the list and the older ones later.</p><p id="2385b2cc-075b-80d5-b3ad-fef54d7f0e34" class="">Another interesting piece of information in this registry key is that there are different keys with file extensions, such as  <code>.pdf</code>, <code>.jpg</code>, <code>.docx</code> etc. These keys provide us with information about the last <br/>used files of a specific file extension. So if we are looking <br/>specifically for the last used PDF files, we can look at the following <br/>registry key:</p><p id="2385b2cc-075b-8004-b424-c280d75d57a1" class=""><code>NTUSER.DAT\Software\Microsoft\Windows\CurrentVersion\Explorer\RecentDocs\.pdf</code></p><p id="2385b2cc-075b-80f5-8c7d-ef15104db2a6" class="">Registry Explorer also lists the Last Opened time of the files. Answer Question # 1 by looking at the above screenshot.</p><h2 id="2385b2cc-075b-8096-b6f9-d144029ab6b9" class=""><strong>Office Recent Files:</strong></h2><p id="2385b2cc-075b-8080-93de-c9df08ab2c9a" class="">Similar to the Recent Docs maintained by Windows Explorer, Microsoft Office also maintains a list of recently opened documents. This list is also located in the NTUSER hive. It can be found in the following location:</p><p id="2385b2cc-075b-80ea-906b-d719b23609b9" class=""><code>NTUSER.DAT\Software\Microsoft\Office\VERSION</code></p><p id="2385b2cc-075b-801c-b216-e3d77ee35b49" class="">The version number for each Microsoft Office release is different. An example registry key will look like this:</p><p id="2385b2cc-075b-80cd-9978-f3456a315c4b" class=""><code>NTUSER.DAT\Software\Microsoft\Office\15.0\Word</code></p><p id="2385b2cc-075b-80c7-9e88-c443c7ec47de" class="">Here, the 15.0 refers to Office 2013. A list of different Office releases and their version numbers can be found on <a href="https://docs.microsoft.com/en-us/deployoffice/install-different-office-visio-and-project-versions-on-the-same-computer#office-releases-and-their-version-number">this link </a>.</p><p id="2385b2cc-075b-8025-a1cc-fe19c44699f4" class="">Starting from Office 365, Microsoft now ties the location to the user&#x27;s <a href="https://www.microsoft.com/security/blog/2008/05/07/what-is-a-windows-live-id/">live ID </a>. In such a scenario, the recent files can be found at the following location.</p><p id="2385b2cc-075b-804d-9b35-d5536fe98f0d" class=""><code>NTUSER.DAT\Software\Microsoft\Office\VERSION\UserMRU\LiveID_####\FileMRU</code></p><p id="2385b2cc-075b-8079-86c7-f9cf91c6fedd" class="">In such a scenario, the recent files can be found at the following location. This location also saves the complete path of the most recently used files.</p><h2 id="2385b2cc-075b-80d7-a7ef-e9c99691947b" class=""><strong>ShellBags:</strong></h2><p id="2385b2cc-075b-80ab-9049-f4f28684bdc9" class="">When any user opens a folder, it opens in a specific layout. Users can change this layout according to their preferences. These layouts can be different for different folders. This information about the Windows <em>&#x27;shell&#x27; </em> is stored and can identify the Most Recently Used files and folders. Since this setting is different for each user, it is located in the user hives. We can find this information on the following locations:</p><p id="2385b2cc-075b-8088-a7a1-c35d957850e8" class=""><code>USRCLASS.DAT\Local Settings\Software\Microsoft\Windows\Shell\Bags</code></p><p id="2385b2cc-075b-80d6-8b45-cd5a5408fbdd" class=""><code>USRCLASS.DAT\Local Settings\Software\Microsoft\Windows\Shell\BagMRU</code></p><p id="2385b2cc-075b-8056-b3a8-cbfe5931295d" class=""><code>NTUSER.DAT\Software\Microsoft\Windows\Shell\BagMRU</code></p><p id="2385b2cc-075b-80a5-b568-f0bf240b14ca" class=""><code>NTUSER.DAT\Software\Microsoft\Windows\Shell\Bags</code></p><p id="2385b2cc-075b-80ef-a61e-c20498c6df44" class="">Registry Explorer doesn&#x27;t give us much information about ShellBags. However, another tool from Eric Zimmerman&#x27;s tools called the ShellBag Explorer shows us the information in an easy-to-use format. We just have to point to the hive file we have extracted, and it parses the data and shows us the results. An example is shown below. Take a look and answer Question # 2.</p><figure id="2385b2cc-075b-80ed-bdb1-cdcf5e4a516a" class="image"><a href="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/666bd5bd3db41b4b6e3f09311f25666a.png"><img src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/666bd5bd3db41b4b6e3f09311f25666a.png"/></a></figure><h2 id="2385b2cc-075b-80d3-874b-f0fef139fd40" class=""><strong>Open/Save and LastVisited Dialog MRUs:</strong></h2><p id="2385b2cc-075b-8021-b8b8-e02d8bd5e257" class="">When we open or save a file, a dialog box appears asking us where to save or open that file from. It might be noticed that once we open/save a file at a specific location, Windows remembers that location. This implies that we can find out recently used files if we get our hands on this information. We can do so by examining the following registry keys</p><p id="2385b2cc-075b-8001-a13f-f31b943b43e1" class=""><code>NTUSER.DAT\Software\Microsoft\Windows\CurrentVersion\Explorer\ComDlg32\OpenSavePIDlMRU</code></p><p id="2385b2cc-075b-80da-8da0-e2b61d05523f" class=""><code>NTUSER.DAT\Software\Microsoft\Windows\CurrentVersion\Explorer\ComDlg32\LastVisitedPidlMRU</code></p><p id="2385b2cc-075b-804f-8925-c8cdc425a977" class="">This is how Registry Explorer shows this registry key. Take a look to answer Question # 3 and 4.</p><figure id="2385b2cc-075b-800c-9db5-f403467f05b9" class="image"><a href="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/e996b8939895b4b5e55e780baa4335e9.png"><img style="width:700px" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/e996b8939895b4b5e55e780baa4335e9.png"/></a></figure><h2 id="2385b2cc-075b-8071-8256-e5247c3fc735" class=""><strong>Windows Explorer Address/Search Bars:</strong></h2><p id="2385b2cc-075b-802e-81bb-f2ab55d96d28" class="">Another way to identify a user&#x27;s recent activity is by looking at the paths typed in the Windows Explorer address bar or searches performed using the following registry keys, respectively.</p><p id="2385b2cc-075b-8098-a0a3-fd92bfa64a81" class=""><code>NTUSER.DAT\Software\Microsoft\Windows\CurrentVersion\Explorer\TypedPaths</code></p><p id="2385b2cc-075b-801c-8807-f2d40f08ec08" class=""><code>NTUSER.DAT\Software\Microsoft\Windows\CurrentVersion\Explorer\WordWheelQuery</code></p><p id="2385b2cc-075b-8099-95dc-fb2e0f9f22f6" class="">Here is how the TypedPaths key looks like in Registry Explorer:</p><figure id="2385b2cc-075b-80fc-81e9-e3d2eaf4d796" class="image"><a href="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/782204163443e8f21ddd14297ba756dd.png"><img src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/782204163443e8f21ddd14297ba756dd.png"/></a></figure><p id="2385b2cc-075b-8052-a79d-fb0f2e83890f" class="">
</p><h2 id="2385b2cc-075b-8096-8105-e86e78d6bebc" class="">Evidence of Execution</h2><p id="2385b2cc-075b-80a9-a69d-fd68fc33fda0" class=""><strong>UserAssist  </strong> </p><p id="2385b2cc-075b-8067-a717-d739d64e108c" class="">Windows keeps track of applications launched by the user using Windows Explorer for statistical purposes in the User Assist registry keys. These keys contain information about the programs launched, the time of their launch, and the number of times they were executed. However, programs that were run using the command line can&#x27;t be found in the User Assist keys. The User Assist key is present in the NTUSER hive, mapped to each user&#x27;s GUID. We can find it at the following location:</p><p id="2385b2cc-075b-8058-962e-e5f141229cc8" class=""><code>NTUSER.DAT\Software\Microsoft\Windows\Currentversion\Explorer\UserAssist\{GUID}\Count</code></p><p id="2385b2cc-075b-803c-a4e2-e9c0e1cd4d4e" class="">Take a look at the below screenshot from Registry Explorer and answer Question #1.</p><figure id="2385b2cc-075b-8087-825c-e2c0c39cdf86" class="image"><a href="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/9bd8461865865ac3ff774c8a88d1afd5.png"><img style="width:700px" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/9bd8461865865ac3ff774c8a88d1afd5.png"/></a></figure><h2 id="2385b2cc-075b-804e-b2fa-df43c4969dc7" class=""><strong>ShimCache: </strong></h2><p id="2385b2cc-075b-8041-8298-c98e25e9ec1c" class="">ShimCache is a mechanism used to keep track of application compatibility with the OS and tracks all applications launched on the machine. Its main purpose in Windows is to ensure backward compatibility of applications. It is also called Application Compatibility Cache (AppCompatCache). It is located in the following location in the SYSTEM hive:</p><p id="2385b2cc-075b-80a7-86fe-cc95e66d7ee1" class=""><code>SYSTEM\CurrentControlSet\Control\Session Manager\AppCompatCache</code></p><p id="2385b2cc-075b-80ed-ad22-f02ec4a4d1b5" class="">ShimCache stores file name, file size, and last modified time of the executables. Our goto tool, the Registry Explorer, doesn&#x27;t parse ShimCache data in a human-readable format, so we go to another tool called AppCompatCache Parser, also a part of Eric Zimmerman&#x27;s tools. It takes the SYSTEM hive as input, parses the data, and outputs a CSV file that looks like this:</p><figure id="2385b2cc-075b-80c2-a917-f5ba49a27060" class="image"><a href="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/aad7dc918dbf3b1ab207dd71d03e8c0c.png"><img src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/aad7dc918dbf3b1ab207dd71d03e8c0c.png"/></a></figure><p id="2385b2cc-075b-8030-b127-f5395da949cb" class="">We can use the following command to run the AppCompatCache Parser Utility:</p><p id="2385b2cc-075b-802c-80ef-f247e474e4f1" class=""><code>AppCompatCacheParser.exe --csv &lt;path to save output&gt; -f <br/>&lt;path to SYSTEM hive for data parsing&gt; -c &lt;control set to <br/>parse&gt;</code></p><p id="2385b2cc-075b-8033-8eb5-d665ea82109c" class="">The output can be viewed using EZviewer, another one of Eric Zimmerman&#x27;s tools.</p><p id="2385b2cc-075b-80e7-8694-fed5e68539f1" class=""><strong>AmCache</strong></p><p id="2385b2cc-075b-80a3-8fe3-edd26b53962b" class="">The AmCache hive is an artifact related to ShimCache. This performs a similar function to ShimCache, and stores additional data related to program executions. This data includes execution path, installation, execution and deletion times, and SHA1 hashes of the executed programs. This hive is located in the file system at:</p><p id="2385b2cc-075b-80fb-bbbe-d50307c4d7a5" class=""><code>C:\Windows\appcompat\Programs\Amcache.hve</code></p><p id="2385b2cc-075b-80c5-ae7c-cce9b95cc0f6" class="">Information about the last executed programs can be found at the following location in the hive:</p><p id="2385b2cc-075b-8041-885f-e2e6559ade9c" class=""><code>Amcache.hve\Root\File\{Volume GUID}\</code></p><p id="2385b2cc-075b-80f4-866d-df60c454928c" class="">This is how Registry Explorer parses the AmCache hive:</p><figure id="2385b2cc-075b-804c-93f2-f8be4954c238" class="image"><a href="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/a569dfdf155c1a26fe3a693c388a44c7.png"><img src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/a569dfdf155c1a26fe3a693c388a44c7.png"/></a></figure><h3 id="2385b2cc-075b-8007-998b-d3b7125fd971" class=""><strong>BAM/DAM: </strong></h3><p id="2385b2cc-075b-8086-a0e8-e44dcb99fee5" class="">Background Activity Monitor or BAM keeps a tab on the activity of background applications. Similar Desktop Activity Moderator or DAM is a part of Microsoft Windows that optimizes the power consumption of the device. Both of these are a part of the Modern Standby system in <br/>Microsoft Windows.</p><p id="2385b2cc-075b-80b0-865c-db6a1b7ca168" class="">In the Windows registry, the following locations contain information related to BAM and DAM. This location contains information about last run programs, their full paths, and last execution time.</p><p id="2385b2cc-075b-804c-9907-f3e64970bcd8" class=""><code>SYSTEM\CurrentControlSet\Services\bam\UserSettings\{SID}</code></p><p id="2385b2cc-075b-8096-832d-d5897db665a2" class=""><code>SYSTEM\CurrentControlSet\Services\dam\UserSettings\{SID}</code></p><p id="2385b2cc-075b-8028-af4d-c67f76e7aba7" class="">Below you can see how Registry Explorer parses data from BAM:</p><figure id="2385b2cc-075b-805f-82ed-ebca84cb9d95" class="image"><a href="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/8a672c6580ab63d757ee5c08c09c924a.png"><img src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/8a672c6580ab63d757ee5c08c09c924a.png"/></a></figure><p id="2385b2cc-075b-80e9-a977-d1c999ca69c5" class="">
</p><h2 id="2385b2cc-075b-80d0-838e-ce03732584ea" class="">External Devices/USB device forensics</h2><p id="2385b2cc-075b-80d9-ae9f-cf62296b16a5" class="">When performing forensics on a machine, often the need arises to identify if any USB or removable <br/>drives were attached to the machine. If so, any information related to those devices is important for a forensic investigator. In this task, we will go through the different ways to find information on connected devices and the drives on a system using the registry.</p><h3 id="2385b2cc-075b-8086-b4bd-d6a47790cb8f" class="">Device identification:</h3><p id="2385b2cc-075b-8042-91e2-e3b5943713a8" class="">The following locations keep track of USB keys plugged into a system. These locations store the vendor id, product id, and version of the USB device plugged in and can be used to identify unique devices. These locations also store the time the devices were plugged into the system.</p><p id="2385b2cc-075b-8017-9953-ca5d14034355" class=""><code>SYSTEM\CurrentControlSet\Enum\USBSTOR</code></p><p id="2385b2cc-075b-80e5-b75f-e347a0b5fde3" class=""><code>SYSTEM\CurrentControlSet\Enum\USB</code></p><p id="2385b2cc-075b-8077-b0fa-d1b0338df44d" class="">Registry Explorer shows this information in a nice and easy-to-understand way. Take a look at this and answer Questions # 1 and 2.</p><figure id="2385b2cc-075b-80dc-a8fb-d0256dd38fc7" class="image"><a href="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/03c87eaaf8458db97ffbddd30a6463e8.png"><img src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/03c87eaaf8458db97ffbddd30a6463e8.png"/></a></figure><h3 id="2385b2cc-075b-80c3-ac47-e21b9f9f3a6e" class="">First/Last Times:</h3><p id="2385b2cc-075b-80e7-a99e-c0f2db3cbaaa" class="">Similarly, the following registry key tracks the first time the device was connected, the last time it was connected and the last time the device was removed from the system.</p><p id="2385b2cc-075b-80dd-8f40-f622b79828e4" class=""><code>SYSTEM\CurrentControlSet\Enum\USBSTOR\Ven_Prod_Version\USBSerial#\Properties\{83da6326-97a6-4088-9453-a19231573b29}\####</code></p><p id="2385b2cc-075b-8010-82d9-f8db11edf610" class="">In this key, the #### sign can be replaced by the following digits to get the required information:</p><table id="2385b2cc-075b-8073-ad5c-e879df480ec4" class="simple-table"><tbody><tr id="2385b2cc-075b-80e2-b4c9-ec16fb1d6631"><td id="jNMf" class=""><strong>Value</strong></td><td id="&lt;b]P" class=""><strong>Information</strong></td></tr><tr id="2385b2cc-075b-8050-a685-c8e025d60cd9"><td id="jNMf" class="">0064</td><td id="&lt;b]P" class="">First Connection time</td></tr><tr id="2385b2cc-075b-8069-a33b-c4c1cb2cfb20"><td id="jNMf" class="">0066</td><td id="&lt;b]P" class="">Last Connection time</td></tr><tr id="2385b2cc-075b-8084-8f17-fd2e3bb27bc5"><td id="jNMf" class="">0067</td><td id="&lt;b]P" class="">Last removal time</td></tr></tbody></table><p id="2385b2cc-075b-800b-a99f-d2ccc528ef67" class="">Although we can check this value manually, as we have seen above, Registry Explorer already parses this data and shows us if we select the USBSTOR key.</p><p id="2385b2cc-075b-80d8-8bb1-e23619ccb8be" class=""><strong>USB device Volume Name: </strong></p><p id="2385b2cc-075b-80b2-aa48-dd1dac45b55a" class="">The device name of the connected drive can be found at the following location:</p><p id="2385b2cc-075b-80f2-baf8-ea385c564d62" class=""><code>SOFTWARE\Microsoft\Windows Portable Devices\Devices</code></p><figure id="2385b2cc-075b-8013-aec5-d3e360d750fe" class="image"><a href="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/6c9f71cdf4c71afdc19fc8c254a6a3cc.png"><img src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/6c9f71cdf4c71afdc19fc8c254a6a3cc.png"/></a></figure><p id="2385b2cc-075b-80d2-ada3-f0ce4e13bab5" class="">We can compare the GUID we see here in this registry key and compare it with the Disk ID we see on keys mentioned in device identification to correlate the names with unique devices. Take a look at these two screenshots and answer Question # 3.</p><p id="2385b2cc-075b-80b4-bb86-dcebda6e1447" class="">Combining all of this information, we can create a fair picture of any USB devices that were connected to the machine we&#x27;re investigating.</p><p id="2385b2cc-075b-80eb-a316-dc87dff2db7b" class="">
</p><h2 id="2385b2cc-075b-80f4-baf2-ccc585e3f243" class="">Hands-on Challenge</h2><hr id="2385b2cc-075b-8047-9283-d7c9dafb10c2"/><h3 id="2385b2cc-075b-8064-83b9-fb8d92eebaa9" class="">🕵️‍♀️ Digital Forensics Investigation – Organization X Scenario</h3><p id="2385b2cc-075b-8016-a820-f7ae324de72e" class=""><strong>Suspected Issues:</strong></p><ul id="2385b2cc-075b-80cb-ac06-c4a53829e641" class="bulleted-list"><li style="list-style-type:disc">Unauthorized access to one of the research lab desktops.</li></ul><ul id="2385b2cc-075b-8097-8a6f-f8cdd06a06e4" class="bulleted-list"><li style="list-style-type:disc">Presence of <strong>multiple user accounts</strong> on a system that typically has just one.</li></ul><ul id="2385b2cc-075b-808f-9ef8-f176859e325f" class="bulleted-list"><li style="list-style-type:disc"><strong>Potential network drive connection</strong>.</li></ul><ul id="2385b2cc-075b-8027-957d-e75831568815" class="bulleted-list"><li style="list-style-type:disc"><strong>USB device possibly plugged in</strong>.</li></ul><ul id="2385b2cc-075b-8089-8c44-ee14cff95de5" class="bulleted-list"><li style="list-style-type:disc">Triage data collected and loaded on a VM for analysis.</li></ul><hr id="2385b2cc-075b-80d3-9732-e90d9fa2282d"/><h3 id="2385b2cc-075b-8095-ae6c-d72bb6cd24b0" class="">🔧 Using RegistryExplorer with Dirty Hives</h3><p id="2385b2cc-075b-8006-a665-fbe57f12dee2" class=""><strong>Dirty hives? Don’t panic!</strong></p><ul id="2385b2cc-075b-803e-b8be-ee6cbdd88b78" class="bulleted-list"><li style="list-style-type:disc">RegistryExplorer warns when a registry hive is <em>&quot;dirty&quot;</em> because it wasn&#x27;t properly closed.</li></ul><ul id="2385b2cc-075b-8041-8a0c-f92f34f491ae" class="bulleted-list"><li style="list-style-type:disc">Use accompanying <strong>transaction logs</strong>: <code>.LOG1</code> and <code>.LOG2</code> with the same filename.</li></ul><ul id="2385b2cc-075b-8064-838d-d63bcdc031cf" class="bulleted-list"><li style="list-style-type:disc">RegistryExplorer will combine them to build a <strong>clean hive</strong> automatically.</li></ul><ul id="2385b2cc-075b-8035-a4e5-dfc910c29449" class="bulleted-list"><li style="list-style-type:disc">After saving the clean hive, use it for further analysis instead of the dirty one.</li></ul><hr id="2385b2cc-075b-806b-9193-e8067275e1b3"/><h3 id="2385b2cc-075b-8049-8928-df054d975b6d" class="">🔍 What to Check in the Analysis</h3><p id="2385b2cc-075b-8058-8911-cddccd4e40d9" class="">Here are key areas to inspect using RegistryExplorer:</p><table id="2385b2cc-075b-802b-b917-fb6852a29988" class="simple-table"><thead class="simple-table-header"><tr id="2385b2cc-075b-8093-92af-fee2353b76f8"><th id="duco" class="simple-table-header-color simple-table-header"><strong>Target Information</strong></th><th id="y=lk" class="simple-table-header-color simple-table-header" style="width:433px"><strong>Where to Look</strong></th></tr></thead><tbody><tr id="2385b2cc-075b-806b-b7ef-e9f69e1ea5ec"><td id="duco" class=""><strong>User accounts present</strong></td><td id="y=lk" class="" style="width:433px"><code>HKEY_LOCAL_MACHINE\SAM</code> and <code>HKEY_USERS</code> for user profile traces.</td></tr><tr id="2385b2cc-075b-8030-baa9-f2115d46f238"><td id="duco" class=""><strong>USB device connection</strong></td><td id="y=lk" class="" style="width:433px">Search <code>USBSTOR</code> entries under <code>SYSTEM\CurrentControlSet\Enum\USBSTOR</code>.</td></tr><tr id="2385b2cc-075b-80d3-8ee1-c13143aa536b"><td id="duco" class=""><strong>Network drive usage</strong></td><td id="y=lk" class="" style="width:433px">Check <code>MountPoints2</code> and <code>Network</code> keys in <code>HKCU</code> (per-user network usage).</td></tr><tr id="2385b2cc-075b-8004-b670-ef6c91a3500a"><td id="duco" class=""><strong>Login timestamps</strong></td><td id="y=lk" class="" style="width:433px">Look for entries in <code>Microsoft\Windows\CurrentVersion\Authentication\LogonUI</code>.</td></tr><tr id="2385b2cc-075b-80e2-aa82-d10034b537cf"><td id="duco" class=""><strong>Last user activity</strong></td><td id="y=lk" class="" style="width:433px">Examine the user&#x27;s NTUSER.DAT hive for recent app usage and registry timestamps.</td></tr></tbody></table><hr id="2385b2cc-075b-809e-a883-d97d968fc226"/><h2 id="2385b2cc-075b-8012-b169-e6575b48ed8b" class=""><strong>Adding Hives to</strong><mark class="highlight-teal"><strong> EZ Registry Explorer</strong></mark></h2><p id="2385b2cc-075b-80ec-b080-ff50363e8eef" class="">To load the hives into RegistryExplorer, we need to open it first. <br/>RegistryExplorer is located by going to EZTools folder -&gt; <br/>RegistryExplorer -&gt; RegistryExplorer. It may take a while for the <br/>application to load.</p><figure id="2385b2cc-075b-8068-9597-c921a0581655" class="image"><a href="https://miro.medium.com/v2/resize:fit:1167/1*La6g3om4yRWqICVg5ga2Kw.png"><img style="width:700px" src="https://miro.medium.com/v2/resize:fit:1167/1*La6g3om4yRWqICVg5ga2Kw.png"/></a></figure><p id="2385b2cc-075b-80e9-a0c3-fd076537f198" class="">Once Registry Explorer loads, we will load the hive. Do this by going to File -&gt; Load hive.</p><figure id="2385b2cc-075b-80e7-a87a-c14012640b72" class="image"><a href="https://miro.medium.com/v2/resize:fit:407/1*GHkeNBBO9Fl4Lx9L-DoBtw.png"><img style="width:243.98800659179688px" src="https://miro.medium.com/v2/resize:fit:407/1*GHkeNBBO9Fl4Lx9L-DoBtw.png"/></a></figure><p id="2385b2cc-075b-8032-8562-ff17909089ad" class="">From here, go to triage -&gt; C -&gt; Windows -&gt; System 32 -&gt; config to access the registry files.</p><figure id="2385b2cc-075b-8082-875c-f0f55dc16771" class="image"><a href="https://miro.medium.com/v2/resize:fit:1167/1*vdMyfCWX7s_nb4YSt-I5UQ.png"><img style="width:700px" src="https://miro.medium.com/v2/resize:fit:1167/1*vdMyfCWX7s_nb4YSt-I5UQ.png"/></a></figure><p id="2385b2cc-075b-80f6-8e8b-fa32b421cb75" class="">I loaded each file one at a time starting with “DEFAULT.” A warning <br/>should pop up about sequence numbers not matching. Do not worry. Just <br/>press Yes. Next, it says select transaction logs. We will select both <br/>DEFAULT.LOG1 and DEFAULT.LOG2 files. To select more than one file, you <br/>can click on the first file, then hold CTRL and click on the second <br/>file.</p><figure id="2385b2cc-075b-80c4-bfd6-e48a207b9bb5" class="image"><a href="https://miro.medium.com/v2/resize:fit:1057/1*S8Oj_9E9vTWBecegEuy0yA.png"><img style="width:365px" src="https://miro.medium.com/v2/resize:fit:1057/1*S8Oj_9E9vTWBecegEuy0yA.png"/></a></figure><p id="2385b2cc-075b-80bd-9187-ea662eb9a34e" class="">We should get a pop up saying to select a location for our new and updated<br/> hive. I just saved it at the default location, which should be our <br/>Desktop. Next, it should ask if you want to load the <strong>updated </strong>hive. Select Yes. Now it should ask if we want to load the dirty/original hive. Select No.</p><figure id="2385b2cc-075b-80e6-9265-d7e2397db98e" class="image"><a href="https://miro.medium.com/v2/resize:fit:865/1*OcTFdhLEfcyrTaL58YaBpw.png"><img style="width:365px" src="https://miro.medium.com/v2/resize:fit:865/1*OcTFdhLEfcyrTaL58YaBpw.png"/></a></figure><p id="2385b2cc-075b-8080-bdc0-c159f75cdb85" class="">Congratulations! We loaded our first hive!</p><figure id="2385b2cc-075b-801f-b674-ef03b39507d9" class="image"><a href="https://miro.medium.com/v2/resize:fit:968/1*A1x95SrWCWQbnBG5dLP1aw.png"><img style="width:365px" src="https://miro.medium.com/v2/resize:fit:968/1*A1x95SrWCWQbnBG5dLP1aw.png"/></a></figure><p id="2385b2cc-075b-8021-946b-ecef09728c52" class="">Now do it again for the hives, which are SAM, SECURITY, SOFTWARE, and <br/>SYSTEM. SAM was the only one that didn’t seem to have any trouble with <br/>it being “dirty” but I’m not sure if it’s just me. I also loaded <br/>NTUSER.DAT since I think I might need it later on. NTUSER.DAT is located<br/> at a different folder. It is found in triage -&gt; C -&gt; Users -&gt; <br/>THM-4n6 -&gt; NTUSER.DAT. Once you finish loading everything, it should <br/>look like this.</p><figure id="2385b2cc-075b-80fd-8758-fbd3ad8b478e" class="image"><a href="https://miro.medium.com/v2/resize:fit:975/1*ZcCoEN3x5ecEVCzF0wR9_g.png"><img style="width:365px" src="https://miro.medium.com/v2/resize:fit:975/1*ZcCoEN3x5ecEVCzF0wR9_g.png"/></a></figure><p id="2385b2cc-075b-8024-92f7-f9b1c55a6c6c" class="">
</p><h3 id="2385b2cc-075b-80cc-bc9b-e0e8a365dff9" class="">QUESTIONS</h3><p id="2385b2cc-075b-804c-8c61-c9ac153a03f5" class="">
</p><ol type="1" id="2385b2cc-075b-80d4-90e6-f90c7d1ba2ed" class="numbered-list" start="1"><li>How many user created accounts are present on the system?<br/><br/>From available Bookmarks, Under the SAM hive, I can see the users list.</li></ol><figure id="2385b2cc-075b-807d-b0b4-ff770f1cd516" class="image"><a href="assets/image%20272.png"><img style="width:2256px" src="assets/image%20272.png"/></a></figure><ol type="1" id="2385b2cc-075b-801e-8bb0-c96f2a70ee9b" class="numbered-list" start="2"><li>What is the username of the account that has never been logged in?<br/><br/>User ID 1003 doesnt have a Last Login date</li></ol><figure id="2385b2cc-075b-807e-b5c8-e012b8366bcd" class="image"><a href="assets/image%20273.png"><img style="width:620px" src="assets/image%20273.png"/></a></figure><ol type="1" id="2385b2cc-075b-8084-b204-dae4c9c3c5ac" class="numbered-list" start="3"><li>What&#x27;s the password hint for the user THM-4n6?<br/><br/>From the same SAM, i can see the hint for the user ID 1001</li></ol><figure id="2385b2cc-075b-80dd-b3fb-c86ab9409dfa" class="image"><a href="assets/image%20274.png"><img style="width:620px" src="assets/image%20274.png"/></a></figure><ol type="1" id="2385b2cc-075b-8082-9e2e-c8c1f19c6506" class="numbered-list" start="4"><li>When was the file &#x27;Changelog.txt&#x27; accessed?</li></ol><p id="2385b2cc-075b-801a-b4e7-e782b7d10960" class=""><br/>I went back to one of the reading sections as I recalled learning where to find recent files. It’s in Task 7. The location to find where a file was last accessed is at NTUSER.DAT\Software\Microsoft\Windows\CurrentVersion\Explorer\RecentDocs. Alternatively, you can type “RecentDocs” in the search bar and then look for the result that is under NTUSER.DAT.</p><figure id="2385b2cc-075b-80bd-8aef-e9de1b3f48e6" class="image"><a href="assets/image%20275.png"><img style="width:2257px" src="assets/image%20275.png"/></a></figure><p id="2385b2cc-075b-80dc-b88a-ee8b22c9ee6b" class="">
</p><ol type="1" id="2385b2cc-075b-809a-9289-cd2b0ee7d194" class="numbered-list" start="5"><li>What is the complete path from where the python 3.8.2 installer was run?<br/><br/>From the RecentApps section og NTUSER.DAT, I looked for Python and found </li></ol><figure id="2385b2cc-075b-807e-9ff3-ec37f5fa94a8" class="image"><a href="assets/image%20276.png"><img style="width:2250px" src="assets/image%20276.png"/></a></figure><p id="2385b2cc-075b-80d3-abed-d4d7f2fd9c67" class="">
</p><ol type="1" id="2385b2cc-075b-8004-92ce-e703d0c8d115" class="numbered-list" start="6"><li>When was the USB device with the friendly name &#x27;USB&#x27; last connected?</li></ol><p id="2385b2cc-075b-8081-82d0-d7de8ff0ec6e" class="">I reread task 9 to jog my memory on how to get the device name. I went to SOFTWARE\Microsoft\Windows Portable Devices\Devices first. Unfortunately, Microsoft folder didn’t exist, so the path I used was SOFTWARE\Windows Portable Devices\Devices. I saw that one of the two folders had a FriendlyName value of USB. I took note of, what I believe to be, the serial number in the folder name.</p><figure id="2385b2cc-075b-8041-ac4f-e3db81c06cf3" class="image"><a href="https://miro.medium.com/v2/resize:fit:718/1*Z75OCQZ0vVZpSlcjMxaC_w.png"><img style="width:365px" src="https://miro.medium.com/v2/resize:fit:718/1*Z75OCQZ0vVZpSlcjMxaC_w.png"/></a></figure><p id="2385b2cc-075b-804d-87b3-d19e537e0c59" class="">Now I searched for “USBSTOR” and looked at the right side to compare values. It looks like the value I took note of wasn’t the serial number but disk ID instead.</p><figure id="2385b2cc-075b-8007-b9d6-ea36c9c230e6" class="image"><a href="assets/image%20277.png"><img style="width:2250px" src="assets/image%20277.png"/></a></figure><p id="2385b2cc-075b-80c9-90b3-c3063bce84c2" class="">
</p><h3 id="2385b2cc-075b-8083-bf73-c08200b87dfd" class="">Conclusion</h3><figure id="2385b2cc-075b-8004-b369-f9f8db19dc00"><div class="source"><a href="assets/WindowsForensicsCheatsheet-TryHackMe-1642092762578.pdf">WindowsForensicsCheatsheet-TryHackMe-1642092762578.pdf</a></div></figure><figure id="2385b2cc-075b-805f-8e84-d477cbd6e9a9" class="image"><a href="assets/image%20278.png"><img style="width:619.9833374023438px" src="assets/image%20278.png"/></a></figure><figure id="2385b2cc-075b-80b1-8da1-f20d463789d1" class="image"><a href="assets/image%20279.png"><img style="width:620px" src="assets/image%20279.png"/></a></figure><p id="2385b2cc-075b-80e0-9b47-cd82252ed2b9" class="">
</p><p id="2385b2cc-075b-8074-8bca-fa218fa0007f" class="">
</p></div></article><span class="sans" style="font-size:14px;padding-top:2em"></span></body></html>