<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>Phishing Prevention</title><style>
/* cspell:disable-file */
/* webkit printing magic: print all background colors */
html {
	-webkit-print-color-adjust: exact;
}
* {
	box-sizing: border-box;
	-webkit-print-color-adjust: exact;
}

html,
body {
	margin: 0;
	padding: 0;
}
@media only screen {
	body {
		margin: 2em auto;
		max-width: 900px;
		color: rgb(55, 53, 47);
	}
}

body {
	line-height: 1.5;
	white-space: pre-wrap;
}

a,
a.visited {
	color: inherit;
	text-decoration: underline;
}

.pdf-relative-link-path {
	font-size: 80%;
	color: #444;
}

h1,
h2,
h3 {
	letter-spacing: -0.01em;
	line-height: 1.2;
	font-weight: 600;
	margin-bottom: 0;
}

.page-title {
	font-size: 2.5rem;
	font-weight: 700;
	margin-top: 0;
	margin-bottom: 0.75em;
}

h1 {
	font-size: 1.875rem;
	margin-top: 1.875rem;
}

h2 {
	font-size: 1.5rem;
	margin-top: 1.5rem;
}

h3 {
	font-size: 1.25rem;
	margin-top: 1.25rem;
}

.source {
	border: 1px solid #ddd;
	border-radius: 3px;
	padding: 1.5em;
	word-break: break-all;
}

.callout {
	border-radius: 3px;
	padding: 1rem;
}

figure {
	margin: 1.25em 0;
	page-break-inside: avoid;
}

figcaption {
	opacity: 0.5;
	font-size: 85%;
	margin-top: 0.5em;
}

mark {
	background-color: transparent;
}

.indented {
	padding-left: 1.5em;
}

hr {
	background: transparent;
	display: block;
	width: 100%;
	height: 1px;
	visibility: visible;
	border: none;
	border-bottom: 1px solid rgba(55, 53, 47, 0.09);
}

img {
	max-width: 100%;
}

@media only print {
	img {
		max-height: 100vh;
		object-fit: contain;
	}
}

@page {
	margin: 1in;
}

.collection-content {
	font-size: 0.875rem;
}

.column-list {
	display: flex;
	justify-content: space-between;
}

.column {
	padding: 0 1em;
}

.column:first-child {
	padding-left: 0;
}

.column:last-child {
	padding-right: 0;
}

.table_of_contents-item {
	display: block;
	font-size: 0.875rem;
	line-height: 1.3;
	padding: 0.125rem;
}

.table_of_contents-indent-1 {
	margin-left: 1.5rem;
}

.table_of_contents-indent-2 {
	margin-left: 3rem;
}

.table_of_contents-indent-3 {
	margin-left: 4.5rem;
}

.table_of_contents-link {
	text-decoration: none;
	opacity: 0.7;
	border-bottom: 1px solid rgba(55, 53, 47, 0.18);
}

table,
th,
td {
	border: 1px solid rgba(55, 53, 47, 0.09);
	border-collapse: collapse;
}

table {
	border-left: none;
	border-right: none;
}

th,
td {
	font-weight: normal;
	padding: 0.25em 0.5em;
	line-height: 1.5;
	min-height: 1.5em;
	text-align: left;
}

th {
	color: rgba(55, 53, 47, 0.6);
}

ol,
ul {
	margin: 0;
	margin-block-start: 0.6em;
	margin-block-end: 0.6em;
}

li > ol:first-child,
li > ul:first-child {
	margin-block-start: 0.6em;
}

ul > li {
	list-style: disc;
}

ul.to-do-list {
	padding-inline-start: 0;
}

ul.to-do-list > li {
	list-style: none;
}

.to-do-children-checked {
	text-decoration: line-through;
	opacity: 0.375;
}

ul.toggle > li {
	list-style: none;
}

ul {
	padding-inline-start: 1.7em;
}

ul > li {
	padding-left: 0.1em;
}

ol {
	padding-inline-start: 1.6em;
}

ol > li {
	padding-left: 0.2em;
}

.mono ol {
	padding-inline-start: 2em;
}

.mono ol > li {
	text-indent: -0.4em;
}

.toggle {
	padding-inline-start: 0em;
	list-style-type: none;
}

/* Indent toggle children */
.toggle > li > details {
	padding-left: 1.7em;
}

.toggle > li > details > summary {
	margin-left: -1.1em;
}

.selected-value {
	display: inline-block;
	padding: 0 0.5em;
	background: rgba(206, 205, 202, 0.5);
	border-radius: 3px;
	margin-right: 0.5em;
	margin-top: 0.3em;
	margin-bottom: 0.3em;
	white-space: nowrap;
}

.collection-title {
	display: inline-block;
	margin-right: 1em;
}

.page-description {
	margin-bottom: 2em;
}

.simple-table {
	margin-top: 1em;
	font-size: 0.875rem;
	empty-cells: show;
}
.simple-table td {
	height: 29px;
	min-width: 120px;
}

.simple-table th {
	height: 29px;
	min-width: 120px;
}

.simple-table-header-color {
	background: rgb(247, 246, 243);
	color: black;
}
.simple-table-header {
	font-weight: 500;
}

time {
	opacity: 0.5;
}

.icon {
	display: inline-block;
	max-width: 1.2em;
	max-height: 1.2em;
	text-decoration: none;
	vertical-align: text-bottom;
	margin-right: 0.5em;
}

img.icon {
	border-radius: 3px;
}

.user-icon {
	width: 1.5em;
	height: 1.5em;
	border-radius: 100%;
	margin-right: 0.5rem;
}

.user-icon-inner {
	font-size: 0.8em;
}

.text-icon {
	border: 1px solid #000;
	text-align: center;
}

.page-cover-image {
	display: block;
	object-fit: cover;
	width: 100%;
	max-height: 30vh;
}

.page-header-icon {
	font-size: 3rem;
	margin-bottom: 1rem;
}

.page-header-icon-with-cover {
	margin-top: -0.72em;
	margin-left: 0.07em;
}

.page-header-icon img {
	border-radius: 3px;
}

.link-to-page {
	margin: 1em 0;
	padding: 0;
	border: none;
	font-weight: 500;
}

p > .user {
	opacity: 0.5;
}

td > .user,
td > time {
	white-space: nowrap;
}

input[type="checkbox"] {
	transform: scale(1.5);
	margin-right: 0.6em;
	vertical-align: middle;
}

p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.image {
	border: none;
	margin: 1.5em 0;
	padding: 0;
	border-radius: 0;
	text-align: center;
}

.code,
code {
	background: rgba(135, 131, 120, 0.15);
	border-radius: 3px;
	padding: 0.2em 0.4em;
	border-radius: 3px;
	font-size: 85%;
	tab-size: 2;
}

code {
	color: #eb5757;
}

.code {
	padding: 1.5em 1em;
}

.code-wrap {
	white-space: pre-wrap;
	word-break: break-all;
}

.code > code {
	background: none;
	padding: 0;
	font-size: 100%;
	color: inherit;
}

blockquote {
	font-size: 1.25em;
	margin: 1em 0;
	padding-left: 1em;
	border-left: 3px solid rgb(55, 53, 47);
}

.bookmark {
	text-decoration: none;
	max-height: 8em;
	padding: 0;
	display: flex;
	width: 100%;
	align-items: stretch;
}

.bookmark-title {
	font-size: 0.85em;
	overflow: hidden;
	text-overflow: ellipsis;
	height: 1.75em;
	white-space: nowrap;
}

.bookmark-text {
	display: flex;
	flex-direction: column;
}

.bookmark-info {
	flex: 4 1 180px;
	padding: 12px 14px 14px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
}

.bookmark-image {
	width: 33%;
	flex: 1 1 180px;
	display: block;
	position: relative;
	object-fit: cover;
	border-radius: 1px;
}

.bookmark-description {
	color: rgba(55, 53, 47, 0.6);
	font-size: 0.75em;
	overflow: hidden;
	max-height: 4.5em;
	word-break: break-word;
}

.bookmark-href {
	font-size: 0.75em;
	margin-top: 0.25em;
}

.sans { font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
.code { font-family: "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; }
.serif { font-family: Lyon-Text, Georgia, ui-serif, serif; }
.mono { font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; }
.pdf .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK JP'; }
.pdf:lang(zh-CN) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC'; }
.pdf:lang(zh-TW) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK TC'; }
.pdf:lang(ko-KR) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK KR'; }
.pdf .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK JP'; }
.pdf:lang(zh-CN) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK SC'; }
.pdf:lang(zh-TW) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK TC'; }
.pdf:lang(ko-KR) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK KR'; }
.pdf .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.highlight-default {
	color: rgba(50, 48, 44, 1);
}
.highlight-gray {
	color: rgba(115, 114, 110, 1);
	fill: rgba(115, 114, 110, 1);
}
.highlight-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.highlight-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.highlight-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.highlight-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.highlight-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.highlight-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.highlight-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.highlight-red {
	color: rgba(205, 60, 58, 1);
	fill: rgba(205, 60, 58, 1);
}
.highlight-default_background {
	color: rgba(50, 48, 44, 1);
}
.highlight-gray_background {
	background: rgba(248, 248, 247, 1);
}
.highlight-brown_background {
	background: rgba(244, 238, 238, 1);
}
.highlight-orange_background {
	background: rgba(251, 236, 221, 1);
}
.highlight-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.highlight-teal_background {
	background: rgba(237, 243, 236, 1);
}
.highlight-blue_background {
	background: rgba(231, 243, 248, 1);
}
.highlight-purple_background {
	background: rgba(248, 243, 252, 1);
}
.highlight-pink_background {
	background: rgba(252, 241, 246, 1);
}
.highlight-red_background {
	background: rgba(253, 235, 236, 1);
}
.block-color-default {
	color: inherit;
	fill: inherit;
}
.block-color-gray {
	color: rgba(115, 114, 110, 1);
	fill: rgba(115, 114, 110, 1);
}
.block-color-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.block-color-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.block-color-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.block-color-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.block-color-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.block-color-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.block-color-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.block-color-red {
	color: rgba(205, 60, 58, 1);
	fill: rgba(205, 60, 58, 1);
}
.block-color-default_background {
	color: inherit;
	fill: inherit;
}
.block-color-gray_background {
	background: rgba(248, 248, 247, 1);
}
.block-color-brown_background {
	background: rgba(244, 238, 238, 1);
}
.block-color-orange_background {
	background: rgba(251, 236, 221, 1);
}
.block-color-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.block-color-teal_background {
	background: rgba(237, 243, 236, 1);
}
.block-color-blue_background {
	background: rgba(231, 243, 248, 1);
}
.block-color-purple_background {
	background: rgba(248, 243, 252, 1);
}
.block-color-pink_background {
	background: rgba(252, 241, 246, 1);
}
.block-color-red_background {
	background: rgba(253, 235, 236, 1);
}
.select-value-color-default { background-color: rgba(84, 72, 49, 0.08); }
.select-value-color-gray { background-color: rgba(84, 72, 49, 0.15); }
.select-value-color-brown { background-color: rgba(210, 162, 141, 0.35); }
.select-value-color-orange { background-color: rgba(224, 124, 57, 0.27); }
.select-value-color-yellow { background-color: rgba(236, 191, 66, 0.39); }
.select-value-color-green { background-color: rgba(123, 183, 129, 0.27); }
.select-value-color-blue { background-color: rgba(93, 165, 206, 0.27); }
.select-value-color-purple { background-color: rgba(168, 129, 197, 0.27); }
.select-value-color-pink { background-color: rgba(225, 136, 179, 0.27); }
.select-value-color-red { background-color: rgba(244, 171, 159, 0.4); }

.checkbox {
	display: inline-flex;
	vertical-align: text-bottom;
	width: 16;
	height: 16;
	background-size: 16px;
	margin-left: 2px;
	margin-right: 5px;
}

.checkbox-on {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
}

.checkbox-off {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
}
	
</style></head><body><article id="2445b2cc-075b-80e4-a7d1-c1692ea28968" class="page sans"><header><div class="page-header-icon undefined"><img class="icon" src="https://tryhackme-images.s3.amazonaws.com/room-icons/31b1029c54838c4a8dfc2e84057aac33.png"/></div><h1 class="page-title"><strong>Phishing Prevention</strong></h1><p class="page-description"></p></header><div class="page-body"><p id="2445b2cc-075b-809f-a52c-f969080dcde1" class="">There are various actions a defender can take to help protect the users from falling victim to a malicious email.</p><p id="2445b2cc-075b-80e0-b9f9-ea4a9bdc5da1" class="">Some examples of these actions are listed below:</p><ul id="2445b2cc-075b-80f3-b6a5-e857b628df40" class="bulleted-list"><li style="list-style-type:disc">Email Security (SPF, DKIM, DMARC)</li></ul><ul id="2445b2cc-075b-80ab-a258-cd3c31a46810" class="bulleted-list"><li style="list-style-type:disc">SPAM Filters (flags or blocks incoming emails based on reputation)</li></ul><ul id="2445b2cc-075b-808f-a123-eaad138b4aff" class="bulleted-list"><li style="list-style-type:disc">Email Labels (alert users that an incoming email is from an outside source)</li></ul><ul id="2445b2cc-075b-803f-bc5c-e309c7bdc71b" class="bulleted-list"><li style="list-style-type:disc">Email Address/Domain/URL Blocking (based on reputation or explicit denylist)</li></ul><ul id="2445b2cc-075b-8085-baae-f1c7dcb90047" class="bulleted-list"><li style="list-style-type:disc">Attachment Blocking (based on the extension of the attachment)</li></ul><ul id="2445b2cc-075b-809a-aa31-c0c3cb7da3fd" class="bulleted-list"><li style="list-style-type:disc">Attachment Sandboxing (detonating email attachments in a sandbox environment to detect malicious activity)</li></ul><ul id="2445b2cc-075b-809c-86dd-d508608d4587" class="bulleted-list"><li style="list-style-type:disc">Security Awareness Training (internal phishing campaigns)</li></ul><figure id="2445b2cc-075b-8055-a102-e61e44d08072" class="image"><a href="assets/DAB26E1B-460E-4FB3-ADB7-2F7B6E7B3231.png"><img style="width:2556px" src="assets/DAB26E1B-460E-4FB3-ADB7-2F7B6E7B3231.png"/></a></figure><p id="2445b2cc-075b-80e8-94ce-ee63ce332bbf" class="">
</p><h2 id="2445b2cc-075b-80f6-a097-d3b9b5d8ace2" class="">SPF (Sender Policy Framework)</h2><p id="2445b2cc-075b-8022-be36-da94f301e88e" class=""><a href="https://dmarcian.com/what-is-spf/">https://dmarcian.com/what-is-spf/</a></p><figure id="2445b2cc-075b-80c5-bbd9-edb6b39ae953" class="image"><a href="assets/image%20308.png"><img style="width:578px" src="assets/image%20308.png"/></a></figure><p id="2445b2cc-075b-806a-893d-e85293c88da7" class="">
</p><figure id="2445b2cc-075b-80b5-93ee-d3a1c1804876" class="image"><a href="assets/dmarcian-spf.png"><img style="width:578px" src="assets/dmarcian-spf.png"/></a></figure><p id="2445b2cc-075b-80ca-8200-ff9aae3f7076" class="">
</p><p id="2445b2cc-075b-80ac-81b5-f44edcefb59f" class="">
</p><p id="2445b2cc-075b-809b-af92-d0c7207ec430" class="">How does a basic SPF record look like?</p><p id="2445b2cc-075b-80e1-ae07-c92a0437ab95" class=""><code>v=spf1 ip4:127.0.0.1 include:_spf.google.com -all</code></p><p id="2445b2cc-075b-8051-ac43-f9dafbb75f13" class="">An explanation for the above record:</p><ul id="2445b2cc-075b-80f0-aeef-e3211ee52206" class="bulleted-list"><li style="list-style-type:disc"><code>v=spf1</code> -&gt; This is the start of the SPF record</li></ul><ul id="2445b2cc-075b-8000-b255-db4e3448b3d1" class="bulleted-list"><li style="list-style-type:disc"><code>ip4:127.0.0.1</code> -&gt; This specifies which IP (in this case version IP4 &amp; not IP6) can send mail</li></ul><ul id="2445b2cc-075b-8092-a640-dcd4b28306e6" class="bulleted-list"><li style="list-style-type:disc"><code>include:_spf.google.com</code> -&gt; This specifies which domain can send mail</li></ul><ul id="2445b2cc-075b-8019-aa92-d52159ceb46e" class="bulleted-list"><li style="list-style-type:disc"><code>all</code> -&gt; non-authorized emails will be rejected</li></ul><p id="2445b2cc-075b-80aa-ab81-f8ab4765e735" class="">
</p><p id="2445b2cc-075b-80fb-b8da-e7474ceaa9cb" class=""><a href="https://dmarcian.com/spf-syntax-table/">https://dmarcian.com/spf-syntax-table/</a></p><p id="2445b2cc-075b-80c6-8a0b-dabd37342f11" class=""><a href="https://dmarcian.com/spf-survey/">https://dmarcian.com/spf-survey/</a></p><p id="2445b2cc-075b-805c-9ef4-de591de570f6" class="">
</p><p id="2445b2cc-075b-8005-97fa-cb6ed4a51d71" class="">
</p><h2 id="2445b2cc-075b-809a-9a42-ff20344d4570" class="">DKIM (DomainKeys Identified Mail)</h2><p id="2445b2cc-075b-8043-aef2-f360e5b4a182" class=""><a href="https://dmarcian.com/what-is-dkim/">https://dmarcian.com/what-is-dkim/</a></p><figure id="2445b2cc-075b-80ea-8c77-cf5319878a84" class="image"><a href="assets/F53886D9-EFFA-4276-9597-DB4AC08E5007.png"><img style="width:578px" src="assets/F53886D9-EFFA-4276-9597-DB4AC08E5007.png"/></a></figure><figure id="2445b2cc-075b-80c3-9067-e05b5cbcf9ad" class="image"><a href="assets/Frame-1975-1-1024x555.webp"><img style="width:577.9833374023438px" src="assets/Frame-1975-1-1024x555.webp"/></a></figure><p id="2445b2cc-075b-803e-ab06-f3ad59e01670" class="">
</p><p id="2445b2cc-075b-8022-8762-fa89698536d6" class="">How does a DKIM record look like?</p><p id="2445b2cc-075b-80c3-8c45-cb4610a05619" class=""><code>v=DKIM1; k=rsa; <br/>p=MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAxTQIC7vZAHHZ7WVv/5x/qH1RAgMQI+y6Xtsn73rWOgeBQjHKbmIEIlgrebyWWFCXjmzIP0NYJrGehenmPWK5bF/TRDstbM8uVQCUWpoRAHzuhIxPSYW6k/w2+HdCECF2gnGmmw1cT6nHjfCyKGsM0On0HDvxP8I5YQIIlzNigP32n1hVnQP+UuInj0wLIdOBIWkHdnFewzGK2+qjF2wmEjx+vqHDnxdUTay5DfTGaqgA9AKjgXNjLEbKlEWvy0tj7UzQRHd24a5+2x/R4Pc7PF/y6OxAwYBZnEPO0sJwio4uqL9CYZcvaHGCLOIMwQmNTPMKGC9nt3PSjujfHUBX3wIDAQAB</code></p><p id="2445b2cc-075b-80f9-8ed7-e0d8bacd6a86" class="">An explanation of the above record:</p><ul id="2445b2cc-075b-80f7-998d-fce5cb686026" class="bulleted-list"><li style="list-style-type:disc"><code>v=DKIM1</code> -&gt; This is the version of the DKIM record. This is optional.</li></ul><ul id="2445b2cc-075b-8002-9730-f4aebd6c3e8f" class="bulleted-list"><li style="list-style-type:disc"><code>k=rsa</code> -&gt; This is the key type. The default value is RSA. RSA is an encryption algorithm (cryptosystem).</li></ul><ul id="2445b2cc-075b-807f-bf6a-c73ef81f2e32" class="bulleted-list"><li style="list-style-type:disc"><code>p=</code> -&gt; This is the public key that will be matched to the private key, which was created during the DKIM setup process.</li></ul><figure id="2445b2cc-075b-80bd-9161-f55d64712d1a" class="image"><a href="assets/2595F6D5-0B7B-45FC-8086-4EFCB7771FEB.png"><img style="width:578px" src="assets/2595F6D5-0B7B-45FC-8086-4EFCB7771FEB.png"/></a></figure><p id="2455b2cc-075b-8004-9705-f7017fb53eec" class="">
</p><h2 id="2445b2cc-075b-803e-8d96-df67e265c259" class="">DMARC (Domain-Based Message Authentication, Reporting, and Conformance)</h2><p id="2455b2cc-075b-8074-8ef7-c4fd865ea8e3" class=""><a href="https://dmarcian.com/getting-started-with-dmarc/">https://dmarcian.com/getting-started-with-dmarc/</a></p><p id="2455b2cc-075b-80ff-9879-c8db10b99e17" class=""><em>DMARC, (Domain-based¬† Message Authentication Reporting, &amp; Conformance) an open source standard, uses a concept called alignment to tie the result of two other open source standards, SPF (a published list of servers that are authorized to send email on behalf of a domain) and DKIM<br/>(a tamper-evident domain seal associated with a piece of email), to the content of an email. If not already deployed, putting a DMARC record into place for your domain will give you feedback that will allow you to troubleshoot your SPF and DKIM configurations if needed. </em>&quot;</p><p id="2455b2cc-075b-809c-87e1-e1259f5c4579" class="">How does a basic DMARC record look like?</p><p id="2455b2cc-075b-8085-a5f7-e5cce54ef60e" class=""><code>v=DMARC1; p=quarantine; rua=mailto:postmaster@website.com</code></p><p id="2455b2cc-075b-80ac-a22b-f1909328fc2a" class="">An explanation of the above record:</p><ul id="2455b2cc-075b-805f-8b45-ecde56c879d8" class="bulleted-list"><li style="list-style-type:disc"><code>v=DMARC1</code> -&gt; Must be in all caps, and it&#x27;s not optional</li></ul><ul id="2455b2cc-075b-80af-81a9-dd009e5d59b2" class="bulleted-list"><li style="list-style-type:disc"><code>p=quarantine</code> -&gt; If a check fails, then an email will be sent to the spam folder (DMARC Policy)</li></ul><ul id="2455b2cc-075b-804e-983c-e5f94b89b606" class="bulleted-list"><li style="list-style-type:disc"><code>rua=mailto:postmaster@website.com</code> -&gt; Aggregate reports will be sent to this email address</li></ul><p id="2455b2cc-075b-8031-af43-ddd11b6a93de" class="">Refer to the DMARC resources <a href="https://dmarcian.com/dmarc-record/">here </a> and <a href="https://dmarc.org/overview/">here </a>for additional information on DMARC tags. Review the following resource about DMARC <a href="https://dmarcian.com/alignment/">Alignment </a>.</p><p id="2455b2cc-075b-8020-95af-c29f66fd0e0a" class="">Let&#x27;s use the <strong>Domain Health Checker </strong> from <a href="https://dmarcian.com/domain-checker/">dmarcian.com </a>and check the DMARC status of <strong>microsoft.com</strong>.</p><figure id="2455b2cc-075b-8019-a91e-f1524f961553" class="image"><a href="https://tryhackme-images.s3.amazonaws.com/user-uploads/5de58e2bfac4a912bcc7a3e9/room-content/9b94a157faf86848b26093efb30c2126.png"><img src="https://tryhackme-images.s3.amazonaws.com/user-uploads/5de58e2bfac4a912bcc7a3e9/room-content/9b94a157faf86848b26093efb30c2126.png"/></a></figure><p id="2455b2cc-075b-806b-a40a-f9dafa7bc504" class="">And the results are...</p><figure id="2455b2cc-075b-80c9-9f59-db3531942507" class="image"><a href="https://tryhackme-images.s3.amazonaws.com/user-uploads/5de58e2bfac4a912bcc7a3e9/room-content/72bc9ea8efe179361c958a951f9db9fb.png"><img src="https://tryhackme-images.s3.amazonaws.com/user-uploads/5de58e2bfac4a912bcc7a3e9/room-content/72bc9ea8efe179361c958a951f9db9fb.png"/></a></figure><p id="2455b2cc-075b-80f6-a012-c296b5910ec3" class="">Microsoft passed all checks. We can drill down into¬†<strong>DMARC</strong>, <strong>SPF</strong>, or <strong>DKIM </strong> to get more details.</p><p id="2455b2cc-075b-80f6-9c5a-f9aea71d6dfc" class=""><strong>DMARC</strong>:</p><figure id="2455b2cc-075b-8065-8aa5-cce13ac2e051" class="image"><a href="https://tryhackme-images.s3.amazonaws.com/user-uploads/5de58e2bfac4a912bcc7a3e9/room-content/d0b2fc15e23d1466ff98efc98afef61e.png"><img src="https://tryhackme-images.s3.amazonaws.com/user-uploads/5de58e2bfac4a912bcc7a3e9/room-content/d0b2fc15e23d1466ff98efc98afef61e.png"/></a></figure><p id="2455b2cc-075b-80c2-8daf-dba52dd94318" class="">In the details above, we can see that all emails that fail the DMARC check will be rejected.</p><p id="2455b2cc-075b-80a6-9cfd-e7425970b8a8" class="">
</p><h2 id="2455b2cc-075b-80fe-9004-de2e11ddd2a2" class="">Summary</h2><hr id="2455b2cc-075b-8029-8a3f-f39799b1ebec"/><h3 id="2455b2cc-075b-8043-9f3f-e0446097fff0" class="">‚úÖ SPF (Sender Policy Framework)</h3><p id="2455b2cc-075b-8049-8798-dd74738cc40a" class=""><strong>Purpose:</strong> Verifies <strong>who is allowed to send email</strong> on behalf of a domain.</p><ul id="2455b2cc-075b-80d7-9c46-ebef835d46d1" class="bulleted-list"><li style="list-style-type:disc">The domain owner publishes an <strong>SPF record</strong> in DNS.</li></ul><ul id="2455b2cc-075b-803f-8b5c-fec6273c6cdc" class="bulleted-list"><li style="list-style-type:disc">It lists the IPs/domains allowed to send email for that domain.</li></ul><ul id="2455b2cc-075b-80cc-aa6d-dabd1b428285" class="bulleted-list"><li style="list-style-type:disc">If an email comes from an IP <strong>not listed</strong>, it fails SPF.</li></ul><p id="2455b2cc-075b-806b-bd85-c1a7cd93f3ea" class="">üìå <strong>SPF checks the sender‚Äôs IP.</strong> It does <strong>not</strong> protect against forged ‚ÄúFrom‚Äù headers that users see.</p><hr id="2455b2cc-075b-80dc-ae9a-cdf88da91e00"/><h3 id="2455b2cc-075b-808a-ba61-e2b7f452b6ad" class="">‚úÖ DKIM (DomainKeys Identified Mail)</h3><p id="2455b2cc-075b-80b2-b99c-f4f4309c80df" class=""><strong>Purpose:</strong> Verifies the <strong>content hasn&#x27;t been tampered</strong> with and that it <strong>came from the domain it claims</strong> to be from.</p><ul id="2455b2cc-075b-805f-8946-fefa65a0cd69" class="bulleted-list"><li style="list-style-type:disc">The sending mail server signs the email with a <strong>private key</strong>.</li></ul><ul id="2455b2cc-075b-8018-98dd-ff002e8cd6c0" class="bulleted-list"><li style="list-style-type:disc">The public key is published in DNS.</li></ul><ul id="2455b2cc-075b-801d-904d-d67d01f58bf3" class="bulleted-list"><li style="list-style-type:disc">Receiving servers use the public key to verify the signature.</li></ul><p id="2455b2cc-075b-809e-a09e-e63397d29252" class="">üìå <strong>DKIM checks integrity</strong> and <strong>authenticity</strong> of the message content and headers.</p><hr id="2455b2cc-075b-8025-a993-e9df23d6b767"/><h3 id="2455b2cc-075b-8089-aeaf-cb7fdf830798" class="">‚úÖ DMARC (Domain-based Message Authentication, Reporting, and Conformance)</h3><p id="2455b2cc-075b-80c6-aba7-fc4b8b8d52c9" class=""><strong>Purpose:</strong> Tells receiving servers <strong>how to handle emails that fail SPF and/or DKIM</strong> ‚Äî and gives <strong>reporting</strong> on abuse.</p><ul id="2455b2cc-075b-8028-8864-c6b283f09cbc" class="bulleted-list"><li style="list-style-type:disc">DMARC <strong>aligns SPF and DKIM with the visible &quot;From&quot; domain.</strong></li></ul><ul id="2455b2cc-075b-809e-99e1-f085596a97ea" class="bulleted-list"><li style="list-style-type:disc">Domain owner publishes a <strong>DMARC policy</strong> in DNS:<ul id="2455b2cc-075b-8072-84e8-f1337c7b5cea" class="bulleted-list"><li style="list-style-type:circle"><code>none</code>: monitor only</li></ul><ul id="2455b2cc-075b-8026-a065-da34acaf15bd" class="bulleted-list"><li style="list-style-type:circle"><code>quarantine</code>: mark as spam</li></ul><ul id="2455b2cc-075b-80d0-a005-ec8b2cf8d11d" class="bulleted-list"><li style="list-style-type:circle"><code>reject</code>: reject message outright</li></ul></li></ul><ul id="2455b2cc-075b-80a4-ba75-cba75e2066f8" class="bulleted-list"><li style="list-style-type:disc">Also allows the sender to receive <strong>reports</strong> about spoofed messages.</li></ul><p id="2455b2cc-075b-809e-8c48-fec66411f42f" class="">üìå <strong>DMARC enforces alignment</strong>: even if SPF or DKIM passes, if they <strong>don‚Äôt align with the ‚ÄúFrom‚Äù domain</strong>, it can still fail.</p><hr id="2455b2cc-075b-8090-9568-f71f1f6b98a2"/><h3 id="2455b2cc-075b-8091-ab39-ee84c8d2277c" class="">üí° Real World Example</h3><p id="2455b2cc-075b-80c3-a867-d346be14bc9e" class="">Let‚Äôs say a phishing email is sent claiming to be from <code>paypal.com</code>:</p><ul id="2455b2cc-075b-80f1-b71c-c05b5f9755ca" class="bulleted-list"><li style="list-style-type:disc"><strong>SPF</strong>: checks if the sending IP is authorized by PayPal.</li></ul><ul id="2455b2cc-075b-80d5-b418-c826ab3c97b6" class="bulleted-list"><li style="list-style-type:disc"><strong>DKIM</strong>: checks if the message was signed by PayPal&#x27;s private key.</li></ul><ul id="2455b2cc-075b-8097-8ab5-e225ab244f72" class="bulleted-list"><li style="list-style-type:disc"><strong>DMARC</strong>: if either SPF or DKIM passes <strong>AND</strong> aligns with the <code>From:</code> domain, the message passes. If not, DMARC policy says what to do (reject/quarantine/none).</li></ul><hr id="2455b2cc-075b-802b-84b9-cbdfd0e92378"/><p id="2455b2cc-075b-801c-bf89-eb69c55ac214" class="">
</p><h2 id="2455b2cc-075b-80c6-bebd-c6572453f0b6" class="">S/MIME (Secure/Multipurpose Internet Mail Extensions)</h2><p id="2455b2cc-075b-800a-93c6-da3b6bc4e4c1" class=""><a href="https://learn.microsoft.com/en-us/exchange/security-and-compliance/smime-exo/smime-exo">https://learn.microsoft.com/en-us/exchange/security-and-compliance/smime-exo/smime-exo</a></p><p id="2455b2cc-075b-804d-bb0e-f7967bb17857" class="">Per Microsoft, &quot;<em>S/MIME (Secure/Multipurpose internet Mail Extensions) is a widely accepted <br/>protocol for sending digitally signed and encrypted messages</em>.&quot;</p><p id="2455b2cc-075b-802c-999c-e21eb6a3d99b" class="">As you can tell from the definition above, the 2 main ingredients for S/MIME are:</p><ol type="1" id="2455b2cc-075b-8026-b5d4-e036239b4c6a" class="numbered-list" start="1"><li><strong>Digital Signatures</strong></li></ol><ol type="1" id="2455b2cc-075b-8004-86f6-cf61bce399c9" class="numbered-list" start="2"><li><strong>Encryption</strong></li></ol><p id="2455b2cc-075b-807f-961a-fc33f91b6d90" class="">Using <a href="https://www.ibm.com/docs/en/ztpf/2023?topic=concepts-public-key-cryptography">Public Key Cryptography</a>, S/MIME guarantees data integrity and nonrepudiation.</p><ul id="2455b2cc-075b-8045-bfd8-e3c3470cae6f" class="bulleted-list"><li style="list-style-type:disc">If Bob wishes to use S/MIME, then he&#x27;ll need a digital certificate. This digital certificate will contain his public key.</li></ul><ul id="2455b2cc-075b-8050-8caf-dd8d89167c87" class="bulleted-list"><li style="list-style-type:disc">With this digital certificate, Bob can &quot;sign&quot; the email message with his private key.</li></ul><ul id="2455b2cc-075b-80e5-86a2-c6e3faf5a3b6" class="bulleted-list"><li style="list-style-type:disc">Mary can then decrypt Bob&#x27;s message with Bob&#x27;s public key.</li></ul><ul id="2455b2cc-075b-80cd-bd17-e0d97d0b0667" class="bulleted-list"><li style="list-style-type:disc">Mary will do the same (send her certificate to Bob) when she replies to his email, and Bob complete the same process on his end.</li></ul><ul id="2455b2cc-075b-80a7-8822-e3df86943e0b" class="bulleted-list"><li style="list-style-type:disc">Both will now have each other&#x27;s certificates for future correspondence.</li></ul><p id="2455b2cc-075b-80b2-bc2d-e35133b609e3" class="">The illustration below will help you understand how public key cryptography works.</p><figure id="2455b2cc-075b-8009-876f-d3d9e88d77e1" class="image"><a href="https://tryhackme-images.s3.amazonaws.com/user-uploads/5c549500924ec576f953d9fc/room-content/27cb0b439d172324f453e57c9cbf7ac0.png"><img src="https://tryhackme-images.s3.amazonaws.com/user-uploads/5c549500924ec576f953d9fc/room-content/27cb0b439d172324f453e57c9cbf7ac0.png"/></a></figure><p id="2455b2cc-075b-803d-9c7c-fbdb629734c6" class="">Refer to this Microsoft documentation <a href="https://docs.microsoft.com/en-us/exchange/security-and-compliance/smime-exo/smime-exo">here </a> for more information on S/MIME and steps on how to configure Office 365 to send/receive S/MIME emails.</p><p id="2455b2cc-075b-802d-bbd9-d73e777efb0c" class="">
</p><h3 id="2455b2cc-075b-804c-9ab8-c9874da10bb3" class="">If DKIM and S/MIME seems the same, here are the differences</h3><table id="2455b2cc-075b-80b6-b104-d580d3bddc92" class="simple-table"><thead class="simple-table-header"><tr id="2455b2cc-075b-804d-917a-e1b0389f339e"><th id="GrWM" class="simple-table-header-color simple-table-header">Feature</th><th id="`xcj" class="simple-table-header-color simple-table-header" style="width:294px"><strong>DKIM</strong></th><th id="FeWy" class="simple-table-header-color simple-table-header" style="width:324px"><strong>S/MIME</strong></th></tr></thead><tbody><tr id="2455b2cc-075b-8015-9683-f0c9b63687f9"><td id="GrWM" class=""><strong>What it does</strong></td><td id="`xcj" class="" style="width:294px">Signs emails <strong>at the domain level</strong></td><td id="FeWy" class="" style="width:324px">Signs and optionally encrypts emails <strong>per user</strong></td></tr><tr id="2455b2cc-075b-80a1-a624-f66768fb107b"><td id="GrWM" class=""><strong>Who signs</strong></td><td id="`xcj" class="" style="width:294px">Mail server (uses domain&#x27;s private key)</td><td id="FeWy" class="" style="width:324px">Sender‚Äôs email client (uses personal certificate)</td></tr><tr id="2455b2cc-075b-80bb-b9dc-fb54aca696b2"><td id="GrWM" class=""><strong>Key location</strong></td><td id="`xcj" class="" style="width:294px">Public key published in <strong>DNS</strong></td><td id="FeWy" class="" style="width:324px">Public key in <strong>X.509 certificate</strong>, often shared via <strong>directory or attachment</strong></td></tr><tr id="2455b2cc-075b-801a-b0b3-cbfa6f1b7c0e"><td id="GrWM" class=""><strong>Purpose</strong></td><td id="`xcj" class="" style="width:294px">Prove domain ownership, ensure message integrity</td><td id="FeWy" class="" style="width:324px">Prove <strong>sender identity</strong> (person), ensure <strong>confidentiality &amp; integrity</strong></td></tr><tr id="2455b2cc-075b-802c-afc5-de0c58d588a9"><td id="GrWM" class=""><strong>Encryption?</strong></td><td id="`xcj" class="" style="width:294px">‚ùå No encryption, just signing</td><td id="FeWy" class="" style="width:324px">‚úÖ Can <strong>sign</strong> and <strong>encrypt</strong> emails</td></tr><tr id="2455b2cc-075b-8070-9e0f-dd3c8966b27d"><td id="GrWM" class=""><strong>Used by whom</strong></td><td id="`xcj" class="" style="width:294px">Mostly mail servers / domain admins</td><td id="FeWy" class="" style="width:324px">End users or enterprises managing user certs</td></tr><tr id="2455b2cc-075b-8084-8a9e-c295de7aa8df"><td id="GrWM" class=""><strong>Common use case</strong></td><td id="`xcj" class="" style="width:294px">Spam protection, domain spoofing defense</td><td id="FeWy" class="" style="width:324px">Secure personal/business email comms (e.g., lawyers, gov, etc.)</td></tr></tbody></table><h3 id="2455b2cc-075b-80e0-9e62-c8953e77164f" class="">üîç Example Use Case</h3><ul id="2455b2cc-075b-8070-a7e9-fd22d1d00d9e" class="bulleted-list"><li style="list-style-type:disc"><strong>DKIM</strong>: Your company (<code>company.com</code>) sets up DKIM so that recipients know emails claiming to be from <code>@company.com</code> are legit, and weren‚Äôt tampered with.</li></ul><ul id="2455b2cc-075b-80c6-a0c8-e66aade6b214" class="bulleted-list"><li style="list-style-type:disc"><strong>S/MIME</strong>: A lawyer sends a signed and encrypted email to a client to ensure only they can read it ‚Äî S/MIME is used for this <strong>person-to-person encryption</strong>.</li></ul><h3 id="2455b2cc-075b-802f-8cfa-e39384c29b48" class="">‚ö†Ô∏è Important</h3><ul id="2455b2cc-075b-807e-a2ee-d0df42dce12d" class="bulleted-list"><li style="list-style-type:disc"><strong>DKIM protects the domain reputation.</strong></li></ul><ul id="2455b2cc-075b-8031-89db-e77e01969630" class="bulleted-list"><li style="list-style-type:disc"><strong>S/MIME protects the actual communication between people.</strong></li></ul><p id="2455b2cc-075b-806c-b1c9-e5e515ca9612" class="">They serve <strong>complementary but distinct roles</strong>.</p><p id="2455b2cc-075b-8029-a506-d9021a1f7859" class="">
</p><h2 id="2455b2cc-075b-8092-b001-d5bad38b6960" class="">SMTP Status Codes</h2><p id="2455b2cc-075b-80b7-b575-c802c2db42c7" class=""><a href="https://www.mailersend.com/blog/smtp-codes">https://www.mailersend.com/blog/smtp-codes</a></p><p id="2455b2cc-075b-80dc-b440-f0a8b7e49bbc" class=""><a href="https://www.wireshark.org/docs/dfref/s/smtp.html">https://www.wireshark.org/docs/dfref/s/smtp.html</a></p><figure id="2455b2cc-075b-80b8-9d2e-ff8bf45cbaa0" class="image"><a href="assets/47E24EE4-7DE3-4F3E-98CD-4A07ACD0F5F1.png"><img style="width:620px" src="assets/47E24EE4-7DE3-4F3E-98CD-4A07ACD0F5F1.png"/></a></figure><figure id="2455b2cc-075b-8066-a664-c0db946ddfbe" class="image"><a href="assets/DAB49B77-1A81-42B1-A3C5-95D220F0AC54.png"><img style="width:619.9833374023438px" src="assets/DAB49B77-1A81-42B1-A3C5-95D220F0AC54.png"/></a></figure><p id="2455b2cc-075b-80f6-9646-dbcd741ff4c2" class="">
</p><h2 id="2455b2cc-075b-8029-81b4-db8c853d07f6" class="">SMTP Traffic Analysis</h2><p id="2455b2cc-075b-80fb-aedf-e8b3488c5330" class="">
</p><p id="2455b2cc-075b-80f0-a84a-f1135ad38403" class=""><a href="https://www.wireshark.org/docs/dfref/i/imf.html">https://www.wireshark.org/docs/dfref/i/imf.html</a></p><ul id="2455b2cc-075b-807a-bc2b-e3a001cfe06f" class="bulleted-list"><li style="list-style-type:disc">What port is the SMTP traffic using?<br/>25</li></ul><ul id="2455b2cc-075b-8056-92b7-d0b1ccdd9234" class="bulleted-list"><li style="list-style-type:disc">How many packets are specifically SMTP?<br/>use filter smtp = 512</li></ul><ul id="2455b2cc-075b-80c7-b695-e134e6f9763f" class="bulleted-list"><li style="list-style-type:disc">What is the source IP address for all the SMTP traffic?<br/>10.12.19.101</li></ul><ul id="2455b2cc-075b-8034-8ab0-c37e3a89691b" class="bulleted-list"><li style="list-style-type:disc">What is the filename of the third file attachment?<br/>I had to do some research, then I found out that the emails with attachment will have a content type header, so i used that and found the name of the attachment</li></ul><figure id="2455b2cc-075b-8074-8926-cdde3eb9c447" class="image"><a href="assets/4479023A-3A8E-44D5-9BAC-2862681750F6.png"><img style="width:620px" src="assets/4479023A-3A8E-44D5-9BAC-2862681750F6.png"/></a></figure><ul id="2455b2cc-075b-80ba-a295-f386b6269219" class="bulleted-list"><li style="list-style-type:disc">How about the last file attachment?</li></ul><figure id="2455b2cc-075b-8026-b640-e3b8905a7795" class="image"><a href="assets/264A9357-B6B9-425D-AA18-F692B032FB39.png"><img style="width:620px" src="assets/264A9357-B6B9-425D-AA18-F692B032FB39.png"/></a></figure><p id="2455b2cc-075b-808e-a2c3-dbeb72ed93e6" class="">
</p><h2 id="2455b2cc-075b-80d0-8914-c8d6fcf855f3" class="">SMTP and C&amp;C Communication</h2><p id="2455b2cc-075b-805e-881e-c987ba761182" class="">
</p><p id="2455b2cc-075b-8079-be75-e3247dd63d7f" class="">Now we&#x27;ll take a look at how SMTP has been abused by adversaries for C2 (Command and Control) communications.</p><p id="2455b2cc-075b-8018-a787-c327b21ba043" class=""><strong>MITRE ATT&amp;CK</strong>:</p><ul id="2455b2cc-075b-8004-9a6d-c54156f48cfc" class="bulleted-list"><li style="list-style-type:disc"><strong>Technique 1071 &gt; Sub-Technique 3</strong>:¬†<a href="https://attack.mitre.org/techniques/T1071/003/">https://attack.mitre.org/techniques/T1071/003/</a></li></ul><p id="2455b2cc-075b-80f8-9770-f960fae77147" class="">Per MITRE, &quot;<em>Adversaries may communicate using application layer protocols associated with electronic mail delivery to avoid detection/network filtering by blending in with existing traffic. Commands to the remote system, and often the results of those commands, will be embedded within the protocol traffic between the client and server.</em>&quot;</p><p id="2455b2cc-075b-80eb-971e-e12c974c238a" class="">Several notable groups, such as <strong>APT 28</strong>, <strong>APT 32</strong>, and <strong>Turla</strong>, to name a few, have used this technique.</p><p id="2455b2cc-075b-8055-aad8-f12c612b11bf" class=""><strong>Recommended mitigation (per MITRE)</strong>:</p><p id="2455b2cc-075b-803f-b14f-fcfa587e7dfb" class="">&quot;<em>Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level.</em>&quot;</p><p id="2455b2cc-075b-807d-8dc6-c2cb72c47ae5" class=""><strong>Detection opportunity (per MITRE)</strong>:</p><p id="2455b2cc-075b-80d0-a085-c6d613e561f2" class="">&quot;<em>Analyze packet contents to detect application layer protocols that do not follow the expected protocol standards regarding syntax, structure, or any other variable adversaries could leverage to conceal data.</em>&quot;</p><p id="2455b2cc-075b-8080-9344-d809c086c6fb" class="">
</p><ul id="2455b2cc-075b-80f7-9ebf-c6772f0c5305" class="bulleted-list"><li style="list-style-type:disc">Per MITRE ATT&amp;CK, which software is associated with using SMTP and POP3 for C2 communications?</li></ul><p id="2455b2cc-075b-80b1-bacc-f671d27739f3" class=""><a href="https://attack.mitre.org/software/S0251/">https://attack.mitre.org/software/S0251/</a></p><p id="2455b2cc-075b-8099-b9e7-d330009854ff" class="">
</p><h2 id="2455b2cc-075b-805f-982f-f9413dffb75e" class="">Coclusion</h2><p id="2455b2cc-075b-8084-94f6-ed608d03bbf4" class=""><a href="https://github.com/counteractive/incident-response-plan-template/blob/master/playbooks/playbook-phishing.md">https://github.com/counteractive/incident-response-plan-template/blob/master/playbooks/playbook-phishing.md</a></p><p id="2455b2cc-075b-800b-8b15-f97a5029e783" class=""><a href="http://www.malware-traffic-analysis.net/2018/12/19/index.html">http://www.malware-traffic-analysis.net/2018/12/19/index.html</a></p><p id="2455b2cc-075b-8064-9aef-db0b0253b879" class="">
</p></div></article><span class="sans" style="font-size:14px;padding-top:2em"></span></body></html>