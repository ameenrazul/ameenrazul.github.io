<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>Linux Forensics</title><style>
/* cspell:disable-file */
/* webkit printing magic: print all background colors */
html {
	-webkit-print-color-adjust: exact;
}
* {
	box-sizing: border-box;
	-webkit-print-color-adjust: exact;
}

html,
body {
	margin: 0;
	padding: 0;
}
@media only screen {
	body {
		margin: 2em auto;
		max-width: 900px;
		color: rgb(55, 53, 47);
	}
}

body {
	line-height: 1.5;
	white-space: pre-wrap;
}

a,
a.visited {
	color: inherit;
	text-decoration: underline;
}

.pdf-relative-link-path {
	font-size: 80%;
	color: #444;
}

h1,
h2,
h3 {
	letter-spacing: -0.01em;
	line-height: 1.2;
	font-weight: 600;
	margin-bottom: 0;
}

.page-title {
	font-size: 2.5rem;
	font-weight: 700;
	margin-top: 0;
	margin-bottom: 0.75em;
}

h1 {
	font-size: 1.875rem;
	margin-top: 1.875rem;
}

h2 {
	font-size: 1.5rem;
	margin-top: 1.5rem;
}

h3 {
	font-size: 1.25rem;
	margin-top: 1.25rem;
}

.source {
	border: 1px solid #ddd;
	border-radius: 3px;
	padding: 1.5em;
	word-break: break-all;
}

.callout {
	border-radius: 3px;
	padding: 1rem;
}

figure {
	margin: 1.25em 0;
	page-break-inside: avoid;
}

figcaption {
	opacity: 0.5;
	font-size: 85%;
	margin-top: 0.5em;
}

mark {
	background-color: transparent;
}

.indented {
	padding-left: 1.5em;
}

hr {
	background: transparent;
	display: block;
	width: 100%;
	height: 1px;
	visibility: visible;
	border: none;
	border-bottom: 1px solid rgba(55, 53, 47, 0.09);
}

img {
	max-width: 100%;
}

@media only print {
	img {
		max-height: 100vh;
		object-fit: contain;
	}
}

@page {
	margin: 1in;
}

.collection-content {
	font-size: 0.875rem;
}

.column-list {
	display: flex;
	justify-content: space-between;
}

.column {
	padding: 0 1em;
}

.column:first-child {
	padding-left: 0;
}

.column:last-child {
	padding-right: 0;
}

.table_of_contents-item {
	display: block;
	font-size: 0.875rem;
	line-height: 1.3;
	padding: 0.125rem;
}

.table_of_contents-indent-1 {
	margin-left: 1.5rem;
}

.table_of_contents-indent-2 {
	margin-left: 3rem;
}

.table_of_contents-indent-3 {
	margin-left: 4.5rem;
}

.table_of_contents-link {
	text-decoration: none;
	opacity: 0.7;
	border-bottom: 1px solid rgba(55, 53, 47, 0.18);
}

table,
th,
td {
	border: 1px solid rgba(55, 53, 47, 0.09);
	border-collapse: collapse;
}

table {
	border-left: none;
	border-right: none;
}

th,
td {
	font-weight: normal;
	padding: 0.25em 0.5em;
	line-height: 1.5;
	min-height: 1.5em;
	text-align: left;
}

th {
	color: rgba(55, 53, 47, 0.6);
}

ol,
ul {
	margin: 0;
	margin-block-start: 0.6em;
	margin-block-end: 0.6em;
}

li > ol:first-child,
li > ul:first-child {
	margin-block-start: 0.6em;
}

ul > li {
	list-style: disc;
}

ul.to-do-list {
	padding-inline-start: 0;
}

ul.to-do-list > li {
	list-style: none;
}

.to-do-children-checked {
	text-decoration: line-through;
	opacity: 0.375;
}

ul.toggle > li {
	list-style: none;
}

ul {
	padding-inline-start: 1.7em;
}

ul > li {
	padding-left: 0.1em;
}

ol {
	padding-inline-start: 1.6em;
}

ol > li {
	padding-left: 0.2em;
}

.mono ol {
	padding-inline-start: 2em;
}

.mono ol > li {
	text-indent: -0.4em;
}

.toggle {
	padding-inline-start: 0em;
	list-style-type: none;
}

/* Indent toggle children */
.toggle > li > details {
	padding-left: 1.7em;
}

.toggle > li > details > summary {
	margin-left: -1.1em;
}

.selected-value {
	display: inline-block;
	padding: 0 0.5em;
	background: rgba(206, 205, 202, 0.5);
	border-radius: 3px;
	margin-right: 0.5em;
	margin-top: 0.3em;
	margin-bottom: 0.3em;
	white-space: nowrap;
}

.collection-title {
	display: inline-block;
	margin-right: 1em;
}

.page-description {
	margin-bottom: 2em;
}

.simple-table {
	margin-top: 1em;
	font-size: 0.875rem;
	empty-cells: show;
}
.simple-table td {
	height: 29px;
	min-width: 120px;
}

.simple-table th {
	height: 29px;
	min-width: 120px;
}

.simple-table-header-color {
	background: rgb(247, 246, 243);
	color: black;
}
.simple-table-header {
	font-weight: 500;
}

time {
	opacity: 0.5;
}

.icon {
	display: inline-block;
	max-width: 1.2em;
	max-height: 1.2em;
	text-decoration: none;
	vertical-align: text-bottom;
	margin-right: 0.5em;
}

img.icon {
	border-radius: 3px;
}

.user-icon {
	width: 1.5em;
	height: 1.5em;
	border-radius: 100%;
	margin-right: 0.5rem;
}

.user-icon-inner {
	font-size: 0.8em;
}

.text-icon {
	border: 1px solid #000;
	text-align: center;
}

.page-cover-image {
	display: block;
	object-fit: cover;
	width: 100%;
	max-height: 30vh;
}

.page-header-icon {
	font-size: 3rem;
	margin-bottom: 1rem;
}

.page-header-icon-with-cover {
	margin-top: -0.72em;
	margin-left: 0.07em;
}

.page-header-icon img {
	border-radius: 3px;
}

.link-to-page {
	margin: 1em 0;
	padding: 0;
	border: none;
	font-weight: 500;
}

p > .user {
	opacity: 0.5;
}

td > .user,
td > time {
	white-space: nowrap;
}

input[type="checkbox"] {
	transform: scale(1.5);
	margin-right: 0.6em;
	vertical-align: middle;
}

p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.image {
	border: none;
	margin: 1.5em 0;
	padding: 0;
	border-radius: 0;
	text-align: center;
}

.code,
code {
	background: rgba(135, 131, 120, 0.15);
	border-radius: 3px;
	padding: 0.2em 0.4em;
	border-radius: 3px;
	font-size: 85%;
	tab-size: 2;
}

code {
	color: #eb5757;
}

.code {
	padding: 1.5em 1em;
}

.code-wrap {
	white-space: pre-wrap;
	word-break: break-all;
}

.code > code {
	background: none;
	padding: 0;
	font-size: 100%;
	color: inherit;
}

blockquote {
	font-size: 1.25em;
	margin: 1em 0;
	padding-left: 1em;
	border-left: 3px solid rgb(55, 53, 47);
}

.bookmark {
	text-decoration: none;
	max-height: 8em;
	padding: 0;
	display: flex;
	width: 100%;
	align-items: stretch;
}

.bookmark-title {
	font-size: 0.85em;
	overflow: hidden;
	text-overflow: ellipsis;
	height: 1.75em;
	white-space: nowrap;
}

.bookmark-text {
	display: flex;
	flex-direction: column;
}

.bookmark-info {
	flex: 4 1 180px;
	padding: 12px 14px 14px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
}

.bookmark-image {
	width: 33%;
	flex: 1 1 180px;
	display: block;
	position: relative;
	object-fit: cover;
	border-radius: 1px;
}

.bookmark-description {
	color: rgba(55, 53, 47, 0.6);
	font-size: 0.75em;
	overflow: hidden;
	max-height: 4.5em;
	word-break: break-word;
}

.bookmark-href {
	font-size: 0.75em;
	margin-top: 0.25em;
}

.sans { font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
.code { font-family: "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; }
.serif { font-family: Lyon-Text, Georgia, ui-serif, serif; }
.mono { font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; }
.pdf .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK JP'; }
.pdf:lang(zh-CN) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC'; }
.pdf:lang(zh-TW) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK TC'; }
.pdf:lang(ko-KR) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK KR'; }
.pdf .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK JP'; }
.pdf:lang(zh-CN) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK SC'; }
.pdf:lang(zh-TW) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK TC'; }
.pdf:lang(ko-KR) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK KR'; }
.pdf .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.highlight-default {
	color: rgba(50, 48, 44, 1);
}
.highlight-gray {
	color: rgba(115, 114, 110, 1);
	fill: rgba(115, 114, 110, 1);
}
.highlight-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.highlight-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.highlight-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.highlight-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.highlight-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.highlight-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.highlight-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.highlight-red {
	color: rgba(205, 60, 58, 1);
	fill: rgba(205, 60, 58, 1);
}
.highlight-default_background {
	color: rgba(50, 48, 44, 1);
}
.highlight-gray_background {
	background: rgba(248, 248, 247, 1);
}
.highlight-brown_background {
	background: rgba(244, 238, 238, 1);
}
.highlight-orange_background {
	background: rgba(251, 236, 221, 1);
}
.highlight-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.highlight-teal_background {
	background: rgba(237, 243, 236, 1);
}
.highlight-blue_background {
	background: rgba(231, 243, 248, 1);
}
.highlight-purple_background {
	background: rgba(248, 243, 252, 1);
}
.highlight-pink_background {
	background: rgba(252, 241, 246, 1);
}
.highlight-red_background {
	background: rgba(253, 235, 236, 1);
}
.block-color-default {
	color: inherit;
	fill: inherit;
}
.block-color-gray {
	color: rgba(115, 114, 110, 1);
	fill: rgba(115, 114, 110, 1);
}
.block-color-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.block-color-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.block-color-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.block-color-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.block-color-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.block-color-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.block-color-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.block-color-red {
	color: rgba(205, 60, 58, 1);
	fill: rgba(205, 60, 58, 1);
}
.block-color-default_background {
	color: inherit;
	fill: inherit;
}
.block-color-gray_background {
	background: rgba(248, 248, 247, 1);
}
.block-color-brown_background {
	background: rgba(244, 238, 238, 1);
}
.block-color-orange_background {
	background: rgba(251, 236, 221, 1);
}
.block-color-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.block-color-teal_background {
	background: rgba(237, 243, 236, 1);
}
.block-color-blue_background {
	background: rgba(231, 243, 248, 1);
}
.block-color-purple_background {
	background: rgba(248, 243, 252, 1);
}
.block-color-pink_background {
	background: rgba(252, 241, 246, 1);
}
.block-color-red_background {
	background: rgba(253, 235, 236, 1);
}
.select-value-color-default { background-color: rgba(84, 72, 49, 0.08); }
.select-value-color-gray { background-color: rgba(84, 72, 49, 0.15); }
.select-value-color-brown { background-color: rgba(210, 162, 141, 0.35); }
.select-value-color-orange { background-color: rgba(224, 124, 57, 0.27); }
.select-value-color-yellow { background-color: rgba(236, 191, 66, 0.39); }
.select-value-color-green { background-color: rgba(123, 183, 129, 0.27); }
.select-value-color-blue { background-color: rgba(93, 165, 206, 0.27); }
.select-value-color-purple { background-color: rgba(168, 129, 197, 0.27); }
.select-value-color-pink { background-color: rgba(225, 136, 179, 0.27); }
.select-value-color-red { background-color: rgba(244, 171, 159, 0.4); }

.checkbox {
	display: inline-flex;
	vertical-align: text-bottom;
	width: 16;
	height: 16;
	background-size: 16px;
	margin-left: 2px;
	margin-right: 5px;
}

.checkbox-on {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
}

.checkbox-off {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
}
	
</style></head><body><article id="2395b2cc-075b-8072-b7cc-fa8140f584f6" class="page sans"><header><div class="page-header-icon undefined"><img class="icon" src="https://tryhackme-images.s3.amazonaws.com/room-icons/5b1eb3e74900aa4cb2d28dca730e649a.png"/></div><h1 class="page-title">Linux Forensics</h1><p class="page-description"></p></header><div class="page-body"><h3 id="2395b2cc-075b-8019-be7c-e7f69003adef" class="">OS and account information</h3><p id="2385b2cc-075b-801a-8a9c-c646d75d2736" class="">To find the OS release information, we can use the <code>cat</code> utility to read the file located at <code>/etc/os-release</code></p><figure id="2385b2cc-075b-8030-8be1-febb818689b6" class="image"><a href="assets/image%20286.png"><img style="width:620px" src="assets/image%20286.png"/></a></figure><h3 id="2385b2cc-075b-8085-9e93-c7ebef3a7c12" class=""><strong>User accounts</strong></h3><p id="2385b2cc-075b-807a-a352-d98867522087" class="">The <code>/etc/passwd</code> file contains information about the user accounts that exist on a Linux system. We can use the <code>cat</code> utility to read this file. The output contains 7 colon-separated fields, describing username, password information, user id (uid), group id (gid), description, home directory information, and the default shell that executes when the user logs in. It can be noticed that just like Windows, the user-created user accounts have uids 1000 or above. You can use the following command to make it more readable:</p><figure id="2385b2cc-075b-8053-bf24-f8bcccd673d0" class="image"><a href="assets/image%20287.png"><img style="width:620px" src="assets/image%20287.png"/></a></figure><p id="2385b2cc-075b-8033-a661-d4cc1eeeca23" class="">
</p><h3 id="2385b2cc-075b-806f-be90-d80ed069b35a" class=""><strong>Group Information</strong></h3><p id="2385b2cc-075b-800b-b40f-c2529b2f8dd4" class="">The <code>/etc/group</code> file contains information about the different user groups present on the host. It can be read using the cat utility.</p><figure id="2385b2cc-075b-8072-97a4-c56586ebbf5c" class="image"><a href="assets/image%20288.png"><img style="width:619.9666748046875px" src="assets/image%20288.png"/></a></figure><h3 id="2385b2cc-075b-8015-9125-c328a72d2d6a" class=""><strong>Sudoers List</strong></h3><p id="2385b2cc-075b-808c-b9f3-d291e814fd27" class="">A Linux host allows only those users to elevate privileges to <code>sudo</code>, which are present in the Sudoers list. This list is stored in the file <code>/etc/sudoers</code> and can be read using the <code>cat</code> utility. You will need to elevate privileges to access this file.</p><figure id="2385b2cc-075b-8040-96e5-fd721403f468" class="image"><a href="assets/image%20289.png"><img style="width:620px" src="assets/image%20289.png"/></a></figure><h3 id="2385b2cc-075b-8012-9674-e887d0f3abc1" class=""><strong>Login information</strong></h3><p id="2385b2cc-075b-8067-b141-e161e2a07de7" class="">In the /var/log directory, we can find log files of all kind including  <code>wtmp</code>  and <code>btmp</code> .The <code>btmp</code> file saves information about failed logins, while the <code>wtmp</code> keeps historical data of logins. These files are not regular text files that can be read using  <code>cat</code>, <code>less</code> or <code>vim</code>; instead, they are binary files, which have to be read using the  <code>last</code> utility. You can learn more about the <code>last</code> utility by reading its man page.</p><p id="2385b2cc-075b-8053-ba77-fac1dbfd7e38" class="">The following terminal shows the contents of <code>wtmp</code> being read using the <code>last</code> utility.</p><figure id="2385b2cc-075b-8051-a61e-c65f26b5c74a" class="image"><a href="assets/image%20290.png"><img style="width:619.9833374023438px" src="assets/image%20290.png"/></a></figure><p id="2385b2cc-075b-80ad-8272-ce878b31c2cb" class="">
</p><h3 id="2385b2cc-075b-80e6-9ece-d75eb9d20d7c" class=""><strong>Authentication logs</strong></h3><p id="2385b2cc-075b-80e8-b24a-e1fdf64c4b46" class="">Every user that authenticates on a Linux host is logged in the auth log. The auth log is a file placed in the location <code>/var/log/auth.log</code>. It can be read using the <code>cat</code> utility, however, given the size of the file, we can use <code>tail</code>, <code>head</code>, <code>more</code> or <code>less</code> utilities to make it easier to read.</p><figure id="2385b2cc-075b-80fa-aa3f-cb07212c03b6" class="image"><a href="assets/image%20291.png"><img style="width:620px" src="assets/image%20291.png"/></a></figure><p id="2385b2cc-075b-8090-87a2-fc36f0ad0e45" class="">
</p><ul id="2385b2cc-075b-80da-8bbd-ed203bb4dfd2" class="bulleted-list"><li style="list-style-type:disc">Which two users are the members of the group <code>audio</code>?<br/>I can use grep to find this out from the /etc/group using cat</li></ul><figure id="2385b2cc-075b-80f6-bbc8-d5ffaa67bcbd" class="image"><a href="assets/image%20292.png"><img style="width:619.9833374023438px" src="assets/image%20292.png"/></a></figure><ul id="2385b2cc-075b-800c-9e7f-cd57e7960f8d" class="bulleted-list"><li style="list-style-type:disc">In the attached VM, there is a user account named tryhackme. What is the uid of this account?</li></ul><p id="2385b2cc-075b-8059-8b81-e3f0210749f2" class="">I can read the /etc/passwd file to get this answer</p><ul id="2385b2cc-075b-8050-b8c6-d5beb2fb38c0" class="bulleted-list"><li style="list-style-type:disc">A session was started on this machine on Sat Apr 16 20:10. How long did this session last?</li></ul><p id="2385b2cc-075b-807f-9747-efafad541ba1" class="">I can read /var/log/wtmp and get this info</p><figure id="2385b2cc-075b-8060-880d-e961717fdbf1" class="image"><a href="assets/image%20293.png"><img style="width:619.9666748046875px" src="assets/image%20293.png"/></a></figure><p id="2385b2cc-075b-8067-bb97-c405fdfd92ba" class="">
</p><h3 id="2385b2cc-075b-801b-95aa-f01ca25be0f1" class="">System Configuration</h3><p id="2385b2cc-075b-80f9-9335-ddc8908abf20" class="">The <mark class="highlight-pink">hostname</mark> is stored in the <code>/etc/hostname</code> file on a Linux Host. It can be accessed using the <code>cat</code> utility<br/><br/><mark class="highlight-pink">Timezone information</mark> can be found at the location<code> /etc/timezone</code> and it can be read using the <code>cat</code> utility</p><p id="2385b2cc-075b-805d-bcde-ec48129ff833" class=""><br/>information about the <mark class="highlight-pink">network interfaces</mark>, we can <code>cat</code> the <code>/etc/network/interfaces</code> file<br/></p><p id="2385b2cc-075b-80b0-a1e0-fc90e9a25c42" class="">We can use the <code>netstat</code> utility to find <mark class="highlight-pink">active network connections</mark> on a Linux host.<br/><strong>netstat -natp</strong></p><figure id="2385b2cc-075b-8099-9f9a-e4005fb9b1fd" class="image"><a href="assets/77B73A2F-D9DA-421D-9A64-235E103870B0.png"><img style="width:708.6651000976562px" src="assets/77B73A2F-D9DA-421D-9A64-235E103870B0.png"/></a></figure><p id="2385b2cc-075b-8083-8f71-ca46294f3785" class="">The <code>ps</code> utility shows details about the <mark class="highlight-pink">running processes</mark><br/><br/></p><ul id="2385b2cc-075b-809b-b7f6-dcc0676f0c70" class="bulleted-list"><li style="list-style-type:disc"><code><strong>a</strong></code>: Shows processes for all users, not just those associated with the current terminal.</li></ul><ul id="2385b2cc-075b-80e9-8c5b-ddc2cc027ae2" class="bulleted-list"><li style="list-style-type:disc"><code><strong>u</strong></code>: Displays the process&#x27;s user/owner.</li></ul><ul id="2385b2cc-075b-8069-a0ee-f06d807eaf65" class="bulleted-list"><li style="list-style-type:disc"><code><strong>x</strong></code>: Includes processes that do not have a controlling terminal.</li></ul><figure id="2385b2cc-075b-808b-ab88-f0e665b668e3" class="image"><a href="assets/C46408AA-F9B8-4140-B27E-2067980D58FE.png"><img style="width:708.5943603515625px" src="assets/C46408AA-F9B8-4140-B27E-2067980D58FE.png"/></a></figure><p id="2385b2cc-075b-80a8-9b3c-f8f35da7501c" class=""><mark class="highlight-pink"><strong>DNS</strong></mark></p><p id="2385b2cc-075b-804f-a168-d8aebdbd40c1" class="">The file <code>/etc/hosts</code> contains the configuration for the DNS name assignment<br/><br/>The information about<mark class="highlight-pink"> DNS servers that a Linux host talks to for DNS resolution</mark> is stored in the resolv.conf file. Its location is <code>/etc/resolv.conf</code></p><figure id="2385b2cc-075b-8016-a144-f5034376c71a" class="image"><a href="assets/image%20294.png"><img style="width:620px" src="assets/image%20294.png"/></a></figure><p id="2385b2cc-075b-80b2-99f9-fc20e1fbef09" class="">
</p><h3 id="2385b2cc-075b-80ee-b1ce-c9b749dadf0c" class="">Persistence Mechanisms</h3><p id="2385b2cc-075b-80e4-ae34-eed8f72eebdb" class=""><mark class="highlight-pink"><strong>Cron jobs</strong></mark></p><p id="2385b2cc-075b-809d-9e7b-ef0e4f7bcba0" class=""><code>etc/crontab</code> - location</p><figure id="2385b2cc-075b-80b7-ae7d-d4fca03358f9" class="image"><a href="assets/BB468AAF-9B09-4A75-A3EC-AB78D5796C25.png"><img style="width:708.6651000976562px" src="assets/BB468AAF-9B09-4A75-A3EC-AB78D5796C25.png"/></a></figure><p id="2385b2cc-075b-8063-93fa-fd84cd88c988" class="">
</p><p id="2385b2cc-075b-8020-8f5f-e6e3078bf55b" class=""><mark class="highlight-pink"><strong>Service startup</strong></mark></p><p id="2385b2cc-075b-807b-8b53-faaf5c18febd" class=""><code>/etc/init.d</code></p><figure id="2385b2cc-075b-8088-b911-defe3707e066" class="image"><a href="assets/E357A9CD-E07C-4A92-B7EF-6E2DCD5B95F0.png"><img style="width:708.5802001953125px" src="assets/E357A9CD-E07C-4A92-B7EF-6E2DCD5B95F0.png"/></a></figure><p id="2385b2cc-075b-80d9-a42c-c17f566fbb30" class="">
</p><p id="2385b2cc-075b-80b1-ae7d-eb6db16aae78" class=""><mark class="highlight-pink"><strong>.Bashrc -  </strong></mark><mark class="highlight-pink"><code><strong>cat ~/.bashrc</strong></code></mark><strong><br/><br/></strong>When a bash shell is spawned, it runs the commands stored in the <code>.bashrc</code> file. This file can be considered as a startup list of actions to be performed. Hence it can prove to be a good place to look for persistence. <br/><br/>System-wide settings are stored in <code>/etc/bash.bashrc</code> and <code>/etc/profile</code> files, so it is often a good idea to take a look at these files as well.</p><figure id="2385b2cc-075b-8048-8ffe-cd7ae19e3f1a" class="image"><a href="assets/image%20295.png"><img style="width:619.9833374023438px" src="assets/image%20295.png"/></a></figure><figure id="2385b2cc-075b-8005-8a03-d3d7a92770e6" class="image"><a href="assets/image%20296.png"><img style="width:619.9833374023438px" src="assets/image%20296.png"/></a></figure><p id="2385b2cc-075b-80b2-b7ee-f621eb9269ca" class="">
</p><h3 id="2385b2cc-075b-802d-98f8-f52391428008" class="">Evidence of Execution</h3><p id="2385b2cc-075b-80f9-92aa-e9a4630a9981" class="">Knowing what programs have been executed on a host is one of the main purposes of performing forensic analysis. On a Linux host, we can find the evidence of execution from the following sources.</p><p id="2385b2cc-075b-80d6-82cc-f8471d08fe54" class="">
</p><p id="2385b2cc-075b-8055-a8ea-fc0802fd34a7" class=""><mark class="highlight-pink"><strong>Sudo execution history</strong></mark></p><p id="2385b2cc-075b-80ae-beee-f60f3e272084" class="">All the commands that are run on a Linux host using <code>sudo</code> are stored in the auth log</p><figure id="2385b2cc-075b-808c-baf8-f9b3d51b7296" class="image"><a href="assets/8F076A40-A256-471F-A84B-950C6C17E2EB.png"><img style="width:709.7971801757812px" src="assets/8F076A40-A256-471F-A84B-950C6C17E2EB.png"/></a></figure><p id="2385b2cc-075b-804e-88b0-e5634486bc35" class=""><br/>wildcard (<code>*</code>) means it will include <code>auth.log</code>, <code>auth.log.1</code><br/>case-insensitive due to <code>-i</code></p><p id="2385b2cc-075b-80e5-9a5d-ecb57410bbef" class=""><code>tail</code> shows the last 10 lines<br/></p><p id="2385b2cc-075b-80af-b795-f7b57c0f6b1e" class=""><mark class="highlight-pink"><strong>Bash History</strong></mark></p><p id="2385b2cc-075b-80fc-af5d-d8ce129854be" class="">Any commands other than the ones run using <code>sudo</code> are stored in the bash history.<br/><br/><code>cat ~/.bash_history</code></p><p id="2385b2cc-075b-8009-b35c-c2d36d5434de" class="">Any commands other than the ones run using <code>sudo</code> are stored in the bash history.<br/><br/></p><p id="2385b2cc-075b-8043-b042-c832d10a6567" class=""><mark class="highlight-pink"><strong>Files accessed using vim</strong></mark></p><p id="2385b2cc-075b-80dd-8882-fffb1816f188" class="">The <code>Vim</code> text editor stores logs for opened files in <code>Vim</code> in the file named <code>.viminfo</code> in the home directory. This file contains command line history, search string history, etc. for the opened files. We can use the <code>cat</code> utility to open <code>.viminfo</code>.<br/><br/></p><p id="2385b2cc-075b-8042-b280-c0ac9cc8c36c" class=""><mark class="highlight-brown"><strong>Questions</strong></mark></p><p id="2385b2cc-075b-8013-a9c7-dec068d4cdd8" class="">
</p><p id="2385b2cc-075b-805e-b33e-da195a7178f8" class="">The user tryhackme used apt-get to install a package. What was the command that was issued?</p><figure id="2385b2cc-075b-8055-911d-dfdecde87244" class="image"><a href="assets/image%2057.png"><img style="width:709.9386596679688px" src="assets/image%2057.png"/></a></figure><p id="2385b2cc-075b-8067-8a06-f987b9292679" class="">
</p><p id="2385b2cc-075b-80d5-a060-f55e1adc4d58" class="">What was the current working directory when the command to install net-tools was issued?</p><figure id="2385b2cc-075b-8079-b02b-d7b0c73e95a8" class="image"><a href="assets/23DF6773-C3FF-44F5-9CE6-4F82DD55570A.png"><img style="width:709.896240234375px" src="assets/23DF6773-C3FF-44F5-9CE6-4F82DD55570A.png"/></a></figure><figure id="2385b2cc-075b-80ec-b0aa-df78c45a454d" class="image"><a href="assets/image%2058.png"><img style="width:620px" src="assets/image%2058.png"/></a></figure><p id="2385b2cc-075b-8027-a970-c5392b09525a" class="">
</p><h3 id="2385b2cc-075b-8051-8c1d-dfd4be3bc11a" class="">Log Files</h3><p id="2385b2cc-075b-803e-9b17-fcb93598d184" class="">Logs are generally found in the <code>/var/log</code> directory<br/><br/>The Syslog contains messages that are recorded by the host about system activity. The detail which is recorded in these messages is configurable through the logging level. We can use the <code>cat</code> utility to view the Syslog, which can be found in the file <code>/var/log/syslog</code>. Since the Syslog is a huge file, it is easier to use <code>tail</code>, <code>head</code>, <code>more</code> or <code>less</code> utilities to help make it more readable.<br/><br/><mark class="highlight-pink"><strong>Syslog</strong></mark></p><figure id="2385b2cc-075b-80ef-9fb9-ce46497e5e93" class="image"><a href="assets/75ABA1DC-486A-4B7D-86EF-079389307587.png"><img style="width:708.6651000976562px" src="assets/75ABA1DC-486A-4B7D-86EF-079389307587.png"/></a></figure><p id="2385b2cc-075b-800c-ad32-fabde2b3cc85" class="">head first few lines, an dtail last few lines</p><p id="2385b2cc-075b-80da-9aa2-f2ed2e84858d" class="">
</p><p id="2385b2cc-075b-80eb-98c0-ccabfda7f061" class=""><mark class="highlight-pink"><strong>Auth logs</strong></mark></p><p id="2385b2cc-075b-80bb-b96f-fda8995e1015" class="">The auth logs contain information about users and authentication-related logs.</p><figure id="2385b2cc-075b-8079-a01d-f1e32f026d57" class="image"><a href="assets/6488829F-C03A-458F-8362-70BA962B252A.png"><img style="width:660px" src="assets/6488829F-C03A-458F-8362-70BA962B252A.png"/></a></figure><p id="2385b2cc-075b-80c2-bc0b-cb12e2c78d45" class="">
</p><p id="2385b2cc-075b-80c1-8dd7-f23afba09679" class=""><mark class="highlight-pink"><strong>Third-party logs</strong></mark></p><p id="2385b2cc-075b-8050-b648-cb6d5ce25aa4" class="">Similar to the syslog and authentication logs, the <code>/var/log/</code> directory contains logs for third-party applications such as webserver, database, or file share server logs.<br/><br/></p><figure id="2385b2cc-075b-809c-be9e-c615909f02c4" class="image"><a href="assets/02243243-03E3-4983-96C1-F732D6441433.png"><img style="width:709.9669799804688px" src="assets/02243243-03E3-4983-96C1-F732D6441433.png"/></a></figure><p id="2385b2cc-075b-807b-92fd-fe7cd605ed03" class="">
</p><p id="2385b2cc-075b-8088-ac21-dcbe2b192ab7" class="">
</p><p id="2385b2cc-075b-808e-aea7-ea3c18efc1da" class="">Though the machine&#x27;s current hostname is the one we identified in Task 4. The machine earlier had a different hostname. What was the previous hostname of the machine?<br/><br/></p><figure id="2385b2cc-075b-80e6-ac28-d1a87b0ea9bf" class="image"><a href="assets/image%20297.png"><img style="width:620px" src="assets/image%20297.png"/></a></figure><figure id="2385b2cc-075b-80a3-8450-f66f23a8e83e" class="image"><a href="assets/image%2059.png"><img style="width:709.9386596679688px" src="assets/image%2059.png"/></a></figure><figure id="2385b2cc-075b-8097-a8c4-d3bc34c444de" class="image"><a href="assets/image%20298.png"><img style="width:620px" src="assets/image%20298.png"/></a></figure><p id="2385b2cc-075b-80a4-bff4-e49d520db433" class="">
</p></div></article><span class="sans" style="font-size:14px;padding-top:2em"></span></body></html>